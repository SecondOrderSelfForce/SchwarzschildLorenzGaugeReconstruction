(* ::Package:: *)

(************************************************************************)
(* This file was generated automatically by the Mathematica front end.  *)
(* It contains Initialization cells from a Notebook file, which         *)
(* typically will have the same name as this file except ending in      *)
(* ".nb" instead of ".m".                                               *)
(*                                                                      *)
(* This file is intended to be loaded into the Mathematica kernel using *)
(* the package loading commands Get or Needs.  Doing so is equivalent   *)
(* to using the Evaluate Initialization Cells menu command in the front *)
(* end.                                                                 *)
(*                                                                      *)
(* DO NOT EDIT THIS FILE.  This entire file is regenerated              *)
(* automatically each time the parent Notebook file is saved in the     *)
(* Mathematica front end.  Any changes you make to this file will be    *)
(* overwritten.                                                         *)
(************************************************************************)



(* ::Input::Initialization:: *)
\[ScriptCapitalL][s_,l_,\[Omega]_][\[Psi]_]:=
With[{M=1},Function[{r},(1-2M/r)^2 \[Psi]''[r]+(1-2M/r) (2 M)/r^2 \[Psi]'[r]+(\[Omega]^2-(1-2M/r)/r^2 (l(l+1)+2 M (1- s^2)/r))\[Psi][r]]];


(* ::Input::Initialization:: *)
\[ScriptCapitalL]Z[l_,\[Omega]_][\[Psi]_]:=
With[{M=1,\[Lambda]=1/2(l-1)(l+2)},Function[{r},(1-2M/r)^2 \[Psi]''[r]+(1-2M/r) (2 M)/r^2 \[Psi]'[r]+(\[Omega]^2-((1-2M/r)/(r^2(\[Lambda]+3M/r)^2) (2\[Lambda]^2(\[Lambda]+1+3M/r)+18M^2/r^2 (\[Lambda]+M/r))))\[Psi][r]]];


(* ::Input::Initialization:: *)
\[ScriptCapitalL]2[s_,l_,\[Omega]_][\[Psi]_]:=\[ScriptCapitalL][s,l,\[Omega]][\[ScriptCapitalL][s,l,\[Omega]][\[Psi]]];


(* ::Input::Initialization:: *)
\[ScriptCapitalL]Z2[l_,\[Omega]_][\[Psi]_]:=\[ScriptCapitalL]Z[l,\[Omega]][\[ScriptCapitalL]Z[l,\[Omega]][\[Psi]]];


(* ::Input::Initialization:: *)
\[ScriptCapitalL]finv\[ScriptCapitalL][s_,l_,\[Omega]_][\[Psi]_]:=With[{M=1},\[ScriptCapitalL][s,l,\[Omega]][Function[{r1},(1-2M/r1)^-1 \[ScriptCapitalL][s,l,\[Omega]][\[Psi]][r1]]]];


(* ::Input::Initialization:: *)
\[ScriptCapitalL]\[ScriptCapitalL]finv\[ScriptCapitalL][s_,l_,\[Omega]_][\[Psi]_]:=With[{M=1},\[ScriptCapitalL][s,l,\[Omega]][\[ScriptCapitalL][s,l,\[Omega]][Function[{r1},(1-2M/r1)^-1 \[ScriptCapitalL][s,l,\[Omega]][\[Psi]][r1]]]]];


(* ::Input::Initialization:: *)
\[ScriptCapitalL]finv\[ScriptCapitalL]\[ScriptCapitalL][s_,l_,\[Omega]_][\[Psi]_]:=With[{M=1},\[ScriptCapitalL][s,l,\[Omega]][Function[{r1},(1-2M/r1)^-1 \[ScriptCapitalL][s,l,\[Omega]][\[ScriptCapitalL][s,l,\[Omega]][\[Psi]]][r1]]]];


(* ::Input::Initialization:: *)
OuterBCRW2[s_,l_,\[Omega]_,nmax_,r_]:=Module[{M=1,a,n,rs,rsp,rsp2},
a[n_]:=a[n]=(I (2 M \[Omega](1-2 n+n^2-s^2) a[-2+n]+(l+l^2+n-n^2) a[-1+n]))/(2 n );

Do[a[i]=0,{i,-3,-1}];
a[0]=1;

Do[a[i];,{i,1,nmax}];
rs=r+2M Log[r/(2M)-1];
rsp=1/(1-2M/r);
rsp2=-((2 M)/(-2 M+r)^2);

E^(I rs \[Omega]) Sum[
{(r \[Omega])^-i a[i],
-(((r \[Omega])^-i (i-I r rsp \[Omega]) a[i])/r),
((r \[Omega])^-i (i+i^2-2 I i r rsp \[Omega]+I r^2 rsp2 \[Omega]-r^2 rsp^2 \[Omega]^2) a[i])/r^2},
{i,0,nmax}]
];


(* ::Input::Initialization:: *)
InnerBCRW2[s_,l_,\[Omega]_,nmax_,r_]:=Module[{M=1,a,n,rs,rsp,rsp2,rsp3},
a[n_]:=a[n]=((-1+2 n-n^2+s^2) a[-2+n]+(1+l+l^2-2 n+2 n^2-s^2) a[-1+n])/(n (n-4 I M \[Omega]));

Do[a[i]=0,{i,-3,-1}];
a[0]=1;

Do[a[i];,{i,1,nmax}];

rs=r+2M Log[r/(2M)-1];
rsp=1/(1-2M/r);
rsp2=-((2 M)/(-2 M+r)^2);
rsp3=-((4 M)/(2 M-r)^3);

E^(-I rs \[Omega]) Sum[
{rsp^-i a[i],
rsp^(-1-i) (-i rsp2-I rsp^2 \[Omega]) a[i],
-rsp^(-2-i) (-i (1+i) rsp2^2+rsp^2 \[Omega] (I rsp2+rsp^2 \[Omega])+i rsp (rsp3-2 I rsp rsp2 \[Omega])) a[i]},{i,-1,nmax}]
];


(* ::Input::Initialization:: *)
OuterBCRW2From4[s_,l_,\[Omega]_,nmax_,r_]:=OuterBCRW4[s,l,\[Omega],nmax,r,{1,0}];


(* ::Input::Initialization:: *)
OuterBCRW4[s_,l_,\[Omega]_,nmax_,r_]:=OuterBCRW4[s,l,\[Omega],nmax,r,{0,1}];


(* ::Input::Initialization:: *)
OuterBCRW4[s_,l_,\[Omega]_,nmax_,r_,basis_]:=
Module[{M=1,a,b,n,rs,rsp,rsp2,rsp3,rsp4},
a[n_]:=a[n]=(1/(4 (-1+n) n \[Omega]^2))(-8 (25-12 n^3+n^4-26 s^2+s^4-2 n^2 (-23+s^2)+12 n (-5+s^2)) a[-5+n]-4 (-36+30 n^3-3 n^4+37 s^2-s^4+l (17-10 n+2 n^2-2 s^2)+l^2 (17-10 n+2 n^2-2 s^2)+4 n^2 (-24+s^2)-5 n (-21+4 s^2)) a[-4+n]-24 a[-3+n]+44 l a[-3+n]+42 l^2 a[-3+n]-4 l^3 a[-3+n]-2 l^4 a[-3+n]+104 n a[-3+n]-32 l n a[-3+n]-32 l^2 n a[-3+n]-122 n^2 a[-3+n]+8 l n^2 a[-3+n]+8 l^2 n^2 a[-3+n]+48 n^3 a[-3+n]-6 n^4 a[-3+n]+24 s^2 a[-3+n]-4 l s^2 a[-3+n]-4 l^2 s^2 a[-3+n]-16 n s^2 a[-3+n]+4 n^2 s^2 a[-3+n]+32 I \[Omega] a[-3+n]-144 I n \[Omega] a[-3+n]+96 I n^2 \[Omega] a[-3+n]-16 I n^3 \[Omega] a[-3+n]-32 I s^2 \[Omega] a[-3+n]+16 I n s^2 \[Omega] a[-3+n]-6 l a[-2+n]-5 l^2 a[-2+n]+2 l^3 a[-2+n]+l^4 a[-2+n]-6 n a[-2+n]+6 l n a[-2+n]+6 l^2 n a[-2+n]+11 n^2 a[-2+n]-2 l n^2 a[-2+n]-2 l^2 n^2 a[-2+n]-6 n^3 a[-2+n]+n^4 a[-2+n]-12 I \[Omega] a[-2+n]+12 I l \[Omega] a[-2+n]+12 I l^2 \[Omega] a[-2+n]+80 I n \[Omega] a[-2+n]-8 I l n \[Omega] a[-2+n]-8 I l^2 n \[Omega] a[-2+n]-72 I n^2 \[Omega] a[-2+n]+16 I n^3 \[Omega] a[-2+n]+12 I s^2 \[Omega] a[-2+n]-8 I n s^2 \[Omega] a[-2+n]-4 I l \[Omega] a[-1+n]-4 I l^2 \[Omega] a[-1+n]-8 I n \[Omega] a[-1+n]+4 I l n \[Omega] a[-1+n]+4 I l^2 n \[Omega] a[-1+n]+12 I n^2 \[Omega] a[-1+n]-4 I n^3 \[Omega] a[-1+n]-16 n \[Omega]^2 a[-1+n]+8 n^2 \[Omega]^2 a[-1+n]+32 (-3+n) (5-6 n+n^2-s^2) b[-5+n]+4 (5-2 n) (21-2 l-2 l^2-30 n+6 n^2-4 s^2) b[-4+n]-4 (26+4 l (-2+n)+4 l^2 (-2+n)-6 n^3-4 s^2+12 n^2 (3-I \[Omega])+n (-61+2 s^2+48 I \[Omega])-36 I \[Omega]+4 I s^2 \[Omega]) b[-3+n]+2 (3-2 n^3+l (-3+2 n+4 I \[Omega])+l^2 (-3+2 n+4 I \[Omega])+3 n^2 (3-8 I \[Omega])+n (-11+72 I \[Omega])-40 I \[Omega]+4 I s^2 \[Omega]) b[-2+n]+4 I (2-l-l^2+3 n^2+n (-6+4 I \[Omega])-4 I \[Omega]) \[Omega] b[-1+n]+4 (-1+2 n) \[Omega]^2 b[n]);

b[n_]:=b[n]=(1/(4 (-1+n) n \[Omega]^2))(-8 (25-12 n^3+n^4-26 s^2+s^4-2 n^2 (-23+s^2)+12 n (-5+s^2)) b[-5+n]+4 (36-30 n^3+3 n^4-37 s^2+s^4-4 n^2 (-24+s^2)+l (-17+10 n-2 n^2+2 s^2)+l^2 (-17+10 n-2 n^2+2 s^2)+5 n (-21+4 s^2)) b[-4+n]+2 (-2 l^3-l^4-3 n^4+l^2 (21-16 n+4 n^2-2 s^2)+2 l (11-8 n+2 n^2-s^2)+8 n^3 (3-I \[Omega])+4 (-1+s^2) (3-4 I \[Omega])+n^2 (-61+2 s^2+48 I \[Omega])+n (52-72 I \[Omega]+8 I s^2 (I+\[Omega]))) b[-3+n]+(2 l^3+l^4+n^4-2 l (3+n^2+n (-3+4 I \[Omega])-6 I \[Omega])+l^2 (-5-2 n^2+n (6-8 I \[Omega])+12 I \[Omega])+n^3 (-6+16 I \[Omega])+n^2 (11-72 I \[Omega])+12 I (-1+s^2) \[Omega]+n (-6-8 I (-10+s^2) \[Omega])) b[-2+n]+4 I (l (-1+n)+l^2 (-1+n)-(-2+n) n (-1+n+2 I \[Omega])) \[Omega] b[-1+n]);

Do[a[i]=0;b[i]=0;,{i,-7,-1}];

{a[1],b[1]}=basis;
b[0]=0;
a[0]=b[1]/2;

Do[b[i];a[i];,{i,2,nmax}];

rs=r+2M Log[r/(2M)-1];
rsp=1/(1-2M/r);
rsp2=-((2 M)/(-2 M+r)^2);
rsp3=-((4 M)/(2 M-r)^3);
rsp4=-((12 M)/(-2 M+r)^4);

E^(I rs \[Omega]) Sum[
{r^(1-i) (a[i]+b[i] Log[r]),
r^-i ((1-i+I r rsp \[Omega]) a[i]+b[i] (1+Log[r]-i Log[r]+I r rsp \[Omega] Log[r])),
r^(-1-i) (((-1+i) i-2 I (-1+i) r rsp \[Omega]+I r^2 rsp2 \[Omega]-r^2 rsp^2 \[Omega]^2) a[i]+b[i] (1-2 i-i Log[r]+i^2 Log[r]+I r^2 rsp2 \[Omega] Log[r]-r^2 rsp^2 \[Omega]^2 Log[r]-2 I r rsp \[Omega] (-1+(-1+i) Log[r]))),
r^(-2-i) ((i-i^3-3 I (-1+i) r^2 rsp2 \[Omega]+I r^3 rsp3 \[Omega]+3 (-1+i) r^2 rsp^2 \[Omega]^2-I r^3 rsp^3 \[Omega]^3+3 I r rsp \[Omega] ((-1+i) i+I r^2 rsp2 \[Omega])) a[i]+b[i] (-1+3 i^2+i Log[r]-i^3 Log[r]+I r^3 rsp3 \[Omega] Log[r]-I r^3 rsp^3 \[Omega]^3 Log[r]-3 I r^2 rsp2 \[Omega] (-1+(-1+i) Log[r])+3 r^2 rsp^2 \[Omega]^2 (-1+(-1+i) Log[r])+3 I r rsp \[Omega] (1-2 i+(-1+i) i Log[r]+I r^2 rsp2 \[Omega] Log[r]))),
r^(-3-i) ((-2 i-i^2+2 i^3+i^4+6 I (-1+i) i r^2 rsp2 \[Omega]+4 I r^3 rsp3 \[Omega]-4 I i r^3 rsp3 \[Omega]+I r^4 rsp4 \[Omega]-3 r^4 rsp2^2 \[Omega]^2+4 I (-1+i) r^3 rsp^3 \[Omega]^3+r^4 rsp^4 \[Omega]^4-6 r^2 rsp^2 \[Omega]^2 ((-1+i) i+I r^2 rsp2 \[Omega])-4 r rsp \[Omega] (I i (-1+i^2)-3 (-1+i) r^2 rsp2 \[Omega]+r^3 rsp3 \[Omega])) a[i]+b[i] (2+2 i-6 i^2-4 i^3+4 I r^3 rsp3 \[Omega]-2 i Log[r]-i^2 Log[r]+2 i^3 Log[r]+i^4 Log[r]+4 I r^3 rsp3 \[Omega] Log[r]-4 I i r^3 rsp3 \[Omega] Log[r]+I r^4 rsp4 \[Omega] Log[r]-3 r^4 rsp2^2 \[Omega]^2 Log[r]+r^4 rsp^4 \[Omega]^4 Log[r]+4 I r^3 rsp^3 \[Omega]^3 (-1+(-1+i) Log[r])+6 I r^2 rsp2 \[Omega] (1-2 i+(-1+i) i Log[r])+6 r^2 rsp^2 \[Omega]^2 (-1+2 i-(-1+i) i Log[r]-I r^2 rsp2 \[Omega] Log[r])-4 r rsp \[Omega] (r^3 rsp3 \[Omega] Log[r]+3 r^2 rsp2 \[Omega] (1+Log[r]-i Log[r])+I (1-3 i^2+i (-1+i^2) Log[r]))))},
{i,0,nmax}]

];


(* ::Input::Initialization:: *)
InnerBCRW2From4[s_,l_,\[Omega]_,nmax_,r_]:=InnerBCRW4[s,l,\[Omega],nmax,r,{1,0}];


(* ::Input::Initialization:: *)
InnerBCRW4[s_,l_,\[Omega]_,nmax_,r_]:=InnerBCRW4[s,l,\[Omega],nmax,r,{0,1}];


(* ::Input::Initialization:: *)
InnerBCRW4[s_,l_,\[Omega]_,nmax_,r_,basis_]:=Module[{M=1,b,c,a,n,rs,rsp,rsp2,rsp3,rsp4,rsp5},
b[n_]:=b[n]=(1/(n^2 (n-4 I \[Omega])^2))((-8 n^3+n^4+8 n s^2+s^2 (-16+s^2)-2 n^2 (-8+s^2)) b[-5+n]+(32 n^3-5 n^4+43 s^2-26 n s^2-3 s^4+l (-9+6 n-2 n^2+2 s^2)+l^2 (-9+6 n-2 n^2+2 s^2)+n^2 (-52+8 s^2)) b[-4+n]+(2 l^3+l^4+10 n^4-39 s^2+3 s^4+l (17-14 n+6 n^2-4 s^2)+2 l^2 (9-7 n+3 n^2-2 s^2)-12 n^2 (-5+s^2-2 I \[Omega])+2 n s^2 (15+4 I \[Omega])-16 I \[Omega]-8 I s^2 \[Omega]-8 I n^3 (-6 I+\[Omega])) b[-3+n]+(-2 l^3-l^4-10 n^4+13 s^2-s^4-2 l^2 (5+3 n^2-s^2+n (-5-4 I \[Omega])+2 I \[Omega])+8 n^3 (4+3 I \[Omega])+l (-9-6 n^2+2 s^2+2 n (5+4 I \[Omega])-4 I \[Omega])+2 n s^2 (-7-8 I \[Omega])+4 n^2 (-7+2 s^2-12 I \[Omega])+20 I \[Omega]+12 I s^2 \[Omega]) b[-2+n]+(5 n^4+2 n s^2 (1+4 I \[Omega])+l (1+2 n^2+n (-2-8 I \[Omega])+4 I \[Omega])+l^2 (1+2 n^2+n (-2-8 I \[Omega])+4 I \[Omega])+n^3 (-8-24 I \[Omega])+(-I+4 \[Omega]) (-I s^2+4 \[Omega])-2 n^2 (-2+s^2-12 I \[Omega]+8 \[Omega]^2)) b[-1+n]+4 (-2+n) (-4 n+n^2-s^2) c[-5+n]-2 (-48 n^2+10 n^3+l (-3+2 n)+l^2 (-3+2 n)+13 s^2+n (52-8 s^2)) c[-4+n]+2 (20 n^3+l (-7+6 n)+l^2 (-7+6 n)-12 n (-5+s^2-2 I \[Omega])+s^2 (15+4 I \[Omega])-12 I n^2 (-6 I+\[Omega])) c[-3+n]-2 (20 n^3+l (-5+6 n-4 I \[Omega])+l^2 (-5+6 n-4 I \[Omega])+s^2 (7+8 I \[Omega])+n^2 (-48-36 I \[Omega])+n (28-8 s^2+48 I \[Omega])) c[-2+n]+2 (10 n^3+l (-1+2 n-4 I \[Omega])+l^2 (-1+2 n-4 I \[Omega])+s^2 (1+4 I \[Omega])+n^2 (-12-36 I \[Omega])-2 n (-2+s^2-12 I \[Omega]+8 \[Omega]^2)) c[-1+n]-4 n (n-2 I \[Omega]) (n-4 I \[Omega]) c[n]);

c[n_]:=c[n]=(1/(n^2 (n-4 I \[Omega])^2))((-8 n^3+n^4+8 n s^2+s^2 (-16+s^2)-2 n^2 (-8+s^2)) c[-5+n]+(32 n^3-5 n^4+43 s^2-26 n s^2-3 s^4+l (-9+6 n-2 n^2+2 s^2)+l^2 (-9+6 n-2 n^2+2 s^2)+n^2 (-52+8 s^2)) c[-4+n]+(2 l^3+l^4+10 n^4-39 s^2+3 s^4+l (17-14 n+6 n^2-4 s^2)+2 l^2 (9-7 n+3 n^2-2 s^2)-12 n^2 (-5+s^2-2 I \[Omega])+2 n s^2 (15+4 I \[Omega])-16 I \[Omega]-8 I s^2 \[Omega]-8 I n^3 (-6 I+\[Omega])) c[-3+n]+(-2 l^3-l^4-10 n^4+13 s^2-s^4-2 l^2 (5+3 n^2-s^2+n (-5-4 I \[Omega])+2 I \[Omega])+8 n^3 (4+3 I \[Omega])+l (-9-6 n^2+2 s^2+2 n (5+4 I \[Omega])-4 I \[Omega])+2 n s^2 (-7-8 I \[Omega])+4 n^2 (-7+2 s^2-12 I \[Omega])+20 I \[Omega]+12 I s^2 \[Omega]) c[-2+n]+(5 n^4+2 n s^2 (1+4 I \[Omega])+l (1+2 n^2+n (-2-8 I \[Omega])+4 I \[Omega])+l^2 (1+2 n^2+n (-2-8 I \[Omega])+4 I \[Omega])+n^3 (-8-24 I \[Omega])+(-I+4 \[Omega]) (-I s^2+4 \[Omega])-2 n^2 (-2+s^2-12 I \[Omega]+8 \[Omega]^2)) c[-1+n]);

Do[b[i]=0;c[i]=0;,{i,-6,-1}];
{b[0],c[0]}=basis;

Do[b[i];c[i];,{i,1,nmax}];

rs=r+2M Log[r/(2M)-1];
rsp=1/(1-2M/r);
rsp2=-((2 M)/(-2 M+r)^2);
rsp3=-((4 M)/(2 M-r)^3);
rsp4=-((12 M)/(-2 M+r)^4);
rsp5=-((48 M)/(2 M-r)^5);


E^(-I rs \[Omega]) Sum[
{rsp^-i (b[i]+c[i] Log[1/rsp]),
rsp^(-1-i) ((-i rsp2-I rsp^2 \[Omega]) b[i]+c[i] (-I rsp^2 \[Omega] Log[1/rsp]-rsp2 (1+i Log[1/rsp]))),
rsp^(-2-i) ((i (1+i) rsp2^2-rsp^2 \[Omega] (I rsp2+rsp^2 \[Omega])+rsp (-i rsp3+2 I i rsp rsp2 \[Omega])) b[i]+c[i] (-rsp^2 \[Omega] (I rsp2+rsp^2 \[Omega]) Log[1/rsp]+I rsp (I rsp3+2 rsp rsp2 \[Omega]) (1+i Log[1/rsp])+rsp2^2 (1+2 i+i (1+i) Log[1/rsp]))),
rsp^(-3-i) ((-i (2+3 i+i^2) rsp2^3+3 i (1+i) rsp rsp2 (rsp3-I rsp rsp2 \[Omega])+I rsp^3 \[Omega] (-rsp3+3 I rsp rsp2 \[Omega]+rsp^3 \[Omega]^2)+i rsp^2 (-rsp4+3 I rsp2^2 \[Omega]+3 I rsp rsp3 \[Omega]+3 rsp^2 rsp2 \[Omega]^2)) b[i]+c[i] (I rsp^3 \[Omega] (-rsp3+3 I rsp rsp2 \[Omega]+rsp^3 \[Omega]^2) Log[1/rsp]+rsp^2 (-rsp4+3 I rsp2^2 \[Omega]+3 I rsp rsp3 \[Omega]+3 rsp^2 rsp2 \[Omega]^2) (1+i Log[1/rsp])+3 rsp rsp2 (rsp3-I rsp rsp2 \[Omega]) (1+2 i+i (1+i) Log[1/rsp])-rsp2^3 (2+6 i+3 i^2+i (2+3 i+i^2) Log[1/rsp]))),
rsp^(-4-i) ((i (6+11 i+6 i^2+i^3) rsp2^4+2 I i (2+3 i+i^2) rsp rsp2^2 (3 I rsp3+2 rsp rsp2 \[Omega])-i (1+i) rsp^2 (-3 rsp3^2-4 rsp2 rsp4+6 I rsp2^3 \[Omega]+12 I rsp rsp2 rsp3 \[Omega]+6 rsp^2 rsp2^2 \[Omega]^2)+rsp^4 \[Omega] (-I rsp4-3 rsp2^2 \[Omega]-4 rsp rsp3 \[Omega]+6 I rsp^2 rsp2 \[Omega]^2+rsp^4 \[Omega]^3)+i rsp^3 (-rsp5+10 I rsp2 rsp3 \[Omega]+6 rsp^2 rsp3 \[Omega]^2-4 I rsp^3 rsp2 \[Omega]^3+4 rsp \[Omega] (I rsp4+3 rsp2^2 \[Omega]))) b[i]+c[i] (rsp^4 \[Omega] (-I rsp4-3 rsp2^2 \[Omega]-4 rsp rsp3 \[Omega]+6 I rsp^2 rsp2 \[Omega]^2+rsp^4 \[Omega]^3) Log[1/rsp]+rsp^3 (-rsp5+10 I rsp2 rsp3 \[Omega]+6 rsp^2 rsp3 \[Omega]^2-4 I rsp^3 rsp2 \[Omega]^3+4 rsp \[Omega] (I rsp4+3 rsp2^2 \[Omega])) (1+i Log[1/rsp])-rsp^2 (-3 rsp3^2-4 rsp2 rsp4+6 I rsp2^3 \[Omega]+12 I rsp rsp2 rsp3 \[Omega]+6 rsp^2 rsp2^2 \[Omega]^2) (1+2 i+i (1+i) Log[1/rsp])+2 I rsp rsp2^2 (3 I rsp3+2 rsp rsp2 \[Omega]) (2+6 i+3 i^2+i (2+3 i+i^2) Log[1/rsp])+rsp2^4 (6+22 i+18 i^2+4 i^3+i (6+11 i+6 i^2+i^3) Log[1/rsp])))},
{i,-1,nmax}]
];


(* ::Input::Initialization:: *)
OuterBCRW2[s_,l_,\[Omega]_,nmax_,r_]:=Module[{M=1,a,n,rs,rsp,rsp2},
a[n_]:=a[n]=(I (2 M \[Omega](1-2 n+n^2-s^2) a[-2+n]+(l+l^2+n-n^2) a[-1+n]))/(2 n );

Do[a[i]=0,{i,-3,-1}];
a[0]=1;

Do[a[i];,{i,1,nmax}];
rs=r+2M Log[r/(2M)-1];
rsp=1/(1-2M/r);
rsp2=-((2 M)/(-2 M+r)^2);

E^(I rs \[Omega]) Sum[
{(r \[Omega])^-i a[i],
-(((r \[Omega])^-i (i-I r rsp \[Omega]) a[i])/r),
((r \[Omega])^-i (i+i^2-2 I i r rsp \[Omega]+I r^2 rsp2 \[Omega]-r^2 rsp^2 \[Omega]^2) a[i])/r^2},
{i,0,nmax}]
];


(* ::Input::Initialization:: *)
InnerBCRW2[s_,l_,\[Omega]_,nmax_,r_]:=Module[{M=1,a,n,rs,rsp,rsp2,rsp3},
a[n_]:=a[n]=((-1+2 n-n^2+s^2) a[-2+n]+(1+l+l^2-2 n+2 n^2-s^2) a[-1+n])/(n (n-4 I M \[Omega]));

Do[a[i]=0,{i,-3,-1}];
a[0]=1;

Do[a[i];,{i,1,nmax}];

rs=r+2M Log[r/(2M)-1];
rsp=1/(1-2M/r);
rsp2=-((2 M)/(-2 M+r)^2);
rsp3=-((4 M)/(2 M-r)^3);

E^(-I rs \[Omega]) Sum[
{rsp^-i a[i],
rsp^(-1-i) (-i rsp2-I rsp^2 \[Omega]) a[i],
-rsp^(-2-i) (-i (1+i) rsp2^2+rsp^2 \[Omega] (I rsp2+rsp^2 \[Omega])+i rsp (rsp3-2 I rsp rsp2 \[Omega])) a[i]},{i,-1,nmax}]
];


(* ::Input::Initialization:: *)
OuterBCZ2[l_,\[Omega]_,nmax_,r_]:=OuterBCZ4[l,\[Omega],nmax,r,{1,0}];


(* ::Input::Initialization:: *)
OuterBCZ4[l_,\[Omega]_,nmax_,r_]:=OuterBCZ4[l,\[Omega],nmax,r,{0,1}];


(* ::Input::Initialization:: *)
OuterBCZ4[l_,\[Omega]_,nmax_,r_,basis_]:=
Module[{M=1,\[Lambda],a,b,n,rs,rsp,rsp2,rsp3,rsp4},
\[Lambda]=1/2(l-1)(l+2);

a[n_]:=a[n]=(1/(4 (-1+n) n \[Lambda]^4 \[Omega]^2))(-648 (45-14 n+n^2)^2 a[-9+n]-108 (n (9243-6196 \[Lambda])+n^4 (-9+8 \[Lambda])+270 (-52+31 \[Lambda])-6 n^3 (-39+32 \[Lambda])+12 n^2 (-186+139 \[Lambda])) a[-8+n]-18 (3 n^4 (9-24 \[Lambda]+8 \[Lambda]^2)-24 n^3 (27-66 \[Lambda]+20 \[Lambda]^2-3 I \[Omega])+36 (875-1537 \[Lambda]+323 \[Lambda]^2-396 I \[Omega])+n^2 (5733-12696 \[Lambda]+3440 \[Lambda]^2-1296 I \[Omega])-4 n (5535-10962 \[Lambda]+2608 \[Lambda]^2-1890 I \[Omega])) a[-7+n]-3 (n^4 (-27+216 \[Lambda]-216 \[Lambda]^2+32 \[Lambda]^3)+36 (-630-1937 \[Lambda]^2+216 \[Lambda]^3+\[Lambda] (3247-1782 I \[Omega])+1881 I \[Omega])+n^2 (-4833-25200 \[Lambda]^2+2944 \[Lambda]^3+108 \[Lambda] (293-80 I \[Omega])+7128 I \[Omega])-2 n (-8613-34716 \[Lambda]^2+3680 \[Lambda]^3+18 \[Lambda] (2791-1156 I \[Omega])+19224 I \[Omega])+n^3 (594-4320 \[Lambda]+3888 \[Lambda]^2-512 \[Lambda]^3-432 I \[Omega]+576 I \[Lambda] \[Omega])) a[-6+n]+4 (12 (393-451 n+210 n^2-42 n^3+3 n^4) \[Lambda]^3-2 (279-180 n+62 n^2-12 n^3+n^4) \[Lambda]^4-81 I (24-10 n+n^2) (-5+n+2 I \[Omega]) \[Omega]+27 \[Lambda] (360+n^4+n^2 (119-216 I \[Omega])+n (-342+946 I \[Omega])-1342 I \[Omega]+2 I n^3 (9 I+8 \[Omega]))-9 \[Lambda]^2 (9 n^4+3 n^2 (277-96 I \[Omega])+8 (223-165 I \[Omega])+24 I n^3 (6 I+\[Omega])+4 I n (509 I+274 \[Omega]))) a[-5+n]+2 ((720-586 n+248 n^2-60 n^3+6 n^4) \[Lambda]^4+(-84+40 n-8 n^2) \[Lambda]^5-162 (20-9 n+n^2) \[Omega]^2+216 (15-8 n+n^2) \[Lambda] \[Omega] (4 I-I n+2 \[Omega])-12 \[Lambda]^3 (163+3 n^4+n^3 (-36+8 I \[Omega])+n^2 (151-72 I \[Omega])-204 I \[Omega]+52 I n (5 I+4 \[Omega]))+9 \[Lambda]^2 (3 n^4+64 (5-28 I \[Omega])+n^2 (211-504 I \[Omega])+n (-444+1688 I \[Omega])+6 I n^3 (7 I+8 \[Omega]))) a[-4+n]+2 \[Lambda] (4 (11-8 n+2 n^2) \[Lambda]^4-4 \[Lambda]^5+6 (-2+n) \[Lambda]^2 (-4+n^3+n^2 (-8+16 I \[Omega])+n (17-88 I \[Omega])+104 I \[Omega])+\[Lambda]^3 (-84-3 n^4+8 n^3 (3-I \[Omega])+4 n (27-34 I \[Omega])+n^2 (-69+48 I \[Omega])+192 I \[Omega])-216 (12-7 n+n^2) \[Omega]^2+36 (-4+n) \[Lambda] \[Omega] (-17 I-3 I n^2-12 \[Omega]+3 n (5 I+2 \[Omega]))) a[-3+n]+\[Lambda]^2 (4 \[Lambda]^4-4 \[Lambda]^3 (1+n^2+n (-3+4 I \[Omega])-6 I \[Omega])+\[Lambda]^2 (-8+n^4+n^3 (-6+16 I \[Omega])+2 n (3+64 I \[Omega])+n^2 (7-72 I \[Omega])-132 I \[Omega])-216 (6-5 n+n^2) \[Omega]^2+24 \[Lambda] \[Omega] (7 I-2 I n^3+12 \[Omega]+4 n^2 (3 I+\[Omega])-4 n (5 I+4 \[Omega]))) a[-2+n]+4 \[Lambda]^3 \[Omega] (2 I (-1+n) \[Lambda]^2-12 (2-3 n+n^2) \[Omega]+\[Lambda] (-2 I-I n^3-4 n \[Omega]+n^2 (3 I+2 \[Omega]))) a[-1+n]+2592 (-315+143 n-21 n^2+n^3) b[-9+n]+108 (9243+n^2 (702-576 \[Lambda])-6196 \[Lambda]+4 n^3 (-9+8 \[Lambda])+24 n (-186+139 \[Lambda])) b[-8+n]+36 (21924 \[Lambda]-5216 \[Lambda]^2+6 n^3 (9-24 \[Lambda]+8 \[Lambda]^2)-36 n^2 (27-66 \[Lambda]+20 \[Lambda]^2-3 I \[Omega])+270 (-41+14 I \[Omega])+n (5733-12696 \[Lambda]+3440 \[Lambda]^2-1296 I \[Omega])) b[-7+n]+6 (8613-50238 \[Lambda]+34716 \[Lambda]^2-3680 \[Lambda]^3+n^3 (-54+432 \[Lambda]-432 \[Lambda]^2+64 \[Lambda]^3)+n (-4833-25200 \[Lambda]^2+2944 \[Lambda]^3+108 \[Lambda] (293-80 I \[Omega])+7128 I \[Omega])-19224 I \[Omega]+20808 I \[Lambda] \[Omega]+n^2 (891-6480 \[Lambda]+5832 \[Lambda]^2-768 \[Lambda]^3-648 I \[Omega]+864 I \[Lambda] \[Omega])) b[-6+n]-4 (12 (-451+420 n-126 n^2+12 n^3) \[Lambda]^3-8 (-45+31 n-9 n^2+n^3) \[Lambda]^4-18 \[Lambda]^2 (-1018+18 n^3+3 n (277-96 I \[Omega])+548 I \[Omega]+36 I n^2 (6 I+\[Omega]))+81 \[Omega] (-74 I-3 I n^2-20 \[Omega]+n (30 I+4 \[Omega]))+54 \[Lambda] (-171+2 n^3+n (119-216 I \[Omega])+473 I \[Omega]+3 I n^2 (9 I+8 \[Omega]))) b[-5+n]+4 ((293-248 n+90 n^2-12 n^3) \[Lambda]^4+4 (-5+2 n) \[Lambda]^5+81 (-9+2 n) \[Omega]^2-108 \[Lambda] \[Omega] (-47 I-3 I n^2-16 \[Omega]+4 n (6 I+\[Omega]))+12 \[Lambda]^3 (6 n^3+26 (-5+4 I \[Omega])+n (151-72 I \[Omega])+6 I n^2 (9 I+2 \[Omega]))-9 \[Lambda]^2 (-222+6 n^3+n (211-504 I \[Omega])+844 I \[Omega]+9 I n^2 (7 I+8 \[Omega]))) b[-4+n]-4 \[Lambda] (8 (-2+n) \[Lambda]^4+\[Lambda]^3 (54-6 n^3+12 n^2 (3-I \[Omega])+n (-69+48 I \[Omega])-68 I \[Omega])+108 (7-2 n) \[Omega]^2+18 \[Lambda] \[Omega] (-77 I-9 I n^2-36 \[Omega]+6 n (9 I+2 \[Omega]))+6 \[Lambda]^2 (-19+2 n^3+3 n (11-40 I \[Omega])+140 I \[Omega]+3 I n^2 (5 I+8 \[Omega]))) b[-3+n]+2 \[Lambda]^2 (\[Lambda]^3 (-6+4 n+8 I \[Omega])-\[Lambda]^2 (3+2 n^3+n^2 (-9+24 I \[Omega])+n (7-72 I \[Omega])+64 I \[Omega])+108 (-5+2 n) \[Omega]^2-24 \[Lambda] \[Omega] (-3 I n^2+4 n (3 I+\[Omega])-2 (5 I+4 \[Omega]))) b[-2+n]+4 \[Lambda]^3 \[Omega] (3 I n^2 \[Lambda]-2 I \[Lambda]^2-36 \[Omega]+24 n \[Omega]+4 \[Lambda] \[Omega]-2 n \[Lambda] (3 I+2 \[Omega])) b[-1+n]+4 (-1+2 n) \[Lambda]^4 \[Omega]^2 b[n]);

b[n_]:=b[n]=(1/(4 (-1+n) n \[Lambda]^4 \[Omega]^2))(-648 (45-14 n+n^2)^2 b[-9+n]-108 (n (9243-6196 \[Lambda])+n^4 (-9+8 \[Lambda])+270 (-52+31 \[Lambda])-6 n^3 (-39+32 \[Lambda])+12 n^2 (-186+139 \[Lambda])) b[-8+n]-18 (3 n^4 (9-24 \[Lambda]+8 \[Lambda]^2)-24 n^3 (27-66 \[Lambda]+20 \[Lambda]^2-3 I \[Omega])+36 (875-1537 \[Lambda]+323 \[Lambda]^2-396 I \[Omega])+n^2 (5733-12696 \[Lambda]+3440 \[Lambda]^2-1296 I \[Omega])-4 n (5535-10962 \[Lambda]+2608 \[Lambda]^2-1890 I \[Omega])) b[-7+n]-3 (n^4 (-27+216 \[Lambda]-216 \[Lambda]^2+32 \[Lambda]^3)+36 (-630-1937 \[Lambda]^2+216 \[Lambda]^3+\[Lambda] (3247-1782 I \[Omega])+1881 I \[Omega])+n^2 (-4833-25200 \[Lambda]^2+2944 \[Lambda]^3+108 \[Lambda] (293-80 I \[Omega])+7128 I \[Omega])-2 n (-8613-34716 \[Lambda]^2+3680 \[Lambda]^3+18 \[Lambda] (2791-1156 I \[Omega])+19224 I \[Omega])+n^3 (594-4320 \[Lambda]+3888 \[Lambda]^2-512 \[Lambda]^3-432 I \[Omega]+576 I \[Lambda] \[Omega])) b[-6+n]+4 (12 (393-451 n+210 n^2-42 n^3+3 n^4) \[Lambda]^3-2 (279-180 n+62 n^2-12 n^3+n^4) \[Lambda]^4-81 I (24-10 n+n^2) (-5+n+2 I \[Omega]) \[Omega]+27 \[Lambda] (360+n^4+n^2 (119-216 I \[Omega])+n (-342+946 I \[Omega])-1342 I \[Omega]+2 I n^3 (9 I+8 \[Omega]))-9 \[Lambda]^2 (9 n^4+3 n^2 (277-96 I \[Omega])+8 (223-165 I \[Omega])+24 I n^3 (6 I+\[Omega])+4 I n (509 I+274 \[Omega]))) b[-5+n]+2 ((720-586 n+248 n^2-60 n^3+6 n^4) \[Lambda]^4+(-84+40 n-8 n^2) \[Lambda]^5-162 (20-9 n+n^2) \[Omega]^2+216 (15-8 n+n^2) \[Lambda] \[Omega] (4 I-I n+2 \[Omega])-12 \[Lambda]^3 (163+3 n^4+n^3 (-36+8 I \[Omega])+n^2 (151-72 I \[Omega])-204 I \[Omega]+52 I n (5 I+4 \[Omega]))+9 \[Lambda]^2 (3 n^4+64 (5-28 I \[Omega])+n^2 (211-504 I \[Omega])+n (-444+1688 I \[Omega])+6 I n^3 (7 I+8 \[Omega]))) b[-4+n]+2 \[Lambda] (4 (11-8 n+2 n^2) \[Lambda]^4-4 \[Lambda]^5+6 (-2+n) \[Lambda]^2 (-4+n^3+n^2 (-8+16 I \[Omega])+n (17-88 I \[Omega])+104 I \[Omega])+\[Lambda]^3 (-84-3 n^4+8 n^3 (3-I \[Omega])+4 n (27-34 I \[Omega])+n^2 (-69+48 I \[Omega])+192 I \[Omega])-216 (12-7 n+n^2) \[Omega]^2+36 (-4+n) \[Lambda] \[Omega] (-17 I-3 I n^2-12 \[Omega]+3 n (5 I+2 \[Omega]))) b[-3+n]+\[Lambda]^2 (4 \[Lambda]^4-4 \[Lambda]^3 (1+n^2+n (-3+4 I \[Omega])-6 I \[Omega])+\[Lambda]^2 (-8+n^4+n^3 (-6+16 I \[Omega])+2 n (3+64 I \[Omega])+n^2 (7-72 I \[Omega])-132 I \[Omega])-216 (6-5 n+n^2) \[Omega]^2+24 \[Lambda] \[Omega] (7 I-2 I n^3+12 \[Omega]+4 n^2 (3 I+\[Omega])-4 n (5 I+4 \[Omega]))) b[-2+n]+4 \[Lambda]^3 \[Omega] (2 I (-1+n) \[Lambda]^2-12 (2-3 n+n^2) \[Omega]+\[Lambda] (-2 I-I n^3-4 n \[Omega]+n^2 (3 I+2 \[Omega]))) b[-1+n]);

Do[a[i]=0;b[i]=0;,{i,-9,-1}];

{a[1],b[1]}=basis;
b[0]=0;
a[0]=b[1]/2;

Do[b[i];a[i];,{i,2,nmax}];

rs=r+2M Log[r/(2M)-1];
rsp=1/(1-2M/r);
rsp2=-((2 M)/(-2 M+r)^2);
rsp3=-((4 M)/(2 M-r)^3);
rsp4=-((12 M)/(-2 M+r)^4);


E^(I rs \[Omega]) Sum[
{r^(1-i) (a[i]+b[i] Log[r]),
r^-i ((1-i+I r rsp \[Omega]) a[i]+b[i] (1+Log[r]-i Log[r]+I r rsp \[Omega] Log[r])),
r^(-1-i) (((-1+i) i-2 I (-1+i) r rsp \[Omega]+I r^2 rsp2 \[Omega]-r^2 rsp^2 \[Omega]^2) a[i]+b[i] (1-2 i-i Log[r]+i^2 Log[r]+I r^2 rsp2 \[Omega] Log[r]-r^2 rsp^2 \[Omega]^2 Log[r]-2 I r rsp \[Omega] (-1+(-1+i) Log[r]))),
r^(-2-i) ((i-i^3-3 I (-1+i) r^2 rsp2 \[Omega]+I r^3 rsp3 \[Omega]+3 (-1+i) r^2 rsp^2 \[Omega]^2-I r^3 rsp^3 \[Omega]^3+3 I r rsp \[Omega] ((-1+i) i+I r^2 rsp2 \[Omega])) a[i]+b[i] (-1+3 i^2+i Log[r]-i^3 Log[r]+I r^3 rsp3 \[Omega] Log[r]-I r^3 rsp^3 \[Omega]^3 Log[r]-3 I r^2 rsp2 \[Omega] (-1+(-1+i) Log[r])+3 r^2 rsp^2 \[Omega]^2 (-1+(-1+i) Log[r])+3 I r rsp \[Omega] (1-2 i+(-1+i) i Log[r]+I r^2 rsp2 \[Omega] Log[r]))),
r^(-3-i) ((-2 i-i^2+2 i^3+i^4+6 I (-1+i) i r^2 rsp2 \[Omega]+4 I r^3 rsp3 \[Omega]-4 I i r^3 rsp3 \[Omega]+I r^4 rsp4 \[Omega]-3 r^4 rsp2^2 \[Omega]^2+4 I (-1+i) r^3 rsp^3 \[Omega]^3+r^4 rsp^4 \[Omega]^4-6 r^2 rsp^2 \[Omega]^2 ((-1+i) i+I r^2 rsp2 \[Omega])-4 r rsp \[Omega] (I i (-1+i^2)-3 (-1+i) r^2 rsp2 \[Omega]+r^3 rsp3 \[Omega])) a[i]+b[i] (2+2 i-6 i^2-4 i^3+4 I r^3 rsp3 \[Omega]-2 i Log[r]-i^2 Log[r]+2 i^3 Log[r]+i^4 Log[r]+4 I r^3 rsp3 \[Omega] Log[r]-4 I i r^3 rsp3 \[Omega] Log[r]+I r^4 rsp4 \[Omega] Log[r]-3 r^4 rsp2^2 \[Omega]^2 Log[r]+r^4 rsp^4 \[Omega]^4 Log[r]+4 I r^3 rsp^3 \[Omega]^3 (-1+(-1+i) Log[r])+6 I r^2 rsp2 \[Omega] (1-2 i+(-1+i) i Log[r])+6 r^2 rsp^2 \[Omega]^2 (-1+2 i-(-1+i) i Log[r]-I r^2 rsp2 \[Omega] Log[r])-4 r rsp \[Omega] (r^3 rsp3 \[Omega] Log[r]+3 r^2 rsp2 \[Omega] (1+Log[r]-i Log[r])+I (1-3 i^2+i (-1+i^2) Log[r]))))},{i,0,nmax}]
];


(* ::Input::Initialization:: *)
InnerBCZ2[l_,\[Omega]_,nmax_,r_]:=InnerBCZ4[l,\[Omega],nmax,r,{1,0}];


(* ::Input::Initialization:: *)
InnerBCZ4[l_,\[Omega]_,nmax_,r_]:=InnerBCZ4[l,\[Omega],nmax,r,{0,1}];


(* ::Input::Initialization:: *)
\[Psi][s_,l_,m_,r0_]/;OddQ[l+m]:=Module[{M=1,\[CapitalOmega],\[Omega],\[CapitalPhi],J,dY,RIn,RUp,cin,cup},
\[CapitalOmega]=Sqrt[M/r0^3];
\[Omega]=m \[CapitalOmega];
Block[{$rminUp=r0-1,$rmaxIn=r0+1},
RIn=\[Psi]2In[s,l,\[Omega]];
RUp=\[Psi]2Up[s,l,\[Omega]];
];

\[CapitalPhi]={{-RIn[r0],RUp[r0]},{-RIn'[r0],RUp'[r0]}};
dY=Derivative[0,0,1,0][SphericalHarmonicY][l,m,\[Pi]/2,0];
J=Switch[s,
2,{(16 I m M \[Pi] Sqrt[-(r0/(3 M-r0))] Conjugate[dY])/((-1+l) l (1+l) (2+l) r0^2),-((16 I m M \[Pi] Sqrt[-(r0/(3 M-r0))] Conjugate[dY])/((-1+l) l (1+l) (2+l) r0^3))},
1,{-((16 I m M \[Pi] Sqrt[-(r0/(3 M-r0))] Conjugate[dY])/(3 l (1+l) r0^2)),-((32 I m M \[Pi] Sqrt[-(r0/(3 M-r0))] Conjugate[dY])/(3 l (1+l) r0^3))},
_,{Indeterminate,Indeterminate}];
{cin,cup}=LinearSolve[\[CapitalPhi],J];
Function[{r},Evaluate[Piecewise[{{cin RIn[r],r<r0},{cup RUp[r],r>r0}},Indeterminate]]]
];


(* ::Input::Initialization:: *)
\[Phi][s_,l_,m_,r0_]/;OddQ[l+m]:=Module[{M=1,\[CapitalOmega],\[Omega],\[CapitalPhi],J,dY,R2In,R2Up,R4In,R4Up,cin2,cup2,cin4,cup4},
\[CapitalOmega]=Sqrt[M/r0^3];
\[Omega]=m \[CapitalOmega];
Block[{$rminUp=r0-1,$rmaxIn=r0+1},
R2In=\[Psi]2In[s,l,\[Omega]];
R2Up=\[Psi]2Up[s,l,\[Omega]];
R4In=\[Psi]4In[s,l,\[Omega]];
R4Up=\[Psi]4Up[s,l,\[Omega]];
];

\[CapitalPhi]={{-R2In[r0],-R4In[r0],R2Up[r0],R4Up[r0]},
{-R2In'[r0],-R4In'[r0],R2Up'[r0],R4Up'[r0]},
{-R2In''[r0],-R4In''[r0],R2Up''[r0],R4Up''[r0]},
{-R2In'''[r0],-R4In'''[r0],R2Up'''[r0],R4Up'''[r0]}};
dY=Derivative[0,0,1,0][SphericalHarmonicY][l,m,\[Pi]/2,0];
J=Switch[s,
2,{(8 I m M \[Pi] (3 M-2 r0) Conjugate[dY])/((-1+l) l (1+l) (2+l) r0^(5/2) (-3 M+r0)^(3/2)),(8 I m M \[Pi] (-12 M^3-2 (-22+6 l+6 l^2+3 m^2) M^2 r0+(-31+10 l+10 l^2+2 m^2) M r0^2-2 (-3+l+l^2) r0^3) Conjugate[dY])/((-1+l) l (1+l) (2+l) r0^(7/2) (-3 M+r0)^(3/2) (-2 M+r0)^2),-((8 I m M \[Pi] (-48 M^4+2 (16+18 l+18 l^2+27 m^2) M^3 r0-(4+40 l+40 l^2+41 m^2) M^2 r0^2+(15 l+15 l^2+8 m^2) M r0^3-2 l (1+l) r0^4) Conjugate[dY])/((-1+l) l (1+l) (2+l) (2 M-r0)^3 r0^(9/2) (-3 M+r0)^(3/2))),(8 I m M \[Pi] (-288 M^5-24 (-42+5 l+5 l^2+10 m^2) M^4 r0+2 (-476+24 l^3+12 l^4+59 m^2+3 m^4+2 l (5+6 m^2)+2 l^2 (11+6 m^2)) M^3 r0^2+(356-64 l^3-32 l^4+21 m^2-2 m^4+l^2 (70-20 m^2)+l (102-20 m^2)) M^2 r0^3+(28 l^3+14 l^4-12 (4+m^2)+l (-61+4 m^2)+l^2 (-47+4 m^2)) M r0^4-2 l (-5-4 l+2 l^2+l^3) r0^5) Conjugate[dY])/((-1+l) l (1+l) (2+l) r0^(11/2) (-3 M+r0)^(3/2) (-2 M+r0)^4)},
1,{-((8 I m M \[Pi] (21 M-8 r0) Conjugate[dY])/(3 l (1+l) r0^(5/2) (-3 M+r0)^(3/2))),(16 I m M \[Pi] (-84 M^3+(104+6 l+6 l^2+3 m^2) M^2 r0-(43+5 l+5 l^2+m^2) M r0^2+(6+l+l^2) r0^3) Conjugate[dY])/(3 l (1+l) r0^(7/2) (-3 M+r0)^(3/2) (-2 M+r0)^2),-((8 I m M \[Pi] (336 M^4-2 (208+54 l+54 l^2+45 m^2) M^3 r0+(172+136 l+136 l^2+71 m^2) M^2 r0^2-(24+57 l+57 l^2+14 m^2) M r0^3+8 l (1+l) r0^4) Conjugate[dY])/(3 l (1+l) (2 M-r0)^3 r0^(9/2) (-3 M+r0)^(3/2))),-(1/(3 l (1+l) r0^(9/2) (-3 M+r0)^(3/2) (-2 M+r0)^4))16 I m M \[Pi] (-6 (-56+28 l+28 l^2+65 m^2) M^4+(-416+24 l^3+12 l^4+389 m^2+3 m^4+4 l (46+3 m^2)+4 l^2 (49+3 m^2)) M^3 r0-(-172+32 l^3+16 l^4+123 m^2+m^4+10 l^2 (7+m^2)+2 l (27+5 m^2)) M^2 r0^2+(14 l^3+7 l^4+12 (-2+m^2)+2 l (-1+m^2)+l^2 (5+2 m^2)) M r0^3+l (2+l-2 l^2-l^3) r0^4) Conjugate[dY]},
_,{Indeterminate,Indeterminate}];
{cin2,cin4,cup2,cup4}=LinearSolve[\[CapitalPhi],J];
Function[{r},Evaluate[Piecewise[{{cin2 R2In[r]+cin4 R4In[r],r<r0},{cup2 R2Up[r]+cup4 R4Up[r],r>r0}},Indeterminate]]]
];


(* ::Input::Initialization:: *)
\[Psi]Z[l_,m_,r0_]/;EvenQ[l+m]:=Module[{M=1,\[CapitalOmega],\[Omega],\[CapitalPhi],J,Y,RIn,RUp,cin,cup},
\[CapitalOmega]=Sqrt[M/r0^3];
\[Omega]=m \[CapitalOmega];
Block[{$rminUp=r0-1,$rmaxIn=r0+1},
RIn=\[Psi]Z2In[l,\[Omega]];
RUp=\[Psi]Z2Up[l,\[Omega]];
];

\[CapitalPhi]={{-RIn[r0],RUp[r0]},{-RIn'[r0],RUp'[r0]}};
Y=SphericalHarmonicY[l,m,\[Pi]/2,0];
J={(32 \[Pi] (-2+r0)^3 Sqrt[r0/(-3+r0)] Conjugate[Y])/(l (1+l) (-2 M+r0)^2 (6+(-2+l+l^2) r0)),1/(2 M-r0)^2 r0^2 (-((64 M \[Pi] (-2+r0)^3 Sqrt[r0/(-3+r0)] Conjugate[Y])/(l (1+l) (2 M-r0) r0^3 (6+(-2+l+l^2) r0)))-1/((-1+l) l (1+l) (2+l) r0^3 (6+(-2+l+l^2) r0)^2) 16 \[Pi] (-2+r0) Sqrt[r0/(-3+r0)] (3 l^5 (-1+r0) r0^2+l^6 (-1+r0) r0^2-8 (-24+m^2 (-3+r0)^2+22 r0-5 r0^2)-l^4 r0 (8+(-11+2 m^2) r0+r0^2)-l^3 r0 (16+(-27+4 m^2) r0+7 r0^2)+6 l^2 (-10-4 (-4+m^2) r0+(-5+m^2) r0^2)+4 l (-15+(26-6 m^2) r0+(-11+2 m^2) r0^2+r0^3)) Conjugate[Y])};
{cin,cup}=LinearSolve[\[CapitalPhi],J];
Function[{r},Evaluate[Piecewise[{{cin RIn[r],r<=r0},{cup RUp[r],r>r0}},Indeterminate]]]
];


(* ::Input::Initialization:: *)
h[l_,m_,r0_]/;OddQ[l+m]:=Module[{M=1,\[Lambda]=1/2 (l-1)(l+2),\[Omega],\[Omega]p,\[CapitalOmega],\[CapitalOmega]p,\[Psi]1,\[Psi]2,\[Phi]1,\[Phi]2,h0,h1,h2,dr0h0,dr0h1,dr0h2},
\[CapitalOmega]=Sqrt[M/r0^3];
\[CapitalOmega]p=-3/2 Sqrt[M/r0^5];
\[Omega]=m \[CapitalOmega];
\[Omega]p=m \[CapitalOmega]p;
\[Psi]1=\[Psi][1,l,m,r0];
\[Psi]2=\[Psi][2,l,m,r0];
\[Phi]1=\[Phi][1,l,m,r0];
\[Phi]2=\[Phi][2,l,m,r0];

h0=Function[{r},Evaluate[1/(I \[Omega]) (\[Psi]1[r]+2/3 \[Lambda] \[Psi]2[r])]];

h1=Function[{r},Evaluate[1/(I \[Omega])^2 (-((2\[Lambda])/3)\[Psi]2'[r]+2/r \[Psi]1[r] -(2\[Lambda])/(3r) \[Psi]2[r]-\[Psi]1'[r])]];

h2=Function[{r},Evaluate[1/(I \[Omega])^2 (r(1-2M/r)\[Psi]2'[r]+\[Psi]1[r]+((3+2\[Lambda])r-6M)/(3r) \[Psi]2[r])]];
dr0h0=Function[{r},Evaluate[1/(I \[Omega]) (\[Phi]1[r]+2/3 \[Lambda] \[Phi]2[r])-h0[r]/\[Omega] \[Omega]p]];

dr0h1=Function[{r},Evaluate[1/(I \[Omega])^2 (-((2\[Lambda])/3)\[Phi]2'[r]+2/r \[Phi]1[r] -(2\[Lambda])/(3r) \[Phi]2[r]-\[Phi]1'[r])-2 h1[r]/\[Omega] \[Omega]p]];

dr0h2=Function[{r},Evaluate[1/(I \[Omega])^2 (r(1-2M/r)\[Phi]2'[r]+\[Phi]1[r]+((3+2\[Lambda])r-6M)/(3r) \[Phi]2[r])-2 h2[r]/\[Omega] \[Omega]p]];
<|"\!\(\*SubscriptBox[\(h\), \(0\)]\)"->h0,"\!\(\*SubscriptBox[\(h\), \(1\)]\)"->h1,"\!\(\*SubscriptBox[\(h\), \(2\)]\)"->h2,"\!\(\*SubscriptBox[\(h\), \(0, r0\)]\)"->dr0h0,"\!\(\*SubscriptBox[\(h\), \(1, r0\)]\)"->dr0h1,"\!\(\*SubscriptBox[\(h\), \(2, r0\)]\)"->dr0h2|>
];


(* ::Input::Initialization:: *)
h[l_,m_,r0_]/;EvenQ[l+m]:=Module[{M=1,\[Lambda]=1/2 (l-1)(l+2),\[Omega],\[Omega]p,\[CapitalOmega],\[CapitalOmega]p,\[Psi]z,\[Psi]1,\[Psi]0,\[Psi]0b,\[CapitalChi],\[Phi]z,\[Phi]1,\[Phi]0,\[Phi]0b,\[CapitalKappa],h0,h1,H0,H1,H2,G,k,dr0h0,dr0h1,dr0H0,dr0H1,dr0H2,dr0G,dr0k},
\[CapitalOmega]=Sqrt[M/r0^3];
\[CapitalOmega]p=-3/2 Sqrt[M/r0^5];
\[Omega]=m \[CapitalOmega];
\[Omega]p=m \[CapitalOmega]p;
\[Psi]z=\[Psi]Z[l,m,r0];
\[Psi]1=\[Psi][1,l,m,r0];
\[Psi]0=\[Psi][0,l,m,r0];
\[Psi]0b=\[Psi]b[0,l,m,r0];
\[CapitalChi]=\[Chi][l,m,r0];

\[Phi]z=\[Phi]Z[l,m,r0];
\[Phi]1=\[Phi][1,l,m,r0];
\[Phi]0=\[Phi][0,l,m,r0];
\[Phi]0b=\[Phi]b[0,l,m,r0];
\[CapitalKappa]=\[Kappa][l,m,r0];

H0=Function[{r},Evaluate[-((\[Lambda] (1+\[Lambda]) M (-3 M+(3+\[Lambda]) r) \[Psi]z'[r])/(3 (I \[Omega])^2 r^3 (3 M+\[Lambda] r)))+((-M+r) \[Psi]0[r])/((2 M-r) r)+(2 (-2 M^2+M r+(I \[Omega])^2 r^4) (\[Psi]0b[r]+\[CapitalChi][r]))/((2 M-r) r^4)+(4 I \[Omega] (1+\[Lambda]) \[Psi]1[r])/(2 M-r)-(\[Lambda] (1+\[Lambda]) (18 M^4+3 (-3+4 \[Lambda]) M^3 r+(I \[Omega])^2 \[Lambda]^2 r^6-3 \[Lambda] M r^3 (1+\[Lambda]-2 (I \[Omega])^2 r^2)+M^2 (6 \[Lambda]^2 r^2+9 (I \[Omega])^2 r^4)) \[Psi]z[r])/(3 (I \[Omega])^2 (2 M-r) r^4 (3 M+\[Lambda] r)^2)+\[Psi]0'[r]+(2 M (\[Psi]0b'[r]+\[CapitalChi]'[r]))/r^3+(4 (1+\[Lambda]) M \[Psi]1'[r])/(I \[Omega] r^3)]];
H1=Function[{r},Evaluate[-((\[Lambda] (1+\[Lambda])\[Psi]z'[r] )/(3 I \[Omega] r))-((6 M+4 \[Lambda] M-3 r-2 \[Lambda] r-2 (I \[Omega])^2 r^3) \[Psi]0[r])/(4 I \[Omega] M r^2-2 I \[Omega] r^3)+((2+2 \[Lambda]) \[Psi]1[r])/(2 M r-r^2)+(2 I \[Omega] (-M+r) (\[Psi]0b[r]+\[CapitalChi][r]))/((2 M-r) r^2)-(\[Lambda] (1+\[Lambda]) (3 M^2+3 \[Lambda] M r-\[Lambda] r^2) \[Psi]z[r])/(3 I \[Omega] (2 M-r) r^2 (3 M+\[Lambda] r))+(\[Psi]0'[r])/(2 I \[Omega] r)+(2 I \[Omega] (\[Psi]0b'[r]+\[CapitalChi]'[r]))/r+(4 (1+\[Lambda]) \[Psi]1'[r])/r]];
H2=Function[{r},Evaluate[(\[Lambda] (1+\[Lambda]) (-9 M^2+(3-5 \[Lambda]) M r+2 \[Lambda] r^2)\[Psi]z'[r] )/(3 (I \[Omega])^2 r^3 (3 M+\[Lambda] r))+((-3 M+2 r)\[Psi]0[r])/((2 M-r) r)+(2 (6 M^2-(11+4 \[Lambda]) M r+r^2 (4+2 \[Lambda]+(I \[Omega])^2 r^2)) (\[Psi]0b[r]+\[CapitalChi][r]))/((2 M-r) r^4)+(4 (1+\[Lambda]) (-4 (1+\[Lambda]) M+r (2+2 \[Lambda]+(I \[Omega])^2 r^2)) \[Psi]1[r])/(I \[Omega] (2 M-r) r^3)-(\[Lambda] (\[Lambda]+1) (-54 M^4+3 (9-16 \[Lambda]) M^3 r+\[Lambda]^2 r^4 (2+2 \[Lambda]+(I \[Omega])^2 r^2)+9 M^2 r^2 (2 \[Lambda]-2 \[Lambda]^2+(I \[Omega])^2 r^2)+\[Lambda] M r^3 (3+5 \[Lambda]-4 \[Lambda]^2+6 (I \[Omega])^2 r^2)) \[Psi]z[r])/(3 (I \[Omega])^2 (2 M-r) r^4 (3 M+\[Lambda] r)^2)+\[Psi]0'[r]+((-6 M+4 r) (\[Psi]0b'[r]+\[CapitalChi]'[r]))/r^3-(4 (1+\[Lambda]) (M-r) \[Psi]1'[r])/(I \[Omega] r^3)]];
h0=Function[{r},Evaluate[(\[Lambda] (2 M-r)\[Psi]z'[r])/(3 I \[Omega] r)+((-2 M+r)\[Psi]0[r])/(2 I \[Omega] r^2)+(2 I \[Omega] (\[Psi]0b[r]+\[CapitalChi][r]))/r+(4 (1+\[Lambda])\[Psi]1[r])/r-(\[Lambda] (6 M^2+3 \[Lambda] M r+\[Lambda] (1+\[Lambda]) r^2) \[Psi]z[r])/(3 I \[Omega] r^2 (3 M+\[Lambda] r))-((-2 M+r)\[Psi]0'[r])/(2 I \[Omega] r)+(1-(2 M)/r) \[Psi]1'[r]]];
h1=Function[{r},Evaluate[(\[Lambda] ((3+\[Lambda]) M+\[Lambda] (2+\[Lambda]) r) \[Psi]z'[r])/(3 (I \[Omega])^2 r (3 M+\[Lambda] r))-(r \[Psi]0[r])/(4 M-2 r)+(4 (\[Psi]0b[r]+\[CapitalChi][r]))/r^2+((8 M+8 \[Lambda] M-4 r-4 \[Lambda] r+(I \[Omega])^2 r^3) \[Psi]1[r])/(2 I \[Omega] M r^2-I \[Omega] r^3)-(\[Lambda] (9 (I \[Omega])^2 M^2 r^3+2 \[Lambda]^3 r^2 (-2 M+r)+\[Lambda]^2 r (-12 M^2+2 M r+2 r^2+(I \[Omega])^2 r^4)+3 \[Lambda] M (-4 M^2+r^2+2 (I \[Omega])^2 r^4)) \[Psi]z[r])/(3 (I \[Omega])^2 (2 M-r) r^2 (3 M+\[Lambda] r)^2)-(2 (\[Psi]0b'[r]+\[CapitalChi]'[r]))/r-(2 (2 M+r+2 \[Lambda] r) \[Psi]1'[r])/(I \[Omega] r^2)]];
G=Function[{r},Evaluate[-((\[Lambda] (3+2 \[Lambda]) (2 M-r) \[Psi]z'[r])/(6 (I \[Omega])^2 r^2 (3 M+\[Lambda] r)))-(\[Psi]0b[r]+\[CapitalChi][r])/r^3-(2 (1+\[Lambda]) \[Psi]1[r])/(I \[Omega] r^3)+((4 \[Lambda]^3 r^2+\[Lambda]^4 r^2+27 (I \[Omega])^2 M^2 r^2+9 \[Lambda] M (M+2 (I \[Omega])^2 r^3)+3 \[Lambda]^2 (M^2+M r+r^2+(I \[Omega])^2 r^4)) \[Psi]z[r])/(6 (I \[Omega])^2 r^3 (3 M+\[Lambda] r)^2)+((2 M-r) \[Psi]1'[r])/(I \[Omega] r^3)]];
k=Function[{r},Evaluate[(\[Lambda] (1+\[Lambda]) (2 M-r) \[Psi]z'[r])/(3 (I \[Omega])^2 r^3)+\[Psi]0[r]/r+((-4 M+2 (2+\[Lambda]) r) (\[Psi]0b[r]+\[CapitalChi][r]))/r^4+(4 (1+\[Lambda])^2 \[Psi]1[r])/(I \[Omega] r^3)-(\[Lambda] (1+\[Lambda]) (6 M^2+3 \[Lambda] M r+\[Lambda] (1+\[Lambda]) r^2) \[Psi]z[r])/(3 (I \[Omega])^2 r^4 (3 M+\[Lambda] r))+((4 M-2 r) (\[Psi]0b'[r]+\[CapitalChi]'[r]))/r^3+(2 (1+\[Lambda]) (2 M-r) \[Psi]1'[r])/(I \[Omega] r^3)]];

dr0H0=Function[{r},Evaluate[-((\[Lambda] (1+\[Lambda]) M (-3 M+(3+\[Lambda]) r) \[Phi]z'[r])/(3 (I \[Omega])^2 r^3 (3 M+\[Lambda] r)))+((-M+r) \[Phi]0[r])/((2 M-r) r)+(2 (-2 M^2+M r+(I \[Omega])^2 r^4) (\[Phi]0b[r]+\[CapitalKappa][r]))/((2 M-r) r^4)+(4 I \[Omega] (1+\[Lambda]) \[Phi]1[r])/(2 M-r)-(\[Lambda] (1+\[Lambda]) (18 M^4+3 (-3+4 \[Lambda]) M^3 r+(I \[Omega])^2 \[Lambda]^2 r^6-3 \[Lambda] M r^3 (1+\[Lambda]-2 (I \[Omega])^2 r^2)+M^2 (6 \[Lambda]^2 r^2+9 (I \[Omega])^2 r^4)) \[Phi]z[r])/(3 (I \[Omega])^2 (2 M-r) r^4 (3 M+\[Lambda] r)^2)+\[Phi]0'[r]+(2 M (\[Phi]0b'[r]+\[CapitalKappa]'[r]))/r^3+(4 (1+\[Lambda]) M \[Phi]1'[r])/(I \[Omega] r^3)+\[Omega]p(-((4 \[Omega] (\[CapitalChi][r]+\[Psi]0b[r]))/(2 M-r))+(4 I (1+\[Lambda]) \[Psi]1[r])/(2 M-r)+(\[Lambda] (1+\[Lambda]) (-18 M^2 r^4 \[Omega]-12 M r^5 \[Lambda] \[Omega]-2 r^6 \[Lambda]^2 \[Omega]) \[Psi]z[r])/(3 (2 M-r) r^4 (3 M+r \[Lambda])^2 \[Omega]^2)-(2 \[Lambda] (1+\[Lambda]) (18 M^4+3 M^3 r (-3+4 \[Lambda])-r^6 \[Lambda]^2 \[Omega]^2-3 M r^3 \[Lambda] (1+\[Lambda]+2 r^2 \[Omega]^2)+M^2 (6 r^2 \[Lambda]^2-9 r^4 \[Omega]^2)) \[Psi]z[r])/(3 (2 M-r) r^4 (3 M+r \[Lambda])^2 \[Omega]^3)+(4 I M (1+\[Lambda]) Derivative[1][\[Psi]1][r])/(r^3 \[Omega]^2)-(2 M \[Lambda] (1+\[Lambda]) (-3 M+r (3+\[Lambda])) Derivative[1][\[Psi]z][r])/(3 r^3 (3 M+r \[Lambda]) \[Omega]^3))]];
dr0H1=Function[{r},Evaluate[-((\[Lambda] (1+\[Lambda])\[Phi]z'[r] )/(3 I \[Omega] r))-((6 M+4 \[Lambda] M-3 r-2 \[Lambda] r-2 (I \[Omega])^2 r^3) \[Phi]0[r])/(4 I \[Omega] M r^2-2 I \[Omega] r^3)+((2+2 \[Lambda]) \[Phi]1[r])/(2 M r-r^2)+(2 I \[Omega] (-M+r) (\[Phi]0b[r]+\[CapitalKappa][r]))/((2 M-r) r^2)-(\[Lambda] (1+\[Lambda]) (3 M^2+3 \[Lambda] M r-\[Lambda] r^2) \[Phi]z[r])/(3 I \[Omega] (2 M-r) r^2 (3 M+\[Lambda] r))+(\[Phi]0'[r])/(2 I \[Omega] r)+(2 I \[Omega] (\[Phi]0b'[r]+\[CapitalKappa]'[r]))/r+(4 (1+\[Lambda]) \[Phi]1'[r])/r+\[Omega]p(-((4 r^3 \[Omega] \[Psi]0[r])/(4 I M r^2 \[Omega]-2 I r^3 \[Omega]))+((4 I M r^2-2 I r^3) (6 M-3 r+4 M \[Lambda]-2 r \[Lambda]+2 r^3 \[Omega]^2) \[Psi]0[r])/(4 I M r^2 \[Omega]-2 I r^3 \[Omega])^2+(2 I (-M+r) (\[CapitalChi][r]+\[Psi]0b[r]))/((2 M-r) r^2)-(I \[Lambda] (1+\[Lambda]) (3 M^2+3 M r \[Lambda]-r^2 \[Lambda]) \[Psi]z[r])/(3 (2 M-r) r^2 (3 M+r \[Lambda]) \[Omega]^2)+(I Derivative[1][\[Psi]0][r])/(2 r \[Omega]^2)+(2 I (Derivative[1][\[CapitalChi]][r]+Derivative[1][\[Psi]0b][r]))/r-(I \[Lambda] (1+\[Lambda]) Derivative[1][\[Psi]z][r])/(3 r \[Omega]^2))]];
dr0H2=Function[{r},Evaluate[(\[Lambda] (1+\[Lambda]) (-9 M^2+(3-5 \[Lambda]) M r+2 \[Lambda] r^2)\[Phi]z'[r] )/(3 (I \[Omega])^2 r^3 (3 M+\[Lambda] r))+((-3 M+2 r)\[Phi]0[r])/((2 M-r) r)+(2 (6 M^2-(11+4 \[Lambda]) M r+r^2 (4+2 \[Lambda]+(I \[Omega])^2 r^2)) (\[Phi]0b[r]+\[CapitalKappa][r]))/((2 M-r) r^4)+(4 (1+\[Lambda]) (-4 (1+\[Lambda]) M+r (2+2 \[Lambda]+(I \[Omega])^2 r^2)) \[Phi]1[r])/(I \[Omega] (2 M-r) r^3)-(\[Lambda] (\[Lambda]+1) (-54 M^4+3 (9-16 \[Lambda]) M^3 r+\[Lambda]^2 r^4 (2+2 \[Lambda]+(I \[Omega])^2 r^2)+9 M^2 r^2 (2 \[Lambda]-2 \[Lambda]^2+(I \[Omega])^2 r^2)+\[Lambda] M r^3 (3+5 \[Lambda]-4 \[Lambda]^2+6 (I \[Omega])^2 r^2)) \[Phi]z[r])/(3 (I \[Omega])^2 (2 M-r) r^4 (3 M+\[Lambda] r)^2)+\[Phi]0'[r]+((-6 M+4 r) (\[Phi]0b'[r]+\[CapitalKappa]'[r]))/r^3-(4 (1+\[Lambda]) (M-r) \[Phi]1'[r])/(I \[Omega] r^3)+\[Omega]p(-((4 \[Omega] (\[CapitalChi][r]+\[Psi]0b[r]))/(2 M-r))+(8 I (1+\[Lambda]) \[Psi]1[r])/(2 M-r)+(4 I (1+\[Lambda]) (-4 M (1+\[Lambda])+r (2+2 \[Lambda]-r^2 \[Omega]^2)) \[Psi]1[r])/((2 M-r) r^3 \[Omega]^2)+(\[Lambda] (1+\[Lambda]) (-18 M^2 r^4 \[Omega]-12 M r^5 \[Lambda] \[Omega]-2 r^6 \[Lambda]^2 \[Omega]) \[Psi]z[r])/(3 (2 M-r) r^4 (3 M+r \[Lambda])^2 \[Omega]^2)-(2 \[Lambda] (1+\[Lambda]) (-54 M^4+3 M^3 r (9-16 \[Lambda])+M r^3 \[Lambda] (3+5 \[Lambda]-4 \[Lambda]^2-6 r^2 \[Omega]^2)+r^4 \[Lambda]^2 (2+2 \[Lambda]-r^2 \[Omega]^2)+9 M^2 r^2 (2 \[Lambda]-2 \[Lambda]^2-r^2 \[Omega]^2)) \[Psi]z[r])/(3 (2 M-r) r^4 (3 M+r \[Lambda])^2 \[Omega]^3)-(4 I (M-r) (1+\[Lambda]) Derivative[1][\[Psi]1][r])/(r^3 \[Omega]^2)+(2 \[Lambda] (1+\[Lambda]) (-9 M^2+M r (3-5 \[Lambda])+2 r^2 \[Lambda]) Derivative[1][\[Psi]z][r])/(3 r^3 (3 M+r \[Lambda]) \[Omega]^3))]];
dr0h0=Function[{r},Evaluate[(\[Lambda] (2 M-r)\[Phi]z'[r])/(3 I \[Omega] r)+((-2 M+r)\[Phi]0[r])/(2 I \[Omega] r^2)+(2 I \[Omega] (\[Phi]0b[r]+\[CapitalKappa][r]))/r+(4 (1+\[Lambda])\[Phi]1[r])/r-(\[Lambda] (6 M^2+3 \[Lambda] M r+\[Lambda] (1+\[Lambda]) r^2) \[Phi]z[r])/(3 I \[Omega] r^2 (3 M+\[Lambda] r))-((-2 M+r)\[Phi]0'[r])/(2 I \[Omega] r)+(1-(2 M)/r) \[Phi]1'[r]+\[Omega]p((I (-2 M+r) \[Psi]0[r])/(2 r^2 \[Omega]^2)+(2 I (\[CapitalChi][r]+\[Psi]0b[r]))/r-(I \[Lambda] (6 M^2+3 M r \[Lambda]+r^2 \[Lambda] (1+\[Lambda])) \[Psi]z[r])/(3 r^2 (3 M+r \[Lambda]) \[Omega]^2)-(I (-2 M+r) Derivative[1][\[Psi]0][r])/(2 r \[Omega]^2)+(I (2 M-r) \[Lambda] Derivative[1][\[Psi]z][r])/(3 r \[Omega]^2))]];
dr0h1=Function[{r},Evaluate[(\[Lambda] ((3+\[Lambda]) M+\[Lambda] (2+\[Lambda]) r) \[Phi]z'[r])/(3 (I \[Omega])^2 r (3 M+\[Lambda] r))-(r \[Phi]0[r])/(4 M-2 r)+(4 (\[Phi]0b[r]+\[CapitalKappa][r]))/r^2+((8 M+8 \[Lambda] M-4 r-4 \[Lambda] r+(I \[Omega])^2 r^3) \[Phi]1[r])/(2 I \[Omega] M r^2-I \[Omega] r^3)-(\[Lambda] (9 (I \[Omega])^2 M^2 r^3+2 \[Lambda]^3 r^2 (-2 M+r)+\[Lambda]^2 r (-12 M^2+2 M r+2 r^2+(I \[Omega])^2 r^4)+3 \[Lambda] M (-4 M^2+r^2+2 (I \[Omega])^2 r^4)) \[Phi]z[r])/(3 (I \[Omega])^2 (2 M-r) r^2 (3 M+\[Lambda] r)^2)-(2 (\[Phi]0b'[r]+\[CapitalKappa]'[r]))/r-(2 (2 M+r+2 \[Lambda] r) \[Phi]1'[r])/(I \[Omega] r^2)+\[Omega]p(-((2 r^3 \[Omega] \[Psi]1[r])/(2 I M r^2 \[Omega]-I r^3 \[Omega]))-((2 I M r^2-I r^3) (8 M-4 r+8 M \[Lambda]-4 r \[Lambda]-r^3 \[Omega]^2) \[Psi]1[r])/(2 I M r^2 \[Omega]-I r^3 \[Omega])^2+(\[Lambda] (-18 M^2 r^3 \[Omega]-12 M r^4 \[Lambda] \[Omega]-2 r^5 \[Lambda]^2 \[Omega]) \[Psi]z[r])/(3 (2 M-r) r^2 (3 M+r \[Lambda])^2 \[Omega]^2)-(2 \[Lambda] (2 r^2 (-2 M+r) \[Lambda]^3-9 M^2 r^3 \[Omega]^2+3 M \[Lambda] (-4 M^2+r^2-2 r^4 \[Omega]^2)+r \[Lambda]^2 (-12 M^2+2 M r+2 r^2-r^4 \[Omega]^2)) \[Psi]z[r])/(3 (2 M-r) r^2 (3 M+r \[Lambda])^2 \[Omega]^3)-(2 I (2 M+r+2 r \[Lambda]) Derivative[1][\[Psi]1][r])/(r^2 \[Omega]^2)+(2 \[Lambda] (r \[Lambda] (2+\[Lambda])+M (3+\[Lambda])) Derivative[1][\[Psi]z][r])/(3 r (3 M+r \[Lambda]) \[Omega]^3))]];
dr0G=Function[{r},Evaluate[-((\[Lambda] (3+2 \[Lambda]) (2 M-r) \[Phi]z'[r])/(6 (I \[Omega])^2 r^2 (3 M+\[Lambda] r)))-(\[Phi]0b[r]+\[CapitalKappa][r])/r^3-(2 (1+\[Lambda]) \[Phi]1[r])/(I \[Omega] r^3)+((4 \[Lambda]^3 r^2+\[Lambda]^4 r^2+27 (I \[Omega])^2 M^2 r^2+9 \[Lambda] M (M+2 (I \[Omega])^2 r^3)+3 \[Lambda]^2 (M^2+M r+r^2+(I \[Omega])^2 r^4)) \[Phi]z[r])/(6 (I \[Omega])^2 r^3 (3 M+\[Lambda] r)^2)+((2 M-r) \[Phi]1'[r])/(I \[Omega] r^3)+\[Omega]p(-((2 I (1+\[Lambda]) \[Psi]1[r])/(r^3 \[Omega]^2))-((-54 M^2 r^2 \[Omega]-36 M r^3 \[Lambda] \[Omega]-6 r^4 \[Lambda]^2 \[Omega]) \[Psi]z[r])/(6 r^3 (3 M+r \[Lambda])^2 \[Omega]^2)+((4 r^2 \[Lambda]^3+r^2 \[Lambda]^4-27 M^2 r^2 \[Omega]^2+9 M \[Lambda] (M-2 r^3 \[Omega]^2)+3 \[Lambda]^2 (M^2+M r+r^2-r^4 \[Omega]^2)) \[Psi]z[r])/(3 r^3 (3 M+r \[Lambda])^2 \[Omega]^3)+(I (2 M-r) Derivative[1][\[Psi]1][r])/(r^3 \[Omega]^2)-((2 M-r) \[Lambda] (3+2 \[Lambda]) Derivative[1][\[Psi]z][r])/(3 r^2 (3 M+r \[Lambda]) \[Omega]^3))]];
dr0k=Function[{r},Evaluate[(\[Lambda] (1+\[Lambda]) (2 M-r) \[Phi]z'[r])/(3 (I \[Omega])^2 r^3)+\[Phi]0[r]/r+((-4 M+2 (2+\[Lambda]) r) (\[Phi]0b[r]+\[CapitalKappa][r]))/r^4+(4 (1+\[Lambda])^2 \[Phi]1[r])/(I \[Omega] r^3)-(\[Lambda] (1+\[Lambda]) (6 M^2+3 \[Lambda] M r+\[Lambda] (1+\[Lambda]) r^2) \[Phi]z[r])/(3 (I \[Omega])^2 r^4 (3 M+\[Lambda] r))+((4 M-2 r) (\[Phi]0b'[r]+\[CapitalKappa]'[r]))/r^3+(2 (1+\[Lambda]) (2 M-r) \[Phi]1'[r])/(I \[Omega] r^3)+\[Omega]p((4 I (1+\[Lambda])^2 \[Psi]1[r])/(r^3 \[Omega]^2)-(2 \[Lambda] (1+\[Lambda]) (6 M^2+3 M r \[Lambda]+r^2 \[Lambda] (1+\[Lambda])) \[Psi]z[r])/(3 r^4 (3 M+r \[Lambda]) \[Omega]^3)+(2 I (2 M-r) (1+\[Lambda]) Derivative[1][\[Psi]1][r])/(r^3 \[Omega]^2)+(2 (2 M-r) \[Lambda] (1+\[Lambda]) Derivative[1][\[Psi]z][r])/(3 r^3 \[Omega]^3))]];
<|"\!\(\*SubscriptBox[\(H\), \(0\)]\)"->H0,"\!\(\*SubscriptBox[\(H\), \(1\)]\)"->H1,"\!\(\*SubscriptBox[\(H\), \(2\)]\)"->H2,"\!\(\*SubscriptBox[\(h\), \(0\)]\)"->h0,"\!\(\*SubscriptBox[\(h\), \(1\)]\)"->h1,"G"->G,"K"->k,"\!\(\*SubscriptBox[\(H\), \(0, r0\)]\)"->dr0H0,"\!\(\*SubscriptBox[\(H\), \(1, r0\)]\)"->dr0H1,"\!\(\*SubscriptBox[\(H\), \(2, r0\)]\)"->dr0H2,"\!\(\*SubscriptBox[\(h\), \(0, r0\)]\)"->dr0h0,"\!\(\*SubscriptBox[\(h\), \(1, r0\)]\)"->dr0h1,"\!\(\*SubscriptBox[\(G\), \(\(,\)\(r0\)\)]\)"->dr0G,"\!\(\*SubscriptBox[\(K\), \(\(,\)\(r0\)\)]\)"->dr0k|>
];


(* ::Input::Initialization:: *)
hbar[l_,m_,r0_]:= Module[{M=1,hB,hbar1,hbar2,hbar3,hbar4,hbar5,hbar6,hbar7,hbar8,hbar9,hbar10,dr0hbar1,dr0hbar2,dr0hbar3,dr0hbar4,dr0hbar5,dr0hbar6,dr0hbar7,dr0hbar8,dr0hbar9,dr0hbar10,res},
hB=h[l,m,r0];

If[EvenQ[l+m],
hbar1=Function[{r},Evaluate[r (1-2M/r)(hB["\!\(\*SubscriptBox[\(H\), \(0\)]\)"][r]+hB["\!\(\*SubscriptBox[\(H\), \(2\)]\)"][r])]];
hbar2=Function[{r},Evaluate[2 r (1-2M/r) hB["\!\(\*SubscriptBox[\(H\), \(1\)]\)"][r]]];
hbar3=Function[{r},Evaluate[2 r hB["K"][r]]];
hbar4=Function[{r},Evaluate[2 l(1+l) hB["\!\(\*SubscriptBox[\(h\), \(0\)]\)"][r]]];
hbar5=Function[{r},Evaluate[(2 (1-2 M/r) l(1+l) hB["\!\(\*SubscriptBox[\(h\), \(1\)]\)"][r])]];
hbar6=Function[{r},Evaluate[r ( hB["\!\(\*SubscriptBox[\(H\), \(0\)]\)"][r]-hB["\!\(\*SubscriptBox[\(H\), \(2\)]\)"][r])]];
hbar7=Function[{r},Evaluate[2 r (l-1)l(1+l)(l+2) hB["G"][r]]];
dr0hbar1=Function[{r},Evaluate[r (1-2M/r)(hB["\!\(\*SubscriptBox[\(H\), \(0, r0\)]\)"][r]+hB["\!\(\*SubscriptBox[\(H\), \(2, r0\)]\)"][r])]];
dr0hbar2=Function[{r},Evaluate[2 r (1-2M/r) hB["\!\(\*SubscriptBox[\(H\), \(1, r0\)]\)"][r]]];
dr0hbar3=Function[{r},Evaluate[2 r hB["\!\(\*SubscriptBox[\(K\), \(\(,\)\(r0\)\)]\)"][r]]];
dr0hbar4=Function[{r},Evaluate[2 l(1+l) hB["\!\(\*SubscriptBox[\(h\), \(0, r0\)]\)"][r]]];
dr0hbar5=Function[{r},Evaluate[(2 (1-2 M/r) l(1+l) hB["\!\(\*SubscriptBox[\(h\), \(1, r0\)]\)"][r])]];
dr0hbar6=Function[{r},Evaluate[r ( hB["\!\(\*SubscriptBox[\(H\), \(0, r0\)]\)"][r]-hB["\!\(\*SubscriptBox[\(H\), \(2, r0\)]\)"][r])]];
dr0hbar7=Function[{r},Evaluate[2 r (l-1)l(1+l)(l+2) hB["\!\(\*SubscriptBox[\(G\), \(\(,\)\(r0\)\)]\)"][r]]];
res=<|"\!\(\*OverscriptBox[\(h\), \(_\)]\)"-><|1->hbar1,2->hbar2,3->hbar3,4->hbar4,5->hbar5,6->hbar6,7->hbar7|>,
"\!\(\*SubscriptBox[OverscriptBox[\(h\), \(_\)], \(\(,\)\(r0\)\)]\)"-><|1->dr0hbar1,2->dr0hbar2,3->dr0hbar3,4->dr0hbar4,5->dr0hbar5,6->dr0hbar6,7->dr0hbar7|>|>;
,
hbar8=Function[{r},Evaluate[2 l(1+l) hB["\!\(\*SubscriptBox[\(h\), \(0\)]\)"][r]]];
hbar9=Function[{r},Evaluate[(2 (1-2 M/r) l(1+l) hB["\!\(\*SubscriptBox[\(h\), \(1\)]\)"][r])]];
hbar10=Function[{r},Evaluate[(-(1/r)2 (-1+l) l (1+l) (2+l) hB["\!\(\*SubscriptBox[\(h\), \(2\)]\)"][r])]];
dr0hbar8=Function[{r},Evaluate[2 l(1+l) hB["\!\(\*SubscriptBox[\(h\), \(0, r0\)]\)"][r]]];
dr0hbar9=Function[{r},Evaluate[(2 (1-2 M/r) l(1+l) hB["\!\(\*SubscriptBox[\(h\), \(1, r0\)]\)"][r])]];
dr0hbar10=Function[{r},Evaluate[(-(1/r)2 (-1+l) l (1+l) (2+l) hB["\!\(\*SubscriptBox[\(h\), \(2, r0\)]\)"][r])]];
res=<|"\!\(\*OverscriptBox[\(h\), \(_\)]\)"-><|8->hbar8,9->hbar9,10->hbar10|>,
"\!\(\*SubscriptBox[OverscriptBox[\(h\), \(_\)], \(\(,\)\(r0\)\)]\)"-><|8->dr0hbar8,9->dr0hbar9,10->dr0hbar10|>|>;
];
res
]


(* ::Input::Initialization:: *)
hbar[l_,m_,r0_,rgridL_,rgridR_]/;OddQ[l+m]:=Module[{M=1,\[Lambda]=1/2 (l-1)(l+2),\[Omega],\[Omega]p,\[CapitalOmega],\[CapitalOmega]p,
\[Psi]1,\[Psi]1inhom,\[Psi]1Right,\[Psi]1Left,\[Psi]1GridRight,\[Psi]1GridLeft,d\[Psi]1GridRight,d\[Psi]1GridLeft,dd\[Psi]1GridRight,dd\[Psi]1GridLeft,
\[Psi]2,\[Psi]2inhom,\[Psi]2Right,\[Psi]2Left,\[Psi]2GridRight,\[Psi]2GridLeft,d\[Psi]2GridRight,d\[Psi]2GridLeft,dd\[Psi]2GridRight,dd\[Psi]2GridLeft,
\[Phi]1,\[Phi]1inhom,\[Phi]1Right,\[Phi]1Left,\[Phi]1GridRight,\[Phi]1GridLeft,d\[Phi]1GridRight,d\[Phi]1GridLeft,dd\[Phi]1GridRight,dd\[Phi]1GridLeft,
\[Phi]2,\[Phi]2inhom,\[Phi]2Right,\[Phi]2Left,\[Phi]2GridRight,\[Phi]2GridLeft,d\[Phi]2GridRight,d\[Phi]2GridLeft,dd\[Phi]2GridRight,dd\[Phi]2GridLeft,
r,h0,h1,h2,dr0h0,dr0h1,dr0h2,hbar8,hbar9,hbar10,dr0hbar8,dr0hbar9,dr0hbar10,fields},
\[CapitalOmega]=Sqrt[M/r0^3];
\[CapitalOmega]p=-3/2 Sqrt[M/r0^5];
\[Omega]=m \[CapitalOmega];
\[Omega]p=m \[CapitalOmega]p;

\[Psi]1inhom=\[Psi][1,l,m,r0];
\[Psi]1Right=Function[{r},Evaluate[\[Psi]1inhom[r][[1,2,1]]]];
\[Psi]1Left=Function[{r},Evaluate[\[Psi]1inhom[r][[1,1,1]]]];
\[Psi]1GridRight=\[Psi]1Right/@rgridR;
\[Psi]1GridLeft=\[Psi]1Left/@rgridL;
d\[Psi]1GridRight=\[Psi]1Right'/@rgridR;
d\[Psi]1GridLeft=\[Psi]1Left'/@rgridL;
dd\[Psi]1GridRight=\[Psi]1Right''/@rgridR;
dd\[Psi]1GridLeft=\[Psi]1Left''/@rgridL;

\[Psi]2inhom=\[Psi][2,l,m,r0];
\[Psi]2Right=Function[{r},Evaluate[\[Psi]2inhom[r][[1,2,1]]]];
\[Psi]2Left=Function[{r},Evaluate[\[Psi]2inhom[r][[1,1,1]]]];
\[Psi]2GridRight=\[Psi]2Right/@rgridR;
\[Psi]2GridLeft=\[Psi]2Left/@rgridL;
d\[Psi]2GridRight=\[Psi]2Right'/@rgridR;
d\[Psi]2GridLeft=\[Psi]2Left'/@rgridL;
dd\[Psi]2GridRight=\[Psi]2Right''/@rgridR;
dd\[Psi]2GridLeft=\[Psi]2Left''/@rgridL;

\[Phi]1inhom=\[Phi][1,l,m,r0];
\[Phi]1Right=Function[{r},Evaluate[\[Phi]1inhom[r][[1,2,1]]]];
\[Phi]1Left=Function[{r},Evaluate[\[Phi]1inhom[r][[1,1,1]]]];
\[Phi]1GridRight=\[Phi]1Right/@rgridR;
\[Phi]1GridLeft=\[Phi]1Left/@rgridL;
d\[Phi]1GridRight=\[Phi]1Right'/@rgridR;
d\[Phi]1GridLeft=\[Phi]1Left'/@rgridL;
dd\[Phi]1GridRight=\[Phi]1Right''/@rgridR;
dd\[Phi]1GridLeft=\[Phi]1Left''/@rgridL;

\[Phi]2inhom=\[Phi][2,l,m,r0];
\[Phi]2Right=Function[{r},Evaluate[\[Phi]2inhom[r][[1,2,1]]]];
\[Phi]2Left=Function[{r},Evaluate[\[Phi]2inhom[r][[1,1,1]]]];
\[Phi]2GridRight=\[Phi]2Right/@rgridR;
\[Phi]2GridLeft=\[Phi]2Left/@rgridL;
d\[Phi]2GridRight=\[Phi]2Right'/@rgridR;
d\[Phi]2GridLeft=\[Phi]2Left'/@rgridL;
dd\[Phi]2GridRight=\[Phi]2Right''/@rgridR;
dd\[Phi]2GridLeft=\[Phi]2Left''/@rgridL;

h0=Function[{r},Evaluate[1/(I \[Omega]) (\[Psi]1[r]+2/3 \[Lambda] \[Psi]2[r])]];

h1=Function[{r},Evaluate[1/(I \[Omega])^2 (-((2\[Lambda])/3)\[Psi]2'[r]+2/r \[Psi]1[r] -(2\[Lambda])/(3r) \[Psi]2[r]-\[Psi]1'[r])]];

h2=Function[{r},Evaluate[1/(I \[Omega])^2 (r(1-2M/r)\[Psi]2'[r]+\[Psi]1[r]+((3+2\[Lambda])r-6M)/(3r) \[Psi]2[r])]];
dr0h0=Function[{r},Evaluate[1/(I \[Omega]) (\[Phi]1[r]+2/3 \[Lambda] \[Phi]2[r])-h0[r]/\[Omega] \[Omega]p]];

dr0h1=Function[{r},Evaluate[1/(I \[Omega])^2 (-((2\[Lambda])/3)\[Phi]2'[r]+2/r \[Phi]1[r] -(2\[Lambda])/(3r) \[Phi]2[r]-\[Phi]1'[r])-2 h1[r]/\[Omega] \[Omega]p]];

dr0h2=Function[{r},Evaluate[1/(I \[Omega])^2 (r(1-2M/r)\[Phi]2'[r]+\[Phi]1[r]+((3+2\[Lambda])r-6M)/(3r) \[Phi]2[r])-2 h2[r]/\[Omega] \[Omega]p]];
hbar8=Function[{r},Evaluate[2 l(1+l) h0[r]]];
hbar9=Function[{r},Evaluate[(2 (1-2 M/r) l(1+l) h1[r])]];
hbar10=Function[{r},Evaluate[(-(1/r)2 (-1+l) l (1+l) (2+l) h2[r])]];
dr0hbar8=Function[{r},Evaluate[2 l(1+l) dr0h0[r]]];
dr0hbar9=Function[{r},Evaluate[(2 (1-2 M/r) l(1+l) dr0h1[r])]];
dr0hbar10=Function[{r},Evaluate[(-(1/r)2 (-1+l) l (1+l) (2+l) dr0h2[r])]];
fields=Simplify[{{hbar9[r],hbar9'[r],hbar10[r],hbar10'[r],hbar8[r],hbar8'[r]},
{dr0hbar9[r],dr0hbar9'[r],dr0hbar10[r],dr0hbar10'[r],dr0hbar8[r],dr0hbar8'[r]}}];
{Flatten[Transpose[ReIm[fields/.{\[Psi]1[r]->\[Psi]1GridLeft,\[Psi]1'[r]->d\[Psi]1GridLeft,\[Psi]1''[r]->dd\[Psi]1GridLeft,\[Psi]2[r]->\[Psi]2GridLeft,\[Psi]2'[r]->d\[Psi]2GridLeft,\[Psi]2''[r]->dd\[Psi]2GridLeft,\[Phi]1[r]->\[Phi]1GridLeft,\[Phi]1'[r]->d\[Phi]1GridLeft,\[Phi]1''[r]->dd\[Phi]1GridLeft,\[Phi]2[r]->\[Phi]2GridLeft,\[Phi]2'[r]->d\[Phi]2GridLeft,\[Phi]2''[r]->dd\[Phi]2GridLeft,r->rgridL}],{1,3,2,4}],{{1},{2},{3,4}}],Flatten[Transpose[ReIm[fields/.{\[Psi]1[r]->\[Psi]1GridRight,\[Psi]1'[r]->d\[Psi]1GridRight,\[Psi]1''[r]->dd\[Psi]1GridRight,\[Psi]2[r]->\[Psi]2GridRight,\[Psi]2'[r]->d\[Psi]2GridRight,\[Psi]2''[r]->dd\[Psi]2GridRight,\[Phi]1[r]->\[Phi]1GridRight,\[Phi]1'[r]->d\[Phi]1GridRight,\[Phi]1''[r]->dd\[Phi]1GridRight,\[Phi]2[r]->\[Phi]2GridRight,\[Phi]2'[r]->d\[Phi]2GridRight,\[Phi]2''[r]->dd\[Phi]2GridRight,r->rgridR}],{1,3,2,4}],{{1},{2},{3,4}}]}
]


(* ::Input::Initialization:: *)
hbar[l_,m_,r0_,rgridL_,rgridR_]/;EvenQ[l+m]:=Module[{M=1,\[Lambda]=1/2 (l-1)(l+2),\[Omega],\[Omega]p,\[CapitalOmega],\[CapitalOmega]p,
\[Psi]1,\[Psi]1inhom,\[Psi]1Right,\[Psi]1Left,\[Psi]1GridRight,\[Psi]1GridLeft,d\[Psi]1GridRight,d\[Psi]1GridLeft,dd\[Psi]1GridRight,dd\[Psi]1GridLeft,
\[Psi]z,\[Psi]Zinhom,\[Psi]ZRight,\[Psi]ZLeft,\[Psi]ZGridRight,\[Psi]ZGridLeft,d\[Psi]ZGridRight,d\[Psi]ZGridLeft,dd\[Psi]ZGridRight,dd\[Psi]ZGridLeft,
\[Psi]0,\[Psi]0inhom,\[Psi]0Right,\[Psi]0Left,\[Psi]0GridRight,\[Psi]0GridLeft,d\[Psi]0GridRight,d\[Psi]0GridLeft,dd\[Psi]0GridRight,dd\[Psi]0GridLeft,
\[Psi]0b,\[Psi]0binhom,\[Psi]0bRight,\[Psi]0bLeft,\[Psi]0bGridRight,\[Psi]0bGridLeft,d\[Psi]0bGridRight,d\[Psi]0bGridLeft,dd\[Psi]0bGridRight,dd\[Psi]0bGridLeft,
\[CapitalChi],\[CapitalChi]inhom,\[CapitalChi]Right,\[CapitalChi]Left,\[CapitalChi]GridRight,\[CapitalChi]GridLeft,d\[CapitalChi]GridRight,d\[CapitalChi]GridLeft,dd\[CapitalChi]GridRight,dd\[CapitalChi]GridLeft,
\[Phi]1,\[Phi]1inhom,\[Phi]1Right,\[Phi]1Left,\[Phi]1GridRight,\[Phi]1GridLeft,d\[Phi]1GridRight,d\[Phi]1GridLeft,dd\[Phi]1GridRight,dd\[Phi]1GridLeft,
\[Phi]z,\[Phi]Zinhom,\[Phi]ZRight,\[Phi]ZLeft,\[Phi]ZGridRight,\[Phi]ZGridLeft,d\[Phi]ZGridRight,d\[Phi]ZGridLeft,dd\[Phi]ZGridRight,dd\[Phi]ZGridLeft,
\[Phi]0,\[Phi]0inhom,\[Phi]0Right,\[Phi]0Left,\[Phi]0GridRight,\[Phi]0GridLeft,d\[Phi]0GridRight,d\[Phi]0GridLeft,dd\[Phi]0GridRight,dd\[Phi]0GridLeft,
\[Phi]0b,\[Phi]0binhom,\[Phi]0bRight,\[Phi]0bLeft,\[Phi]0bGridRight,\[Phi]0bGridLeft,d\[Phi]0bGridRight,d\[Phi]0bGridLeft,dd\[Phi]0bGridRight,dd\[Phi]0bGridLeft,
\[CapitalKappa],\[CapitalKappa]inhom,\[CapitalKappa]Right,\[CapitalKappa]Left,\[CapitalKappa]GridRight,\[CapitalKappa]GridLeft,d\[CapitalKappa]GridRight,d\[CapitalKappa]GridLeft,dd\[CapitalKappa]GridRight,dd\[CapitalKappa]GridLeft,
r,
h0,h1,H0,H1,H2,G,k,
dr0h0,dr0h1,dr0H0,dr0H1,dr0H2,dr0G,dr0k,
hbar1,hbar2,hbar3,hbar4,hbar5,hbar6,hbar7,
dr0hbar1,dr0hbar2,dr0hbar3,dr0hbar4,dr0hbar5,dr0hbar6,dr0hbar7,
fields},
\[CapitalOmega]=Sqrt[M/r0^3];
\[CapitalOmega]p=-3/2 Sqrt[M/r0^5];
\[Omega]=m \[CapitalOmega];
\[Omega]p=m \[CapitalOmega]p;

\[Psi]1inhom=\[Psi][1,l,m,r0];
\[Psi]1Right=Function[{r},Evaluate[\[Psi]1inhom[r][[1,2,1]]]];
\[Psi]1Left=Function[{r},Evaluate[\[Psi]1inhom[r][[1,1,1]]]];
\[Psi]1GridRight=\[Psi]1Right/@rgridR;
\[Psi]1GridLeft=\[Psi]1Left/@rgridL;
d\[Psi]1GridRight=\[Psi]1Right'/@rgridR;
d\[Psi]1GridLeft=\[Psi]1Left'/@rgridL;
dd\[Psi]1GridRight=\[Psi]1Right''/@rgridR;
dd\[Psi]1GridLeft=\[Psi]1Left''/@rgridL;

\[Psi]Zinhom=\[Psi]Z[l,m,r0];
\[Psi]ZRight=Function[{r},Evaluate[\[Psi]Zinhom[r][[1,2,1]]]];
\[Psi]ZLeft=Function[{r},Evaluate[\[Psi]Zinhom[r][[1,1,1]]]];
\[Psi]ZGridRight=\[Psi]ZRight/@rgridR;
\[Psi]ZGridLeft=\[Psi]ZLeft/@rgridL;
d\[Psi]ZGridRight=\[Psi]ZRight'/@rgridR;
d\[Psi]ZGridLeft=\[Psi]ZLeft'/@rgridL;
dd\[Psi]ZGridRight=\[Psi]ZRight''/@rgridR;
dd\[Psi]ZGridLeft=\[Psi]ZLeft''/@rgridL;

\[Psi]0inhom=\[Psi][0,l,m,r0];
\[Psi]0Right=Function[{r},Evaluate[\[Psi]0inhom[r][[1,2,1]]]];
\[Psi]0Left=Function[{r},Evaluate[\[Psi]0inhom[r][[1,1,1]]]];
\[Psi]0GridRight=\[Psi]0Right/@rgridR;
\[Psi]0GridLeft=\[Psi]0Left/@rgridL;
d\[Psi]0GridRight=\[Psi]0Right'/@rgridR;
d\[Psi]0GridLeft=\[Psi]0Left'/@rgridL;
dd\[Psi]0GridRight=\[Psi]0Right''/@rgridR;
dd\[Psi]0GridLeft=\[Psi]0Left''/@rgridL;

\[Psi]0binhom=\[Psi]b[0,l,m,r0];
\[Psi]0bRight=Function[{r},Evaluate[\[Psi]0binhom[r][[1,2,1]]]];
\[Psi]0bLeft=Function[{r},Evaluate[\[Psi]0binhom[r][[1,1,1]]]];
\[Psi]0bGridRight=\[Psi]0bRight/@rgridR;
\[Psi]0bGridLeft=\[Psi]0bLeft/@rgridL;
d\[Psi]0bGridRight=\[Psi]0bRight'/@rgridR;
d\[Psi]0bGridLeft=\[Psi]0bLeft'/@rgridL;
dd\[Psi]0bGridRight=\[Psi]0bRight''/@rgridR;
dd\[Psi]0bGridLeft=\[Psi]0bLeft''/@rgridL;

\[CapitalChi]inhom=\[Chi][l,m,r0];
\[CapitalChi]Right=Function[{r},Evaluate[\[CapitalChi]inhom[r][[1,2,1]]]];
\[CapitalChi]Left=Function[{r},Evaluate[\[CapitalChi]inhom[r][[1,1,1]]]];
\[CapitalChi]GridRight=\[CapitalChi]Right/@rgridR;
\[CapitalChi]GridLeft=\[CapitalChi]Left/@rgridL;
d\[CapitalChi]GridRight=\[CapitalChi]Right'/@rgridR;
d\[CapitalChi]GridLeft=\[CapitalChi]Left'/@rgridL;
dd\[CapitalChi]GridRight=\[CapitalChi]Right''/@rgridR;
dd\[CapitalChi]GridLeft=\[CapitalChi]Left''/@rgridL;

\[Phi]1inhom=\[Phi][1,l,m,r0];
\[Phi]1Right=Function[{r},Evaluate[\[Phi]1inhom[r][[1,2,1]]]];
\[Phi]1Left=Function[{r},Evaluate[\[Phi]1inhom[r][[1,1,1]]]];
\[Phi]1GridRight=\[Phi]1Right/@rgridR;
\[Phi]1GridLeft=\[Phi]1Left/@rgridL;
d\[Phi]1GridRight=\[Phi]1Right'/@rgridR;
d\[Phi]1GridLeft=\[Phi]1Left'/@rgridL;
dd\[Phi]1GridRight=\[Phi]1Right''/@rgridR;
dd\[Phi]1GridLeft=\[Phi]1Left''/@rgridL;

\[Phi]Zinhom=\[Phi]Z[l,m,r0];
\[Phi]ZRight=Function[{r},Evaluate[\[Phi]Zinhom[r][[1,2,1]]]];
\[Phi]ZLeft=Function[{r},Evaluate[\[Phi]Zinhom[r][[1,1,1]]]];
\[Phi]ZGridRight=\[Phi]ZRight/@rgridR;
\[Phi]ZGridLeft=\[Phi]ZLeft/@rgridL;
d\[Phi]ZGridRight=\[Phi]ZRight'/@rgridR;
d\[Phi]ZGridLeft=\[Phi]ZLeft'/@rgridL;
dd\[Phi]ZGridRight=\[Phi]ZRight''/@rgridR;
dd\[Phi]ZGridLeft=\[Phi]ZLeft''/@rgridL;

\[Phi]0inhom=\[Phi][0,l,m,r0];
\[Phi]0Right=Function[{r},Evaluate[\[Phi]0inhom[r][[1,2,1]]]];
\[Phi]0Left=Function[{r},Evaluate[\[Phi]0inhom[r][[1,1,1]]]];
\[Phi]0GridRight=\[Phi]0Right/@rgridR;
\[Phi]0GridLeft=\[Phi]0Left/@rgridL;
d\[Phi]0GridRight=\[Phi]0Right'/@rgridR;
d\[Phi]0GridLeft=\[Phi]0Left'/@rgridL;
dd\[Phi]0GridRight=\[Phi]0Right''/@rgridR;
dd\[Phi]0GridLeft=\[Phi]0Left''/@rgridL;

\[Phi]0binhom=\[Phi]b[0,l,m,r0];
\[Phi]0bRight=Function[{r},Evaluate[\[Phi]0binhom[r][[1,2,1]]]];
\[Phi]0bLeft=Function[{r},Evaluate[\[Phi]0binhom[r][[1,1,1]]]];
\[Phi]0bGridRight=\[Phi]0bRight/@rgridR;
\[Phi]0bGridLeft=\[Phi]0bLeft/@rgridL;
d\[Phi]0bGridRight=\[Phi]0bRight'/@rgridR;
d\[Phi]0bGridLeft=\[Phi]0bLeft'/@rgridL;
dd\[Phi]0bGridRight=\[Phi]0bRight''/@rgridR;
dd\[Phi]0bGridLeft=\[Phi]0bLeft''/@rgridL;

\[CapitalKappa]inhom=\[Kappa][l,m,r0];
\[CapitalKappa]Right=Function[{r},Evaluate[\[CapitalKappa]inhom[r][[1,1,2,1]]+\[CapitalKappa]inhom[r][[2,1,2,1]]]];
\[CapitalKappa]Left=Function[{r},Evaluate[\[CapitalKappa]inhom[r][[1,1,1,1]]+\[CapitalKappa]inhom[r][[2,1,1,1]]]];
\[CapitalKappa]GridRight=\[CapitalKappa]Right/@rgridR;
\[CapitalKappa]GridLeft=\[CapitalKappa]Left/@rgridL;
d\[CapitalKappa]GridRight=\[CapitalKappa]Right'/@rgridR;
d\[CapitalKappa]GridLeft=\[CapitalKappa]Left'/@rgridL;
dd\[CapitalKappa]GridRight=\[CapitalKappa]Right''/@rgridR;
dd\[CapitalKappa]GridLeft=\[CapitalKappa]Left''/@rgridL;

H0=Function[{r},Evaluate[-((\[Lambda] (1+\[Lambda]) M (-3 M+(3+\[Lambda]) r) \[Psi]z'[r])/(3 (I \[Omega])^2 r^3 (3 M+\[Lambda] r)))+((-M+r) \[Psi]0[r])/((2 M-r) r)+(2 (-2 M^2+M r+(I \[Omega])^2 r^4) (\[Psi]0b[r]+\[CapitalChi][r]))/((2 M-r) r^4)+(4 I \[Omega] (1+\[Lambda]) \[Psi]1[r])/(2 M-r)-(\[Lambda] (1+\[Lambda]) (18 M^4+3 (-3+4 \[Lambda]) M^3 r+(I \[Omega])^2 \[Lambda]^2 r^6-3 \[Lambda] M r^3 (1+\[Lambda]-2 (I \[Omega])^2 r^2)+M^2 (6 \[Lambda]^2 r^2+9 (I \[Omega])^2 r^4)) \[Psi]z[r])/(3 (I \[Omega])^2 (2 M-r) r^4 (3 M+\[Lambda] r)^2)+\[Psi]0'[r]+(2 M (\[Psi]0b'[r]+\[CapitalChi]'[r]))/r^3+(4 (1+\[Lambda]) M \[Psi]1'[r])/(I \[Omega] r^3)]];
H1=Function[{r},Evaluate[-((\[Lambda] (1+\[Lambda])\[Psi]z'[r] )/(3 I \[Omega] r))-((6 M+4 \[Lambda] M-3 r-2 \[Lambda] r-2 (I \[Omega])^2 r^3) \[Psi]0[r])/(4 I \[Omega] M r^2-2 I \[Omega] r^3)+((2+2 \[Lambda]) \[Psi]1[r])/(2 M r-r^2)+(2 I \[Omega] (-M+r) (\[Psi]0b[r]+\[CapitalChi][r]))/((2 M-r) r^2)-(\[Lambda] (1+\[Lambda]) (3 M^2+3 \[Lambda] M r-\[Lambda] r^2) \[Psi]z[r])/(3 I \[Omega] (2 M-r) r^2 (3 M+\[Lambda] r))+(\[Psi]0'[r])/(2 I \[Omega] r)+(2 I \[Omega] (\[Psi]0b'[r]+\[CapitalChi]'[r]))/r+(4 (1+\[Lambda]) \[Psi]1'[r])/r]];
H2=Function[{r},Evaluate[(\[Lambda] (1+\[Lambda]) (-9 M^2+(3-5 \[Lambda]) M r+2 \[Lambda] r^2)\[Psi]z'[r] )/(3 (I \[Omega])^2 r^3 (3 M+\[Lambda] r))+((-3 M+2 r)\[Psi]0[r])/((2 M-r) r)+(2 (6 M^2-(11+4 \[Lambda]) M r+r^2 (4+2 \[Lambda]+(I \[Omega])^2 r^2)) (\[Psi]0b[r]+\[CapitalChi][r]))/((2 M-r) r^4)+(4 (1+\[Lambda]) (-4 (1+\[Lambda]) M+r (2+2 \[Lambda]+(I \[Omega])^2 r^2)) \[Psi]1[r])/(I \[Omega] (2 M-r) r^3)-(\[Lambda] (\[Lambda]+1) (-54 M^4+3 (9-16 \[Lambda]) M^3 r+\[Lambda]^2 r^4 (2+2 \[Lambda]+(I \[Omega])^2 r^2)+9 M^2 r^2 (2 \[Lambda]-2 \[Lambda]^2+(I \[Omega])^2 r^2)+\[Lambda] M r^3 (3+5 \[Lambda]-4 \[Lambda]^2+6 (I \[Omega])^2 r^2)) \[Psi]z[r])/(3 (I \[Omega])^2 (2 M-r) r^4 (3 M+\[Lambda] r)^2)+\[Psi]0'[r]+((-6 M+4 r) (\[Psi]0b'[r]+\[CapitalChi]'[r]))/r^3-(4 (1+\[Lambda]) (M-r) \[Psi]1'[r])/(I \[Omega] r^3)]];
h0=Function[{r},Evaluate[(\[Lambda] (2 M-r)\[Psi]z'[r])/(3 I \[Omega] r)+((-2 M+r)\[Psi]0[r])/(2 I \[Omega] r^2)+(2 I \[Omega] (\[Psi]0b[r]+\[CapitalChi][r]))/r+(4 (1+\[Lambda])\[Psi]1[r])/r-(\[Lambda] (6 M^2+3 \[Lambda] M r+\[Lambda] (1+\[Lambda]) r^2) \[Psi]z[r])/(3 I \[Omega] r^2 (3 M+\[Lambda] r))-((-2 M+r)\[Psi]0'[r])/(2 I \[Omega] r)+(1-(2 M)/r) \[Psi]1'[r]]];
h1=Function[{r},Evaluate[(\[Lambda] ((3+\[Lambda]) M+\[Lambda] (2+\[Lambda]) r) \[Psi]z'[r])/(3 (I \[Omega])^2 r (3 M+\[Lambda] r))-(r \[Psi]0[r])/(4 M-2 r)+(4 (\[Psi]0b[r]+\[CapitalChi][r]))/r^2+((8 M+8 \[Lambda] M-4 r-4 \[Lambda] r+(I \[Omega])^2 r^3) \[Psi]1[r])/(2 I \[Omega] M r^2-I \[Omega] r^3)-(\[Lambda] (9 (I \[Omega])^2 M^2 r^3+2 \[Lambda]^3 r^2 (-2 M+r)+\[Lambda]^2 r (-12 M^2+2 M r+2 r^2+(I \[Omega])^2 r^4)+3 \[Lambda] M (-4 M^2+r^2+2 (I \[Omega])^2 r^4)) \[Psi]z[r])/(3 (I \[Omega])^2 (2 M-r) r^2 (3 M+\[Lambda] r)^2)-(2 (\[Psi]0b'[r]+\[CapitalChi]'[r]))/r-(2 (2 M+r+2 \[Lambda] r) \[Psi]1'[r])/(I \[Omega] r^2)]];
G=Function[{r},Evaluate[-((\[Lambda] (3+2 \[Lambda]) (2 M-r) \[Psi]z'[r])/(6 (I \[Omega])^2 r^2 (3 M+\[Lambda] r)))-(\[Psi]0b[r]+\[CapitalChi][r])/r^3-(2 (1+\[Lambda]) \[Psi]1[r])/(I \[Omega] r^3)+((4 \[Lambda]^3 r^2+\[Lambda]^4 r^2+27 (I \[Omega])^2 M^2 r^2+9 \[Lambda] M (M+2 (I \[Omega])^2 r^3)+3 \[Lambda]^2 (M^2+M r+r^2+(I \[Omega])^2 r^4)) \[Psi]z[r])/(6 (I \[Omega])^2 r^3 (3 M+\[Lambda] r)^2)+((2 M-r) \[Psi]1'[r])/(I \[Omega] r^3)]];
k=Function[{r},Evaluate[(\[Lambda] (1+\[Lambda]) (2 M-r) \[Psi]z'[r])/(3 (I \[Omega])^2 r^3)+\[Psi]0[r]/r+((-4 M+2 (2+\[Lambda]) r) (\[Psi]0b[r]+\[CapitalChi][r]))/r^4+(4 (1+\[Lambda])^2 \[Psi]1[r])/(I \[Omega] r^3)-(\[Lambda] (1+\[Lambda]) (6 M^2+3 \[Lambda] M r+\[Lambda] (1+\[Lambda]) r^2) \[Psi]z[r])/(3 (I \[Omega])^2 r^4 (3 M+\[Lambda] r))+((4 M-2 r) (\[Psi]0b'[r]+\[CapitalChi]'[r]))/r^3+(2 (1+\[Lambda]) (2 M-r) \[Psi]1'[r])/(I \[Omega] r^3)]];

dr0H0=Function[{r},Evaluate[-((\[Lambda] (1+\[Lambda]) M (-3 M+(3+\[Lambda]) r) \[Phi]z'[r])/(3 (I \[Omega])^2 r^3 (3 M+\[Lambda] r)))+((-M+r) \[Phi]0[r])/((2 M-r) r)+(2 (-2 M^2+M r+(I \[Omega])^2 r^4) (\[Phi]0b[r]+\[CapitalKappa][r]))/((2 M-r) r^4)+(4 I \[Omega] (1+\[Lambda]) \[Phi]1[r])/(2 M-r)-(\[Lambda] (1+\[Lambda]) (18 M^4+3 (-3+4 \[Lambda]) M^3 r+(I \[Omega])^2 \[Lambda]^2 r^6-3 \[Lambda] M r^3 (1+\[Lambda]-2 (I \[Omega])^2 r^2)+M^2 (6 \[Lambda]^2 r^2+9 (I \[Omega])^2 r^4)) \[Phi]z[r])/(3 (I \[Omega])^2 (2 M-r) r^4 (3 M+\[Lambda] r)^2)+\[Phi]0'[r]+(2 M (\[Phi]0b'[r]+\[CapitalKappa]'[r]))/r^3+(4 (1+\[Lambda]) M \[Phi]1'[r])/(I \[Omega] r^3)+\[Omega]p(-((4 \[Omega] (\[CapitalChi][r]+\[Psi]0b[r]))/(2 M-r))+(4 I (1+\[Lambda]) \[Psi]1[r])/(2 M-r)+(\[Lambda] (1+\[Lambda]) (-18 M^2 r^4 \[Omega]-12 M r^5 \[Lambda] \[Omega]-2 r^6 \[Lambda]^2 \[Omega]) \[Psi]z[r])/(3 (2 M-r) r^4 (3 M+r \[Lambda])^2 \[Omega]^2)-(2 \[Lambda] (1+\[Lambda]) (18 M^4+3 M^3 r (-3+4 \[Lambda])-r^6 \[Lambda]^2 \[Omega]^2-3 M r^3 \[Lambda] (1+\[Lambda]+2 r^2 \[Omega]^2)+M^2 (6 r^2 \[Lambda]^2-9 r^4 \[Omega]^2)) \[Psi]z[r])/(3 (2 M-r) r^4 (3 M+r \[Lambda])^2 \[Omega]^3)+(4 I M (1+\[Lambda]) Derivative[1][\[Psi]1][r])/(r^3 \[Omega]^2)-(2 M \[Lambda] (1+\[Lambda]) (-3 M+r (3+\[Lambda])) Derivative[1][\[Psi]z][r])/(3 r^3 (3 M+r \[Lambda]) \[Omega]^3))]];
dr0H1=Function[{r},Evaluate[-((\[Lambda] (1+\[Lambda])\[Phi]z'[r] )/(3 I \[Omega] r))-((6 M+4 \[Lambda] M-3 r-2 \[Lambda] r-2 (I \[Omega])^2 r^3) \[Phi]0[r])/(4 I \[Omega] M r^2-2 I \[Omega] r^3)+((2+2 \[Lambda]) \[Phi]1[r])/(2 M r-r^2)+(2 I \[Omega] (-M+r) (\[Phi]0b[r]+\[CapitalKappa][r]))/((2 M-r) r^2)-(\[Lambda] (1+\[Lambda]) (3 M^2+3 \[Lambda] M r-\[Lambda] r^2) \[Phi]z[r])/(3 I \[Omega] (2 M-r) r^2 (3 M+\[Lambda] r))+(\[Phi]0'[r])/(2 I \[Omega] r)+(2 I \[Omega] (\[Phi]0b'[r]+\[CapitalKappa]'[r]))/r+(4 (1+\[Lambda]) \[Phi]1'[r])/r+\[Omega]p(-((4 r^3 \[Omega] \[Psi]0[r])/(4 I M r^2 \[Omega]-2 I r^3 \[Omega]))+((4 I M r^2-2 I r^3) (6 M-3 r+4 M \[Lambda]-2 r \[Lambda]+2 r^3 \[Omega]^2) \[Psi]0[r])/(4 I M r^2 \[Omega]-2 I r^3 \[Omega])^2+(2 I (-M+r) (\[CapitalChi][r]+\[Psi]0b[r]))/((2 M-r) r^2)-(I \[Lambda] (1+\[Lambda]) (3 M^2+3 M r \[Lambda]-r^2 \[Lambda]) \[Psi]z[r])/(3 (2 M-r) r^2 (3 M+r \[Lambda]) \[Omega]^2)+(I Derivative[1][\[Psi]0][r])/(2 r \[Omega]^2)+(2 I (Derivative[1][\[CapitalChi]][r]+Derivative[1][\[Psi]0b][r]))/r-(I \[Lambda] (1+\[Lambda]) Derivative[1][\[Psi]z][r])/(3 r \[Omega]^2))]];
dr0H2=Function[{r},Evaluate[(\[Lambda] (1+\[Lambda]) (-9 M^2+(3-5 \[Lambda]) M r+2 \[Lambda] r^2)\[Phi]z'[r] )/(3 (I \[Omega])^2 r^3 (3 M+\[Lambda] r))+((-3 M+2 r)\[Phi]0[r])/((2 M-r) r)+(2 (6 M^2-(11+4 \[Lambda]) M r+r^2 (4+2 \[Lambda]+(I \[Omega])^2 r^2)) (\[Phi]0b[r]+\[CapitalKappa][r]))/((2 M-r) r^4)+(4 (1+\[Lambda]) (-4 (1+\[Lambda]) M+r (2+2 \[Lambda]+(I \[Omega])^2 r^2)) \[Phi]1[r])/(I \[Omega] (2 M-r) r^3)-(\[Lambda] (\[Lambda]+1) (-54 M^4+3 (9-16 \[Lambda]) M^3 r+\[Lambda]^2 r^4 (2+2 \[Lambda]+(I \[Omega])^2 r^2)+9 M^2 r^2 (2 \[Lambda]-2 \[Lambda]^2+(I \[Omega])^2 r^2)+\[Lambda] M r^3 (3+5 \[Lambda]-4 \[Lambda]^2+6 (I \[Omega])^2 r^2)) \[Phi]z[r])/(3 (I \[Omega])^2 (2 M-r) r^4 (3 M+\[Lambda] r)^2)+\[Phi]0'[r]+((-6 M+4 r) (\[Phi]0b'[r]+\[CapitalKappa]'[r]))/r^3-(4 (1+\[Lambda]) (M-r) \[Phi]1'[r])/(I \[Omega] r^3)+\[Omega]p(-((4 \[Omega] (\[CapitalChi][r]+\[Psi]0b[r]))/(2 M-r))+(8 I (1+\[Lambda]) \[Psi]1[r])/(2 M-r)+(4 I (1+\[Lambda]) (-4 M (1+\[Lambda])+r (2+2 \[Lambda]-r^2 \[Omega]^2)) \[Psi]1[r])/((2 M-r) r^3 \[Omega]^2)+(\[Lambda] (1+\[Lambda]) (-18 M^2 r^4 \[Omega]-12 M r^5 \[Lambda] \[Omega]-2 r^6 \[Lambda]^2 \[Omega]) \[Psi]z[r])/(3 (2 M-r) r^4 (3 M+r \[Lambda])^2 \[Omega]^2)-(2 \[Lambda] (1+\[Lambda]) (-54 M^4+3 M^3 r (9-16 \[Lambda])+M r^3 \[Lambda] (3+5 \[Lambda]-4 \[Lambda]^2-6 r^2 \[Omega]^2)+r^4 \[Lambda]^2 (2+2 \[Lambda]-r^2 \[Omega]^2)+9 M^2 r^2 (2 \[Lambda]-2 \[Lambda]^2-r^2 \[Omega]^2)) \[Psi]z[r])/(3 (2 M-r) r^4 (3 M+r \[Lambda])^2 \[Omega]^3)-(4 I (M-r) (1+\[Lambda]) Derivative[1][\[Psi]1][r])/(r^3 \[Omega]^2)+(2 \[Lambda] (1+\[Lambda]) (-9 M^2+M r (3-5 \[Lambda])+2 r^2 \[Lambda]) Derivative[1][\[Psi]z][r])/(3 r^3 (3 M+r \[Lambda]) \[Omega]^3))]];
dr0h0=Function[{r},Evaluate[(\[Lambda] (2 M-r)\[Phi]z'[r])/(3 I \[Omega] r)+((-2 M+r)\[Phi]0[r])/(2 I \[Omega] r^2)+(2 I \[Omega] (\[Phi]0b[r]+\[CapitalKappa][r]))/r+(4 (1+\[Lambda])\[Phi]1[r])/r-(\[Lambda] (6 M^2+3 \[Lambda] M r+\[Lambda] (1+\[Lambda]) r^2) \[Phi]z[r])/(3 I \[Omega] r^2 (3 M+\[Lambda] r))-((-2 M+r)\[Phi]0'[r])/(2 I \[Omega] r)+(1-(2 M)/r) \[Phi]1'[r]+\[Omega]p((I (-2 M+r) \[Psi]0[r])/(2 r^2 \[Omega]^2)+(2 I (\[CapitalChi][r]+\[Psi]0b[r]))/r-(I \[Lambda] (6 M^2+3 M r \[Lambda]+r^2 \[Lambda] (1+\[Lambda])) \[Psi]z[r])/(3 r^2 (3 M+r \[Lambda]) \[Omega]^2)-(I (-2 M+r) Derivative[1][\[Psi]0][r])/(2 r \[Omega]^2)+(I (2 M-r) \[Lambda] Derivative[1][\[Psi]z][r])/(3 r \[Omega]^2))]];
dr0h1=Function[{r},Evaluate[(\[Lambda] ((3+\[Lambda]) M+\[Lambda] (2+\[Lambda]) r) \[Phi]z'[r])/(3 (I \[Omega])^2 r (3 M+\[Lambda] r))-(r \[Phi]0[r])/(4 M-2 r)+(4 (\[Phi]0b[r]+\[CapitalKappa][r]))/r^2+((8 M+8 \[Lambda] M-4 r-4 \[Lambda] r+(I \[Omega])^2 r^3) \[Phi]1[r])/(2 I \[Omega] M r^2-I \[Omega] r^3)-(\[Lambda] (9 (I \[Omega])^2 M^2 r^3+2 \[Lambda]^3 r^2 (-2 M+r)+\[Lambda]^2 r (-12 M^2+2 M r+2 r^2+(I \[Omega])^2 r^4)+3 \[Lambda] M (-4 M^2+r^2+2 (I \[Omega])^2 r^4)) \[Phi]z[r])/(3 (I \[Omega])^2 (2 M-r) r^2 (3 M+\[Lambda] r)^2)-(2 (\[Phi]0b'[r]+\[CapitalKappa]'[r]))/r-(2 (2 M+r+2 \[Lambda] r) \[Phi]1'[r])/(I \[Omega] r^2)+\[Omega]p(-((2 r^3 \[Omega] \[Psi]1[r])/(2 I M r^2 \[Omega]-I r^3 \[Omega]))-((2 I M r^2-I r^3) (8 M-4 r+8 M \[Lambda]-4 r \[Lambda]-r^3 \[Omega]^2) \[Psi]1[r])/(2 I M r^2 \[Omega]-I r^3 \[Omega])^2+(\[Lambda] (-18 M^2 r^3 \[Omega]-12 M r^4 \[Lambda] \[Omega]-2 r^5 \[Lambda]^2 \[Omega]) \[Psi]z[r])/(3 (2 M-r) r^2 (3 M+r \[Lambda])^2 \[Omega]^2)-(2 \[Lambda] (2 r^2 (-2 M+r) \[Lambda]^3-9 M^2 r^3 \[Omega]^2+3 M \[Lambda] (-4 M^2+r^2-2 r^4 \[Omega]^2)+r \[Lambda]^2 (-12 M^2+2 M r+2 r^2-r^4 \[Omega]^2)) \[Psi]z[r])/(3 (2 M-r) r^2 (3 M+r \[Lambda])^2 \[Omega]^3)-(2 I (2 M+r+2 r \[Lambda]) Derivative[1][\[Psi]1][r])/(r^2 \[Omega]^2)+(2 \[Lambda] (r \[Lambda] (2+\[Lambda])+M (3+\[Lambda])) Derivative[1][\[Psi]z][r])/(3 r (3 M+r \[Lambda]) \[Omega]^3))]];
dr0G=Function[{r},Evaluate[-((\[Lambda] (3+2 \[Lambda]) (2 M-r) \[Phi]z'[r])/(6 (I \[Omega])^2 r^2 (3 M+\[Lambda] r)))-(\[Phi]0b[r]+\[CapitalKappa][r])/r^3-(2 (1+\[Lambda]) \[Phi]1[r])/(I \[Omega] r^3)+((4 \[Lambda]^3 r^2+\[Lambda]^4 r^2+27 (I \[Omega])^2 M^2 r^2+9 \[Lambda] M (M+2 (I \[Omega])^2 r^3)+3 \[Lambda]^2 (M^2+M r+r^2+(I \[Omega])^2 r^4)) \[Phi]z[r])/(6 (I \[Omega])^2 r^3 (3 M+\[Lambda] r)^2)+((2 M-r) \[Phi]1'[r])/(I \[Omega] r^3)+\[Omega]p(-((2 I (1+\[Lambda]) \[Psi]1[r])/(r^3 \[Omega]^2))-((-54 M^2 r^2 \[Omega]-36 M r^3 \[Lambda] \[Omega]-6 r^4 \[Lambda]^2 \[Omega]) \[Psi]z[r])/(6 r^3 (3 M+r \[Lambda])^2 \[Omega]^2)+((4 r^2 \[Lambda]^3+r^2 \[Lambda]^4-27 M^2 r^2 \[Omega]^2+9 M \[Lambda] (M-2 r^3 \[Omega]^2)+3 \[Lambda]^2 (M^2+M r+r^2-r^4 \[Omega]^2)) \[Psi]z[r])/(3 r^3 (3 M+r \[Lambda])^2 \[Omega]^3)+(I (2 M-r) Derivative[1][\[Psi]1][r])/(r^3 \[Omega]^2)-((2 M-r) \[Lambda] (3+2 \[Lambda]) Derivative[1][\[Psi]z][r])/(3 r^2 (3 M+r \[Lambda]) \[Omega]^3))]];
dr0k=Function[{r},Evaluate[(\[Lambda] (1+\[Lambda]) (2 M-r) \[Phi]z'[r])/(3 (I \[Omega])^2 r^3)+\[Phi]0[r]/r+((-4 M+2 (2+\[Lambda]) r) (\[Phi]0b[r]+\[CapitalKappa][r]))/r^4+(4 (1+\[Lambda])^2 \[Phi]1[r])/(I \[Omega] r^3)-(\[Lambda] (1+\[Lambda]) (6 M^2+3 \[Lambda] M r+\[Lambda] (1+\[Lambda]) r^2) \[Phi]z[r])/(3 (I \[Omega])^2 r^4 (3 M+\[Lambda] r))+((4 M-2 r) (\[Phi]0b'[r]+\[CapitalKappa]'[r]))/r^3+(2 (1+\[Lambda]) (2 M-r) \[Phi]1'[r])/(I \[Omega] r^3)+\[Omega]p((4 I (1+\[Lambda])^2 \[Psi]1[r])/(r^3 \[Omega]^2)-(2 \[Lambda] (1+\[Lambda]) (6 M^2+3 M r \[Lambda]+r^2 \[Lambda] (1+\[Lambda])) \[Psi]z[r])/(3 r^4 (3 M+r \[Lambda]) \[Omega]^3)+(2 I (2 M-r) (1+\[Lambda]) Derivative[1][\[Psi]1][r])/(r^3 \[Omega]^2)+(2 (2 M-r) \[Lambda] (1+\[Lambda]) Derivative[1][\[Psi]z][r])/(3 r^3 \[Omega]^3))]];
hbar1=Function[{r},Evaluate[r (1-2M/r)(H0[r]+H2[r])]];
hbar2=Function[{r},Evaluate[2 r (1-2M/r) H1[r]]];
hbar3=Function[{r},Evaluate[2 r k[r]]];
hbar4=Function[{r},Evaluate[2 l(1+l) h0[r]]];
hbar5=Function[{r},Evaluate[(2 (1-2 M/r) l(1+l) h1[r])]];
hbar6=Function[{r},Evaluate[r (H0[r]-H2[r])]];
hbar7=Function[{r},Evaluate[2 r (l-1)l(1+l)(l+2) G[r]]];
dr0hbar1=Function[{r},Evaluate[r (1-2M/r)(dr0H0[r]+dr0H2[r])]];
dr0hbar2=Function[{r},Evaluate[2 r (1-2M/r) dr0H1[r]]];
dr0hbar3=Function[{r},Evaluate[2 r dr0k[r]]];
dr0hbar4=Function[{r},Evaluate[2 l(1+l) dr0h0[r]]];
dr0hbar5=Function[{r},Evaluate[(2 (1-2 M/r) l(1+l) dr0h1[r])]];
dr0hbar6=Function[{r},Evaluate[r (dr0H0[r]-dr0H2[r])]];
dr0hbar7=Function[{r},Evaluate[2 r (l-1)l(1+l)(l+2) dr0G[r]]];
fields=Simplify[
{{hbar1[r],hbar1'[r],hbar3[r],hbar3'[r],hbar5[r],hbar5'[r],hbar6[r],hbar6'[r],hbar7[r],hbar7'[r],hbar2[r],hbar2'[r],hbar4[r],hbar4'[r]},
{dr0hbar1[r],dr0hbar1'[r],dr0hbar3[r],dr0hbar3'[r],dr0hbar5[r],dr0hbar5'[r],dr0hbar6[r],dr0hbar6'[r],dr0hbar7[r],dr0hbar7'[r],dr0hbar2[r],dr0hbar2'[r],dr0hbar4[r],dr0hbar4'[r]}}];
{Flatten[Transpose[ReIm[fields/.{
\[Psi]1[r]->\[Psi]1GridLeft,\[Psi]1'[r]->d\[Psi]1GridLeft,\[Psi]1''[r]->dd\[Psi]1GridLeft,
\[Psi]z[r]->\[Psi]ZGridLeft,\[Psi]z'[r]->d\[Psi]ZGridLeft,\[Psi]z''[r]->dd\[Psi]ZGridLeft,
\[Psi]0[r]->\[Psi]0GridLeft,\[Psi]0'[r]->d\[Psi]0GridLeft,\[Psi]0''[r]->dd\[Psi]0GridLeft,
\[Psi]0b[r]->\[Psi]0bGridLeft,\[Psi]0b'[r]->d\[Psi]0bGridLeft,\[Psi]0b''[r]->dd\[Psi]0bGridLeft,
\[CapitalChi][r]->\[CapitalChi]GridLeft,\[CapitalChi]'[r]->d\[CapitalChi]GridLeft,\[CapitalChi]''[r]->dd\[CapitalChi]GridLeft,
\[Phi]1[r]->\[Phi]1GridLeft,\[Phi]1'[r]->d\[Phi]1GridLeft,\[Phi]1''[r]->dd\[Phi]1GridLeft,
\[Phi]z[r]->\[Phi]ZGridLeft,\[Phi]z'[r]->d\[Phi]ZGridLeft,\[Phi]z''[r]->dd\[Phi]ZGridLeft,
\[Phi]0[r]->\[Phi]0GridLeft,\[Phi]0'[r]->d\[Phi]0GridLeft,\[Phi]0''[r]->dd\[Phi]0GridLeft,
\[Phi]0b[r]->\[Phi]0bGridLeft,\[Phi]0b'[r]->d\[Phi]0bGridLeft,\[Phi]0b''[r]->dd\[Phi]0bGridLeft,
\[CapitalKappa][r]->\[CapitalKappa]GridLeft,\[CapitalKappa]'[r]->d\[CapitalKappa]GridLeft,\[CapitalKappa]''[r]->dd\[CapitalKappa]GridLeft,
r->rgridL}],{1,3,2,4}],{{1},{2},{3,4}}],
Flatten[Transpose[ReIm[fields/.{
\[Psi]1[r]->\[Psi]1GridRight,\[Psi]1'[r]->d\[Psi]1GridRight,\[Psi]1''[r]->dd\[Psi]1GridRight,
\[Psi]z[r]->\[Psi]ZGridRight,\[Psi]z'[r]->d\[Psi]ZGridRight,\[Psi]z''[r]->dd\[Psi]ZGridRight,
\[Psi]0[r]->\[Psi]0GridRight,\[Psi]0'[r]->d\[Psi]0GridRight,\[Psi]0''[r]->dd\[Psi]0GridRight,
\[Psi]0b[r]->\[Psi]0bGridRight,\[Psi]0b'[r]->d\[Psi]0bGridRight,\[Psi]0b''[r]->dd\[Psi]0bGridRight,
\[CapitalChi][r]->\[CapitalChi]GridRight,\[CapitalChi]'[r]->d\[CapitalChi]GridRight,\[CapitalChi]''[r]->dd\[CapitalChi]GridRight,
\[Phi]1[r]->\[Phi]1GridRight,\[Phi]1'[r]->d\[Phi]1GridRight,\[Phi]1''[r]->dd\[Phi]1GridRight,
\[Phi]z[r]->\[Phi]ZGridRight,\[Phi]z'[r]->d\[Phi]ZGridRight,\[Phi]z''[r]->dd\[Phi]ZGridRight,
\[Phi]0[r]->\[Phi]0GridRight,\[Phi]0'[r]->d\[Phi]0GridRight,\[Phi]0''[r]->dd\[Phi]0GridRight,
\[Phi]0b[r]->\[Phi]0bGridRight,\[Phi]0b'[r]->d\[Phi]0bGridRight,\[Phi]0b''[r]->dd\[Phi]0bGridRight,
\[CapitalKappa][r]->\[CapitalKappa]GridRight,\[CapitalKappa]'[r]->d\[CapitalKappa]GridRight,\[CapitalKappa]''[r]->dd\[CapitalKappa]GridRight,
r->rgridR}],{1,3,2,4}],{{1},{2},{3,4}}]}
]


(* ::Input::Initialization:: *)
$r0=SetPrecision[r0,64];


(* ::Input::Initialization:: *)
rgrid=Import["grids/radial_grid_r"<>ToString[NumberForm[$r0,{\[Infinity],1}]]<>".h5",{"Datasets","r"}];


(* ::Input::Initialization:: *)
r0Pos=Import["grids/radial_grid_r"<>ToString[NumberForm[$r0,{\[Infinity],1}]]<>".h5",{"Datasets","ImportantIndexes"}][[2]];


(* ::Input::Initialization:: *)
rgridL=rgrid[[;;r0Pos]];
rgridR=rgrid[[r0Pos;;]];


(* ::Input::Initialization:: *)
If[!DirectoryQ["dr0_h1/r0_"<>ToString[NumberForm[$r0,{4,1}]]],
CreateDirectory["dr0_h1/r0_"<>ToString[NumberForm[$r0,{4,1}]]]];
Timing[Do[If[!FileExistsQ["dr0_h1/r0_"<>ToString[NumberForm[$r0,{4,1}]]<>"/h1-l"<>ToString[l]<>"m"<>ToString[m]<>".h5"],
Module[{hbargrid},
Print[{$r0,l,m}];
hbargrid=hbar[l,m,$r0,rgridL,rgridR];
Export["dr0_h1/r0_"<>ToString[NumberForm[$r0,{4,1}]]<>"/h1-l"<>ToString[l]<>"m"<>ToString[m]<>".h5",{"grid"->rgrid,"inhom_left"->hbargrid[[1,2]],"inhom_right"->hbargrid[[2,2]]},"Datasets"]]],{l,2,10},{m,1,l}];]
