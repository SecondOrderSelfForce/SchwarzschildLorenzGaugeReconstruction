(* ::Package:: *)

(************************************************************************)
(* This file was generated automatically by the Mathematica front end.  *)
(* It contains Initialization cells from a Notebook file, which         *)
(* typically will have the same name as this file except ending in      *)
(* ".nb" instead of ".m".                                               *)
(*                                                                      *)
(* This file is intended to be loaded into the Mathematica kernel using *)
(* the package loading commands Get or Needs.  Doing so is equivalent   *)
(* to using the Evaluate Initialization Cells menu command in the front *)
(* end.                                                                 *)
(*                                                                      *)
(* DO NOT EDIT THIS FILE.  This entire file is regenerated              *)
(* automatically each time the parent Notebook file is saved in the     *)
(* Mathematica front end.  Any changes you make to this file will be    *)
(* overwritten.                                                         *)
(************************************************************************)



(* ::Input::Initialization:: *)
\[ScriptCapitalL][s_,l_,\[Omega]_][\[Psi]_]:=
With[{M=1},Function[{r},(1-2M/r)^2 \[Psi]''[r]+(1-2M/r) (2 M)/r^2 \[Psi]'[r]+(\[Omega]^2-(1-2M/r)/r^2 (l(l+1)+2 M (1- s^2)/r))\[Psi][r]]];


(* ::Input::Initialization:: *)
\[ScriptCapitalL]Z[l_,\[Omega]_][\[Psi]_]:=
With[{M=1,\[Lambda]=1/2(l-1)(l+2)},Function[{r},(1-2M/r)^2 \[Psi]''[r]+(1-2M/r) (2 M)/r^2 \[Psi]'[r]+(\[Omega]^2-((1-2M/r)/(r^2(\[Lambda]+3M/r)^2) (2\[Lambda]^2(\[Lambda]+1+3M/r)+18M^2/r^2 (\[Lambda]+M/r))))\[Psi][r]]];


(* ::Input::Initialization:: *)
\[ScriptCapitalL]2[s_,l_,\[Omega]_][\[Psi]_]:=\[ScriptCapitalL][s,l,\[Omega]][\[ScriptCapitalL][s,l,\[Omega]][\[Psi]]];


(* ::Input::Initialization:: *)
\[ScriptCapitalL]Z2[l_,\[Omega]_][\[Psi]_]:=\[ScriptCapitalL]Z[l,\[Omega]][\[ScriptCapitalL]Z[l,\[Omega]][\[Psi]]];


(* ::Input::Initialization:: *)
\[ScriptCapitalL]finv\[ScriptCapitalL][s_,l_,\[Omega]_][\[Psi]_]:=With[{M=1},\[ScriptCapitalL][s,l,\[Omega]][Function[{r1},(1-2M/r1)^-1 \[ScriptCapitalL][s,l,\[Omega]][\[Psi]][r1]]]];


(* ::Input::Initialization:: *)
\[ScriptCapitalL]\[ScriptCapitalL]finv\[ScriptCapitalL][s_,l_,\[Omega]_][\[Psi]_]:=With[{M=1},\[ScriptCapitalL][s,l,\[Omega]][\[ScriptCapitalL][s,l,\[Omega]][Function[{r1},(1-2M/r1)^-1 \[ScriptCapitalL][s,l,\[Omega]][\[Psi]][r1]]]]];


(* ::Input::Initialization:: *)
\[ScriptCapitalL]finv\[ScriptCapitalL]\[ScriptCapitalL][s_,l_,\[Omega]_][\[Psi]_]:=With[{M=1},\[ScriptCapitalL][s,l,\[Omega]][Function[{r1},(1-2M/r1)^-1 \[ScriptCapitalL][s,l,\[Omega]][\[ScriptCapitalL][s,l,\[Omega]][\[Psi]]][r1]]]];


(* ::Input::Initialization:: *)
OuterBCRW2[s_,l_,\[Omega]_,nmax_,r_]:=Module[{M=1,a,n,rs,rsp,rsp2},
a[n_]:=a[n]=(I (2 M \[Omega](1-2 n+n^2-s^2) a[-2+n]+(l+l^2+n-n^2) a[-1+n]))/(2 n );

Do[a[i]=0,{i,-3,-1}];
a[0]=1;

Do[a[i];,{i,1,nmax}];
rs=r+2M Log[r/(2M)-1];
rsp=1/(1-2M/r);
rsp2=-((2 M)/(-2 M+r)^2);

E^(I rs \[Omega]) Sum[
{(r \[Omega])^-i a[i],
-(((r \[Omega])^-i (i-I r rsp \[Omega]) a[i])/r),
((r \[Omega])^-i (i+i^2-2 I i r rsp \[Omega]+I r^2 rsp2 \[Omega]-r^2 rsp^2 \[Omega]^2) a[i])/r^2},
{i,0,nmax}]
];


(* ::Input::Initialization:: *)
InnerBCRW2[s_,l_,\[Omega]_,nmax_,r_]:=Module[{M=1,a,n,rs,rsp,rsp2,rsp3},
a[n_]:=a[n]=((-1+2 n-n^2+s^2) a[-2+n]+(1+l+l^2-2 n+2 n^2-s^2) a[-1+n])/(n (n-4 I M \[Omega]));

Do[a[i]=0,{i,-3,-1}];
a[0]=1;

Do[a[i];,{i,1,nmax}];

rs=r+2M Log[r/(2M)-1];
rsp=1/(1-2M/r);
rsp2=-((2 M)/(-2 M+r)^2);
rsp3=-((4 M)/(2 M-r)^3);

E^(-I rs \[Omega]) Sum[
{rsp^-i a[i],
rsp^(-1-i) (-i rsp2-I rsp^2 \[Omega]) a[i],
-rsp^(-2-i) (-i (1+i) rsp2^2+rsp^2 \[Omega] (I rsp2+rsp^2 \[Omega])+i rsp (rsp3-2 I rsp rsp2 \[Omega])) a[i]},{i,-1,nmax}]
];


(* ::Input::Initialization:: *)
OuterBCRW2From4[s_,l_,\[Omega]_,nmax_,r_]:=OuterBCRW4[s,l,\[Omega],nmax,r,{1,0}];


(* ::Input::Initialization:: *)
OuterBCRW4[s_,l_,\[Omega]_,nmax_,r_]:=OuterBCRW4[s,l,\[Omega],nmax,r,{0,1}];


(* ::Input::Initialization:: *)
OuterBCRW4[s_,l_,\[Omega]_,nmax_,r_,basis_]:=
Module[{M=1,a,b,n,rs,rsp,rsp2,rsp3,rsp4},
a[n_]:=a[n]=(1/(4 (-1+n) n \[Omega]^2))(-8 (25-12 n^3+n^4-26 s^2+s^4-2 n^2 (-23+s^2)+12 n (-5+s^2)) a[-5+n]-4 (-36+30 n^3-3 n^4+37 s^2-s^4+l (17-10 n+2 n^2-2 s^2)+l^2 (17-10 n+2 n^2-2 s^2)+4 n^2 (-24+s^2)-5 n (-21+4 s^2)) a[-4+n]-24 a[-3+n]+44 l a[-3+n]+42 l^2 a[-3+n]-4 l^3 a[-3+n]-2 l^4 a[-3+n]+104 n a[-3+n]-32 l n a[-3+n]-32 l^2 n a[-3+n]-122 n^2 a[-3+n]+8 l n^2 a[-3+n]+8 l^2 n^2 a[-3+n]+48 n^3 a[-3+n]-6 n^4 a[-3+n]+24 s^2 a[-3+n]-4 l s^2 a[-3+n]-4 l^2 s^2 a[-3+n]-16 n s^2 a[-3+n]+4 n^2 s^2 a[-3+n]+32 I \[Omega] a[-3+n]-144 I n \[Omega] a[-3+n]+96 I n^2 \[Omega] a[-3+n]-16 I n^3 \[Omega] a[-3+n]-32 I s^2 \[Omega] a[-3+n]+16 I n s^2 \[Omega] a[-3+n]-6 l a[-2+n]-5 l^2 a[-2+n]+2 l^3 a[-2+n]+l^4 a[-2+n]-6 n a[-2+n]+6 l n a[-2+n]+6 l^2 n a[-2+n]+11 n^2 a[-2+n]-2 l n^2 a[-2+n]-2 l^2 n^2 a[-2+n]-6 n^3 a[-2+n]+n^4 a[-2+n]-12 I \[Omega] a[-2+n]+12 I l \[Omega] a[-2+n]+12 I l^2 \[Omega] a[-2+n]+80 I n \[Omega] a[-2+n]-8 I l n \[Omega] a[-2+n]-8 I l^2 n \[Omega] a[-2+n]-72 I n^2 \[Omega] a[-2+n]+16 I n^3 \[Omega] a[-2+n]+12 I s^2 \[Omega] a[-2+n]-8 I n s^2 \[Omega] a[-2+n]-4 I l \[Omega] a[-1+n]-4 I l^2 \[Omega] a[-1+n]-8 I n \[Omega] a[-1+n]+4 I l n \[Omega] a[-1+n]+4 I l^2 n \[Omega] a[-1+n]+12 I n^2 \[Omega] a[-1+n]-4 I n^3 \[Omega] a[-1+n]-16 n \[Omega]^2 a[-1+n]+8 n^2 \[Omega]^2 a[-1+n]+32 (-3+n) (5-6 n+n^2-s^2) b[-5+n]+4 (5-2 n) (21-2 l-2 l^2-30 n+6 n^2-4 s^2) b[-4+n]-4 (26+4 l (-2+n)+4 l^2 (-2+n)-6 n^3-4 s^2+12 n^2 (3-I \[Omega])+n (-61+2 s^2+48 I \[Omega])-36 I \[Omega]+4 I s^2 \[Omega]) b[-3+n]+2 (3-2 n^3+l (-3+2 n+4 I \[Omega])+l^2 (-3+2 n+4 I \[Omega])+3 n^2 (3-8 I \[Omega])+n (-11+72 I \[Omega])-40 I \[Omega]+4 I s^2 \[Omega]) b[-2+n]+4 I (2-l-l^2+3 n^2+n (-6+4 I \[Omega])-4 I \[Omega]) \[Omega] b[-1+n]+4 (-1+2 n) \[Omega]^2 b[n]);

b[n_]:=b[n]=(1/(4 (-1+n) n \[Omega]^2))(-8 (25-12 n^3+n^4-26 s^2+s^4-2 n^2 (-23+s^2)+12 n (-5+s^2)) b[-5+n]+4 (36-30 n^3+3 n^4-37 s^2+s^4-4 n^2 (-24+s^2)+l (-17+10 n-2 n^2+2 s^2)+l^2 (-17+10 n-2 n^2+2 s^2)+5 n (-21+4 s^2)) b[-4+n]+2 (-2 l^3-l^4-3 n^4+l^2 (21-16 n+4 n^2-2 s^2)+2 l (11-8 n+2 n^2-s^2)+8 n^3 (3-I \[Omega])+4 (-1+s^2) (3-4 I \[Omega])+n^2 (-61+2 s^2+48 I \[Omega])+n (52-72 I \[Omega]+8 I s^2 (I+\[Omega]))) b[-3+n]+(2 l^3+l^4+n^4-2 l (3+n^2+n (-3+4 I \[Omega])-6 I \[Omega])+l^2 (-5-2 n^2+n (6-8 I \[Omega])+12 I \[Omega])+n^3 (-6+16 I \[Omega])+n^2 (11-72 I \[Omega])+12 I (-1+s^2) \[Omega]+n (-6-8 I (-10+s^2) \[Omega])) b[-2+n]+4 I (l (-1+n)+l^2 (-1+n)-(-2+n) n (-1+n+2 I \[Omega])) \[Omega] b[-1+n]);

Do[a[i]=0;b[i]=0;,{i,-7,-1}];

{a[1],b[1]}=basis;
b[0]=0;
a[0]=b[1]/2;

Do[b[i];a[i];,{i,2,nmax}];

rs=r+2M Log[r/(2M)-1];
rsp=1/(1-2M/r);
rsp2=-((2 M)/(-2 M+r)^2);
rsp3=-((4 M)/(2 M-r)^3);
rsp4=-((12 M)/(-2 M+r)^4);

E^(I rs \[Omega]) Sum[
{r^(1-i) (a[i]+b[i] Log[r]),
r^-i ((1-i+I r rsp \[Omega]) a[i]+b[i] (1+Log[r]-i Log[r]+I r rsp \[Omega] Log[r])),
r^(-1-i) (((-1+i) i-2 I (-1+i) r rsp \[Omega]+I r^2 rsp2 \[Omega]-r^2 rsp^2 \[Omega]^2) a[i]+b[i] (1-2 i-i Log[r]+i^2 Log[r]+I r^2 rsp2 \[Omega] Log[r]-r^2 rsp^2 \[Omega]^2 Log[r]-2 I r rsp \[Omega] (-1+(-1+i) Log[r]))),
r^(-2-i) ((i-i^3-3 I (-1+i) r^2 rsp2 \[Omega]+I r^3 rsp3 \[Omega]+3 (-1+i) r^2 rsp^2 \[Omega]^2-I r^3 rsp^3 \[Omega]^3+3 I r rsp \[Omega] ((-1+i) i+I r^2 rsp2 \[Omega])) a[i]+b[i] (-1+3 i^2+i Log[r]-i^3 Log[r]+I r^3 rsp3 \[Omega] Log[r]-I r^3 rsp^3 \[Omega]^3 Log[r]-3 I r^2 rsp2 \[Omega] (-1+(-1+i) Log[r])+3 r^2 rsp^2 \[Omega]^2 (-1+(-1+i) Log[r])+3 I r rsp \[Omega] (1-2 i+(-1+i) i Log[r]+I r^2 rsp2 \[Omega] Log[r]))),
r^(-3-i) ((-2 i-i^2+2 i^3+i^4+6 I (-1+i) i r^2 rsp2 \[Omega]+4 I r^3 rsp3 \[Omega]-4 I i r^3 rsp3 \[Omega]+I r^4 rsp4 \[Omega]-3 r^4 rsp2^2 \[Omega]^2+4 I (-1+i) r^3 rsp^3 \[Omega]^3+r^4 rsp^4 \[Omega]^4-6 r^2 rsp^2 \[Omega]^2 ((-1+i) i+I r^2 rsp2 \[Omega])-4 r rsp \[Omega] (I i (-1+i^2)-3 (-1+i) r^2 rsp2 \[Omega]+r^3 rsp3 \[Omega])) a[i]+b[i] (2+2 i-6 i^2-4 i^3+4 I r^3 rsp3 \[Omega]-2 i Log[r]-i^2 Log[r]+2 i^3 Log[r]+i^4 Log[r]+4 I r^3 rsp3 \[Omega] Log[r]-4 I i r^3 rsp3 \[Omega] Log[r]+I r^4 rsp4 \[Omega] Log[r]-3 r^4 rsp2^2 \[Omega]^2 Log[r]+r^4 rsp^4 \[Omega]^4 Log[r]+4 I r^3 rsp^3 \[Omega]^3 (-1+(-1+i) Log[r])+6 I r^2 rsp2 \[Omega] (1-2 i+(-1+i) i Log[r])+6 r^2 rsp^2 \[Omega]^2 (-1+2 i-(-1+i) i Log[r]-I r^2 rsp2 \[Omega] Log[r])-4 r rsp \[Omega] (r^3 rsp3 \[Omega] Log[r]+3 r^2 rsp2 \[Omega] (1+Log[r]-i Log[r])+I (1-3 i^2+i (-1+i^2) Log[r]))))},
{i,0,nmax}]

];


(* ::Input::Initialization:: *)
InnerBCRW2From4[s_,l_,\[Omega]_,nmax_,r_]:=InnerBCRW4[s,l,\[Omega],nmax,r,{1,0}];


(* ::Input::Initialization:: *)
InnerBCRW4[s_,l_,\[Omega]_,nmax_,r_]:=InnerBCRW4[s,l,\[Omega],nmax,r,{0,1}];


(* ::Input::Initialization:: *)
InnerBCRW4[s_,l_,\[Omega]_,nmax_,r_,basis_]:=Module[{M=1,b,c,a,n,rs,rsp,rsp2,rsp3,rsp4,rsp5},
b[n_]:=b[n]=(1/(n^2 (n-4 I \[Omega])^2))((-8 n^3+n^4+8 n s^2+s^2 (-16+s^2)-2 n^2 (-8+s^2)) b[-5+n]+(32 n^3-5 n^4+43 s^2-26 n s^2-3 s^4+l (-9+6 n-2 n^2+2 s^2)+l^2 (-9+6 n-2 n^2+2 s^2)+n^2 (-52+8 s^2)) b[-4+n]+(2 l^3+l^4+10 n^4-39 s^2+3 s^4+l (17-14 n+6 n^2-4 s^2)+2 l^2 (9-7 n+3 n^2-2 s^2)-12 n^2 (-5+s^2-2 I \[Omega])+2 n s^2 (15+4 I \[Omega])-16 I \[Omega]-8 I s^2 \[Omega]-8 I n^3 (-6 I+\[Omega])) b[-3+n]+(-2 l^3-l^4-10 n^4+13 s^2-s^4-2 l^2 (5+3 n^2-s^2+n (-5-4 I \[Omega])+2 I \[Omega])+8 n^3 (4+3 I \[Omega])+l (-9-6 n^2+2 s^2+2 n (5+4 I \[Omega])-4 I \[Omega])+2 n s^2 (-7-8 I \[Omega])+4 n^2 (-7+2 s^2-12 I \[Omega])+20 I \[Omega]+12 I s^2 \[Omega]) b[-2+n]+(5 n^4+2 n s^2 (1+4 I \[Omega])+l (1+2 n^2+n (-2-8 I \[Omega])+4 I \[Omega])+l^2 (1+2 n^2+n (-2-8 I \[Omega])+4 I \[Omega])+n^3 (-8-24 I \[Omega])+(-I+4 \[Omega]) (-I s^2+4 \[Omega])-2 n^2 (-2+s^2-12 I \[Omega]+8 \[Omega]^2)) b[-1+n]+4 (-2+n) (-4 n+n^2-s^2) c[-5+n]-2 (-48 n^2+10 n^3+l (-3+2 n)+l^2 (-3+2 n)+13 s^2+n (52-8 s^2)) c[-4+n]+2 (20 n^3+l (-7+6 n)+l^2 (-7+6 n)-12 n (-5+s^2-2 I \[Omega])+s^2 (15+4 I \[Omega])-12 I n^2 (-6 I+\[Omega])) c[-3+n]-2 (20 n^3+l (-5+6 n-4 I \[Omega])+l^2 (-5+6 n-4 I \[Omega])+s^2 (7+8 I \[Omega])+n^2 (-48-36 I \[Omega])+n (28-8 s^2+48 I \[Omega])) c[-2+n]+2 (10 n^3+l (-1+2 n-4 I \[Omega])+l^2 (-1+2 n-4 I \[Omega])+s^2 (1+4 I \[Omega])+n^2 (-12-36 I \[Omega])-2 n (-2+s^2-12 I \[Omega]+8 \[Omega]^2)) c[-1+n]-4 n (n-2 I \[Omega]) (n-4 I \[Omega]) c[n]);

c[n_]:=c[n]=(1/(n^2 (n-4 I \[Omega])^2))((-8 n^3+n^4+8 n s^2+s^2 (-16+s^2)-2 n^2 (-8+s^2)) c[-5+n]+(32 n^3-5 n^4+43 s^2-26 n s^2-3 s^4+l (-9+6 n-2 n^2+2 s^2)+l^2 (-9+6 n-2 n^2+2 s^2)+n^2 (-52+8 s^2)) c[-4+n]+(2 l^3+l^4+10 n^4-39 s^2+3 s^4+l (17-14 n+6 n^2-4 s^2)+2 l^2 (9-7 n+3 n^2-2 s^2)-12 n^2 (-5+s^2-2 I \[Omega])+2 n s^2 (15+4 I \[Omega])-16 I \[Omega]-8 I s^2 \[Omega]-8 I n^3 (-6 I+\[Omega])) c[-3+n]+(-2 l^3-l^4-10 n^4+13 s^2-s^4-2 l^2 (5+3 n^2-s^2+n (-5-4 I \[Omega])+2 I \[Omega])+8 n^3 (4+3 I \[Omega])+l (-9-6 n^2+2 s^2+2 n (5+4 I \[Omega])-4 I \[Omega])+2 n s^2 (-7-8 I \[Omega])+4 n^2 (-7+2 s^2-12 I \[Omega])+20 I \[Omega]+12 I s^2 \[Omega]) c[-2+n]+(5 n^4+2 n s^2 (1+4 I \[Omega])+l (1+2 n^2+n (-2-8 I \[Omega])+4 I \[Omega])+l^2 (1+2 n^2+n (-2-8 I \[Omega])+4 I \[Omega])+n^3 (-8-24 I \[Omega])+(-I+4 \[Omega]) (-I s^2+4 \[Omega])-2 n^2 (-2+s^2-12 I \[Omega]+8 \[Omega]^2)) c[-1+n]);

Do[b[i]=0;c[i]=0;,{i,-6,-1}];
{b[0],c[0]}=basis;

Do[b[i];c[i];,{i,1,nmax}];

rs=r+2M Log[r/(2M)-1];
rsp=1/(1-2M/r);
rsp2=-((2 M)/(-2 M+r)^2);
rsp3=-((4 M)/(2 M-r)^3);
rsp4=-((12 M)/(-2 M+r)^4);
rsp5=-((48 M)/(2 M-r)^5);


E^(-I rs \[Omega]) Sum[
{rsp^-i (b[i]+c[i] Log[1/rsp]),
rsp^(-1-i) ((-i rsp2-I rsp^2 \[Omega]) b[i]+c[i] (-I rsp^2 \[Omega] Log[1/rsp]-rsp2 (1+i Log[1/rsp]))),
rsp^(-2-i) ((i (1+i) rsp2^2-rsp^2 \[Omega] (I rsp2+rsp^2 \[Omega])+rsp (-i rsp3+2 I i rsp rsp2 \[Omega])) b[i]+c[i] (-rsp^2 \[Omega] (I rsp2+rsp^2 \[Omega]) Log[1/rsp]+I rsp (I rsp3+2 rsp rsp2 \[Omega]) (1+i Log[1/rsp])+rsp2^2 (1+2 i+i (1+i) Log[1/rsp]))),
rsp^(-3-i) ((-i (2+3 i+i^2) rsp2^3+3 i (1+i) rsp rsp2 (rsp3-I rsp rsp2 \[Omega])+I rsp^3 \[Omega] (-rsp3+3 I rsp rsp2 \[Omega]+rsp^3 \[Omega]^2)+i rsp^2 (-rsp4+3 I rsp2^2 \[Omega]+3 I rsp rsp3 \[Omega]+3 rsp^2 rsp2 \[Omega]^2)) b[i]+c[i] (I rsp^3 \[Omega] (-rsp3+3 I rsp rsp2 \[Omega]+rsp^3 \[Omega]^2) Log[1/rsp]+rsp^2 (-rsp4+3 I rsp2^2 \[Omega]+3 I rsp rsp3 \[Omega]+3 rsp^2 rsp2 \[Omega]^2) (1+i Log[1/rsp])+3 rsp rsp2 (rsp3-I rsp rsp2 \[Omega]) (1+2 i+i (1+i) Log[1/rsp])-rsp2^3 (2+6 i+3 i^2+i (2+3 i+i^2) Log[1/rsp]))),
rsp^(-4-i) ((i (6+11 i+6 i^2+i^3) rsp2^4+2 I i (2+3 i+i^2) rsp rsp2^2 (3 I rsp3+2 rsp rsp2 \[Omega])-i (1+i) rsp^2 (-3 rsp3^2-4 rsp2 rsp4+6 I rsp2^3 \[Omega]+12 I rsp rsp2 rsp3 \[Omega]+6 rsp^2 rsp2^2 \[Omega]^2)+rsp^4 \[Omega] (-I rsp4-3 rsp2^2 \[Omega]-4 rsp rsp3 \[Omega]+6 I rsp^2 rsp2 \[Omega]^2+rsp^4 \[Omega]^3)+i rsp^3 (-rsp5+10 I rsp2 rsp3 \[Omega]+6 rsp^2 rsp3 \[Omega]^2-4 I rsp^3 rsp2 \[Omega]^3+4 rsp \[Omega] (I rsp4+3 rsp2^2 \[Omega]))) b[i]+c[i] (rsp^4 \[Omega] (-I rsp4-3 rsp2^2 \[Omega]-4 rsp rsp3 \[Omega]+6 I rsp^2 rsp2 \[Omega]^2+rsp^4 \[Omega]^3) Log[1/rsp]+rsp^3 (-rsp5+10 I rsp2 rsp3 \[Omega]+6 rsp^2 rsp3 \[Omega]^2-4 I rsp^3 rsp2 \[Omega]^3+4 rsp \[Omega] (I rsp4+3 rsp2^2 \[Omega])) (1+i Log[1/rsp])-rsp^2 (-3 rsp3^2-4 rsp2 rsp4+6 I rsp2^3 \[Omega]+12 I rsp rsp2 rsp3 \[Omega]+6 rsp^2 rsp2^2 \[Omega]^2) (1+2 i+i (1+i) Log[1/rsp])+2 I rsp rsp2^2 (3 I rsp3+2 rsp rsp2 \[Omega]) (2+6 i+3 i^2+i (2+3 i+i^2) Log[1/rsp])+rsp2^4 (6+22 i+18 i^2+4 i^3+i (6+11 i+6 i^2+i^3) Log[1/rsp])))},
{i,-1,nmax}]
];


(* ::Input::Initialization:: *)
OuterBCRW2[s_,l_,\[Omega]_,nmax_,r_]:=Module[{M=1,a,n,rs,rsp,rsp2},
a[n_]:=a[n]=(I (2 M \[Omega](1-2 n+n^2-s^2) a[-2+n]+(l+l^2+n-n^2) a[-1+n]))/(2 n );

Do[a[i]=0,{i,-3,-1}];
a[0]=1;

Do[a[i];,{i,1,nmax}];
rs=r+2M Log[r/(2M)-1];
rsp=1/(1-2M/r);
rsp2=-((2 M)/(-2 M+r)^2);

E^(I rs \[Omega]) Sum[
{(r \[Omega])^-i a[i],
-(((r \[Omega])^-i (i-I r rsp \[Omega]) a[i])/r),
((r \[Omega])^-i (i+i^2-2 I i r rsp \[Omega]+I r^2 rsp2 \[Omega]-r^2 rsp^2 \[Omega]^2) a[i])/r^2},
{i,0,nmax}]
];


(* ::Input::Initialization:: *)
InnerBCRW2[s_,l_,\[Omega]_,nmax_,r_]:=Module[{M=1,a,n,rs,rsp,rsp2,rsp3},
a[n_]:=a[n]=((-1+2 n-n^2+s^2) a[-2+n]+(1+l+l^2-2 n+2 n^2-s^2) a[-1+n])/(n (n-4 I M \[Omega]));

Do[a[i]=0,{i,-3,-1}];
a[0]=1;

Do[a[i];,{i,1,nmax}];

rs=r+2M Log[r/(2M)-1];
rsp=1/(1-2M/r);
rsp2=-((2 M)/(-2 M+r)^2);
rsp3=-((4 M)/(2 M-r)^3);

E^(-I rs \[Omega]) Sum[
{rsp^-i a[i],
rsp^(-1-i) (-i rsp2-I rsp^2 \[Omega]) a[i],
-rsp^(-2-i) (-i (1+i) rsp2^2+rsp^2 \[Omega] (I rsp2+rsp^2 \[Omega])+i rsp (rsp3-2 I rsp rsp2 \[Omega])) a[i]},{i,-1,nmax}]
];


(* ::Input::Initialization:: *)
OuterBCZ2[l_,\[Omega]_,nmax_,r_]:=OuterBCZ4[l,\[Omega],nmax,r,{1,0}];


(* ::Input::Initialization:: *)
OuterBCZ4[l_,\[Omega]_,nmax_,r_]:=OuterBCZ4[l,\[Omega],nmax,r,{0,1}];


(* ::Input::Initialization:: *)
OuterBCZ4[l_,\[Omega]_,nmax_,r_,basis_]:=
Module[{M=1,\[Lambda],a,b,n,rs,rsp,rsp2,rsp3,rsp4},
\[Lambda]=1/2(l-1)(l+2);

a[n_]:=a[n]=(1/(4 (-1+n) n \[Lambda]^4 \[Omega]^2))(-648 (45-14 n+n^2)^2 a[-9+n]-108 (n (9243-6196 \[Lambda])+n^4 (-9+8 \[Lambda])+270 (-52+31 \[Lambda])-6 n^3 (-39+32 \[Lambda])+12 n^2 (-186+139 \[Lambda])) a[-8+n]-18 (3 n^4 (9-24 \[Lambda]+8 \[Lambda]^2)-24 n^3 (27-66 \[Lambda]+20 \[Lambda]^2-3 I \[Omega])+36 (875-1537 \[Lambda]+323 \[Lambda]^2-396 I \[Omega])+n^2 (5733-12696 \[Lambda]+3440 \[Lambda]^2-1296 I \[Omega])-4 n (5535-10962 \[Lambda]+2608 \[Lambda]^2-1890 I \[Omega])) a[-7+n]-3 (n^4 (-27+216 \[Lambda]-216 \[Lambda]^2+32 \[Lambda]^3)+36 (-630-1937 \[Lambda]^2+216 \[Lambda]^3+\[Lambda] (3247-1782 I \[Omega])+1881 I \[Omega])+n^2 (-4833-25200 \[Lambda]^2+2944 \[Lambda]^3+108 \[Lambda] (293-80 I \[Omega])+7128 I \[Omega])-2 n (-8613-34716 \[Lambda]^2+3680 \[Lambda]^3+18 \[Lambda] (2791-1156 I \[Omega])+19224 I \[Omega])+n^3 (594-4320 \[Lambda]+3888 \[Lambda]^2-512 \[Lambda]^3-432 I \[Omega]+576 I \[Lambda] \[Omega])) a[-6+n]+4 (12 (393-451 n+210 n^2-42 n^3+3 n^4) \[Lambda]^3-2 (279-180 n+62 n^2-12 n^3+n^4) \[Lambda]^4-81 I (24-10 n+n^2) (-5+n+2 I \[Omega]) \[Omega]+27 \[Lambda] (360+n^4+n^2 (119-216 I \[Omega])+n (-342+946 I \[Omega])-1342 I \[Omega]+2 I n^3 (9 I+8 \[Omega]))-9 \[Lambda]^2 (9 n^4+3 n^2 (277-96 I \[Omega])+8 (223-165 I \[Omega])+24 I n^3 (6 I+\[Omega])+4 I n (509 I+274 \[Omega]))) a[-5+n]+2 ((720-586 n+248 n^2-60 n^3+6 n^4) \[Lambda]^4+(-84+40 n-8 n^2) \[Lambda]^5-162 (20-9 n+n^2) \[Omega]^2+216 (15-8 n+n^2) \[Lambda] \[Omega] (4 I-I n+2 \[Omega])-12 \[Lambda]^3 (163+3 n^4+n^3 (-36+8 I \[Omega])+n^2 (151-72 I \[Omega])-204 I \[Omega]+52 I n (5 I+4 \[Omega]))+9 \[Lambda]^2 (3 n^4+64 (5-28 I \[Omega])+n^2 (211-504 I \[Omega])+n (-444+1688 I \[Omega])+6 I n^3 (7 I+8 \[Omega]))) a[-4+n]+2 \[Lambda] (4 (11-8 n+2 n^2) \[Lambda]^4-4 \[Lambda]^5+6 (-2+n) \[Lambda]^2 (-4+n^3+n^2 (-8+16 I \[Omega])+n (17-88 I \[Omega])+104 I \[Omega])+\[Lambda]^3 (-84-3 n^4+8 n^3 (3-I \[Omega])+4 n (27-34 I \[Omega])+n^2 (-69+48 I \[Omega])+192 I \[Omega])-216 (12-7 n+n^2) \[Omega]^2+36 (-4+n) \[Lambda] \[Omega] (-17 I-3 I n^2-12 \[Omega]+3 n (5 I+2 \[Omega]))) a[-3+n]+\[Lambda]^2 (4 \[Lambda]^4-4 \[Lambda]^3 (1+n^2+n (-3+4 I \[Omega])-6 I \[Omega])+\[Lambda]^2 (-8+n^4+n^3 (-6+16 I \[Omega])+2 n (3+64 I \[Omega])+n^2 (7-72 I \[Omega])-132 I \[Omega])-216 (6-5 n+n^2) \[Omega]^2+24 \[Lambda] \[Omega] (7 I-2 I n^3+12 \[Omega]+4 n^2 (3 I+\[Omega])-4 n (5 I+4 \[Omega]))) a[-2+n]+4 \[Lambda]^3 \[Omega] (2 I (-1+n) \[Lambda]^2-12 (2-3 n+n^2) \[Omega]+\[Lambda] (-2 I-I n^3-4 n \[Omega]+n^2 (3 I+2 \[Omega]))) a[-1+n]+2592 (-315+143 n-21 n^2+n^3) b[-9+n]+108 (9243+n^2 (702-576 \[Lambda])-6196 \[Lambda]+4 n^3 (-9+8 \[Lambda])+24 n (-186+139 \[Lambda])) b[-8+n]+36 (21924 \[Lambda]-5216 \[Lambda]^2+6 n^3 (9-24 \[Lambda]+8 \[Lambda]^2)-36 n^2 (27-66 \[Lambda]+20 \[Lambda]^2-3 I \[Omega])+270 (-41+14 I \[Omega])+n (5733-12696 \[Lambda]+3440 \[Lambda]^2-1296 I \[Omega])) b[-7+n]+6 (8613-50238 \[Lambda]+34716 \[Lambda]^2-3680 \[Lambda]^3+n^3 (-54+432 \[Lambda]-432 \[Lambda]^2+64 \[Lambda]^3)+n (-4833-25200 \[Lambda]^2+2944 \[Lambda]^3+108 \[Lambda] (293-80 I \[Omega])+7128 I \[Omega])-19224 I \[Omega]+20808 I \[Lambda] \[Omega]+n^2 (891-6480 \[Lambda]+5832 \[Lambda]^2-768 \[Lambda]^3-648 I \[Omega]+864 I \[Lambda] \[Omega])) b[-6+n]-4 (12 (-451+420 n-126 n^2+12 n^3) \[Lambda]^3-8 (-45+31 n-9 n^2+n^3) \[Lambda]^4-18 \[Lambda]^2 (-1018+18 n^3+3 n (277-96 I \[Omega])+548 I \[Omega]+36 I n^2 (6 I+\[Omega]))+81 \[Omega] (-74 I-3 I n^2-20 \[Omega]+n (30 I+4 \[Omega]))+54 \[Lambda] (-171+2 n^3+n (119-216 I \[Omega])+473 I \[Omega]+3 I n^2 (9 I+8 \[Omega]))) b[-5+n]+4 ((293-248 n+90 n^2-12 n^3) \[Lambda]^4+4 (-5+2 n) \[Lambda]^5+81 (-9+2 n) \[Omega]^2-108 \[Lambda] \[Omega] (-47 I-3 I n^2-16 \[Omega]+4 n (6 I+\[Omega]))+12 \[Lambda]^3 (6 n^3+26 (-5+4 I \[Omega])+n (151-72 I \[Omega])+6 I n^2 (9 I+2 \[Omega]))-9 \[Lambda]^2 (-222+6 n^3+n (211-504 I \[Omega])+844 I \[Omega]+9 I n^2 (7 I+8 \[Omega]))) b[-4+n]-4 \[Lambda] (8 (-2+n) \[Lambda]^4+\[Lambda]^3 (54-6 n^3+12 n^2 (3-I \[Omega])+n (-69+48 I \[Omega])-68 I \[Omega])+108 (7-2 n) \[Omega]^2+18 \[Lambda] \[Omega] (-77 I-9 I n^2-36 \[Omega]+6 n (9 I+2 \[Omega]))+6 \[Lambda]^2 (-19+2 n^3+3 n (11-40 I \[Omega])+140 I \[Omega]+3 I n^2 (5 I+8 \[Omega]))) b[-3+n]+2 \[Lambda]^2 (\[Lambda]^3 (-6+4 n+8 I \[Omega])-\[Lambda]^2 (3+2 n^3+n^2 (-9+24 I \[Omega])+n (7-72 I \[Omega])+64 I \[Omega])+108 (-5+2 n) \[Omega]^2-24 \[Lambda] \[Omega] (-3 I n^2+4 n (3 I+\[Omega])-2 (5 I+4 \[Omega]))) b[-2+n]+4 \[Lambda]^3 \[Omega] (3 I n^2 \[Lambda]-2 I \[Lambda]^2-36 \[Omega]+24 n \[Omega]+4 \[Lambda] \[Omega]-2 n \[Lambda] (3 I+2 \[Omega])) b[-1+n]+4 (-1+2 n) \[Lambda]^4 \[Omega]^2 b[n]);

b[n_]:=b[n]=(1/(4 (-1+n) n \[Lambda]^4 \[Omega]^2))(-648 (45-14 n+n^2)^2 b[-9+n]-108 (n (9243-6196 \[Lambda])+n^4 (-9+8 \[Lambda])+270 (-52+31 \[Lambda])-6 n^3 (-39+32 \[Lambda])+12 n^2 (-186+139 \[Lambda])) b[-8+n]-18 (3 n^4 (9-24 \[Lambda]+8 \[Lambda]^2)-24 n^3 (27-66 \[Lambda]+20 \[Lambda]^2-3 I \[Omega])+36 (875-1537 \[Lambda]+323 \[Lambda]^2-396 I \[Omega])+n^2 (5733-12696 \[Lambda]+3440 \[Lambda]^2-1296 I \[Omega])-4 n (5535-10962 \[Lambda]+2608 \[Lambda]^2-1890 I \[Omega])) b[-7+n]-3 (n^4 (-27+216 \[Lambda]-216 \[Lambda]^2+32 \[Lambda]^3)+36 (-630-1937 \[Lambda]^2+216 \[Lambda]^3+\[Lambda] (3247-1782 I \[Omega])+1881 I \[Omega])+n^2 (-4833-25200 \[Lambda]^2+2944 \[Lambda]^3+108 \[Lambda] (293-80 I \[Omega])+7128 I \[Omega])-2 n (-8613-34716 \[Lambda]^2+3680 \[Lambda]^3+18 \[Lambda] (2791-1156 I \[Omega])+19224 I \[Omega])+n^3 (594-4320 \[Lambda]+3888 \[Lambda]^2-512 \[Lambda]^3-432 I \[Omega]+576 I \[Lambda] \[Omega])) b[-6+n]+4 (12 (393-451 n+210 n^2-42 n^3+3 n^4) \[Lambda]^3-2 (279-180 n+62 n^2-12 n^3+n^4) \[Lambda]^4-81 I (24-10 n+n^2) (-5+n+2 I \[Omega]) \[Omega]+27 \[Lambda] (360+n^4+n^2 (119-216 I \[Omega])+n (-342+946 I \[Omega])-1342 I \[Omega]+2 I n^3 (9 I+8 \[Omega]))-9 \[Lambda]^2 (9 n^4+3 n^2 (277-96 I \[Omega])+8 (223-165 I \[Omega])+24 I n^3 (6 I+\[Omega])+4 I n (509 I+274 \[Omega]))) b[-5+n]+2 ((720-586 n+248 n^2-60 n^3+6 n^4) \[Lambda]^4+(-84+40 n-8 n^2) \[Lambda]^5-162 (20-9 n+n^2) \[Omega]^2+216 (15-8 n+n^2) \[Lambda] \[Omega] (4 I-I n+2 \[Omega])-12 \[Lambda]^3 (163+3 n^4+n^3 (-36+8 I \[Omega])+n^2 (151-72 I \[Omega])-204 I \[Omega]+52 I n (5 I+4 \[Omega]))+9 \[Lambda]^2 (3 n^4+64 (5-28 I \[Omega])+n^2 (211-504 I \[Omega])+n (-444+1688 I \[Omega])+6 I n^3 (7 I+8 \[Omega]))) b[-4+n]+2 \[Lambda] (4 (11-8 n+2 n^2) \[Lambda]^4-4 \[Lambda]^5+6 (-2+n) \[Lambda]^2 (-4+n^3+n^2 (-8+16 I \[Omega])+n (17-88 I \[Omega])+104 I \[Omega])+\[Lambda]^3 (-84-3 n^4+8 n^3 (3-I \[Omega])+4 n (27-34 I \[Omega])+n^2 (-69+48 I \[Omega])+192 I \[Omega])-216 (12-7 n+n^2) \[Omega]^2+36 (-4+n) \[Lambda] \[Omega] (-17 I-3 I n^2-12 \[Omega]+3 n (5 I+2 \[Omega]))) b[-3+n]+\[Lambda]^2 (4 \[Lambda]^4-4 \[Lambda]^3 (1+n^2+n (-3+4 I \[Omega])-6 I \[Omega])+\[Lambda]^2 (-8+n^4+n^3 (-6+16 I \[Omega])+2 n (3+64 I \[Omega])+n^2 (7-72 I \[Omega])-132 I \[Omega])-216 (6-5 n+n^2) \[Omega]^2+24 \[Lambda] \[Omega] (7 I-2 I n^3+12 \[Omega]+4 n^2 (3 I+\[Omega])-4 n (5 I+4 \[Omega]))) b[-2+n]+4 \[Lambda]^3 \[Omega] (2 I (-1+n) \[Lambda]^2-12 (2-3 n+n^2) \[Omega]+\[Lambda] (-2 I-I n^3-4 n \[Omega]+n^2 (3 I+2 \[Omega]))) b[-1+n]);

Do[a[i]=0;b[i]=0;,{i,-9,-1}];

{a[1],b[1]}=basis;
b[0]=0;
a[0]=b[1]/2;

Do[b[i];a[i];,{i,2,nmax}];

rs=r+2M Log[r/(2M)-1];
rsp=1/(1-2M/r);
rsp2=-((2 M)/(-2 M+r)^2);
rsp3=-((4 M)/(2 M-r)^3);
rsp4=-((12 M)/(-2 M+r)^4);


E^(I rs \[Omega]) Sum[
{r^(1-i) (a[i]+b[i] Log[r]),
r^-i ((1-i+I r rsp \[Omega]) a[i]+b[i] (1+Log[r]-i Log[r]+I r rsp \[Omega] Log[r])),
r^(-1-i) (((-1+i) i-2 I (-1+i) r rsp \[Omega]+I r^2 rsp2 \[Omega]-r^2 rsp^2 \[Omega]^2) a[i]+b[i] (1-2 i-i Log[r]+i^2 Log[r]+I r^2 rsp2 \[Omega] Log[r]-r^2 rsp^2 \[Omega]^2 Log[r]-2 I r rsp \[Omega] (-1+(-1+i) Log[r]))),
r^(-2-i) ((i-i^3-3 I (-1+i) r^2 rsp2 \[Omega]+I r^3 rsp3 \[Omega]+3 (-1+i) r^2 rsp^2 \[Omega]^2-I r^3 rsp^3 \[Omega]^3+3 I r rsp \[Omega] ((-1+i) i+I r^2 rsp2 \[Omega])) a[i]+b[i] (-1+3 i^2+i Log[r]-i^3 Log[r]+I r^3 rsp3 \[Omega] Log[r]-I r^3 rsp^3 \[Omega]^3 Log[r]-3 I r^2 rsp2 \[Omega] (-1+(-1+i) Log[r])+3 r^2 rsp^2 \[Omega]^2 (-1+(-1+i) Log[r])+3 I r rsp \[Omega] (1-2 i+(-1+i) i Log[r]+I r^2 rsp2 \[Omega] Log[r]))),
r^(-3-i) ((-2 i-i^2+2 i^3+i^4+6 I (-1+i) i r^2 rsp2 \[Omega]+4 I r^3 rsp3 \[Omega]-4 I i r^3 rsp3 \[Omega]+I r^4 rsp4 \[Omega]-3 r^4 rsp2^2 \[Omega]^2+4 I (-1+i) r^3 rsp^3 \[Omega]^3+r^4 rsp^4 \[Omega]^4-6 r^2 rsp^2 \[Omega]^2 ((-1+i) i+I r^2 rsp2 \[Omega])-4 r rsp \[Omega] (I i (-1+i^2)-3 (-1+i) r^2 rsp2 \[Omega]+r^3 rsp3 \[Omega])) a[i]+b[i] (2+2 i-6 i^2-4 i^3+4 I r^3 rsp3 \[Omega]-2 i Log[r]-i^2 Log[r]+2 i^3 Log[r]+i^4 Log[r]+4 I r^3 rsp3 \[Omega] Log[r]-4 I i r^3 rsp3 \[Omega] Log[r]+I r^4 rsp4 \[Omega] Log[r]-3 r^4 rsp2^2 \[Omega]^2 Log[r]+r^4 rsp^4 \[Omega]^4 Log[r]+4 I r^3 rsp^3 \[Omega]^3 (-1+(-1+i) Log[r])+6 I r^2 rsp2 \[Omega] (1-2 i+(-1+i) i Log[r])+6 r^2 rsp^2 \[Omega]^2 (-1+2 i-(-1+i) i Log[r]-I r^2 rsp2 \[Omega] Log[r])-4 r rsp \[Omega] (r^3 rsp3 \[Omega] Log[r]+3 r^2 rsp2 \[Omega] (1+Log[r]-i Log[r])+I (1-3 i^2+i (-1+i^2) Log[r]))))},{i,0,nmax}]
];


(* ::Input::Initialization:: *)
InnerBCZ2[l_,\[Omega]_,nmax_,r_]:=InnerBCZ4[l,\[Omega],nmax,r,{1,0}];


(* ::Input::Initialization:: *)
InnerBCZ4[l_,\[Omega]_,nmax_,r_]:=InnerBCZ4[l,\[Omega],nmax,r,{0,1}];


(* ::Input::Initialization:: *)
InnerBCZ4[l_,\[Omega]_,nmax_,r_,basis_]:=Module[{M=1,\[Lambda],b,c,a,n,rs,rsp,rsp2,rsp3,rsp4,rsp5},
\[Lambda]=1/2(l-1)(l+2);

b[n_]:=b[n]=(1/(n^2 (3+2 \[Lambda])^4 (n-4 I M \[Omega])^2))(81 (32-12 n+n^2)^2 b[-9+n]-27 (17772+3658 \[Lambda]-32 n^3 (18+5 \[Lambda])+n^4 (27+8 \[Lambda])+12 n^2 (371+95 \[Lambda])-4 n (3684+851 \[Lambda])) b[-8+n]+18 (64818+27075 \[Lambda]+2090 \[Lambda]^2+6 n^4 (27+16 \[Lambda]+2 \[Lambda]^2)+3960 I M \[Omega]-12 n^3 (252+140 \[Lambda]+16 \[Lambda]^2+3 I M \[Omega])+2 n^2 (10269+5265 \[Lambda]+536 \[Lambda]^2+270 I M \[Omega])-6 n (10020+4651 \[Lambda]+408 \[Lambda]^2+432 I M \[Omega])) b[-7+n]-6 (2 n^4 (567+504 \[Lambda]+126 \[Lambda]^2+8 \[Lambda]^3)-12 n^3 (1512+1260 \[Lambda]+288 \[Lambda]^2+16 \[Lambda]^3+63 I M \[Omega]+24 I M \[Lambda] \[Omega])-6 n (45036+31545 \[Lambda]+5636 \[Lambda]^2+240 \[Lambda]^3+6696 I M \[Omega]+2172 I M \[Lambda] \[Omega])+3 (85518+54549 \[Lambda]+8902 \[Lambda]^2+480 \[Lambda]^3+17766 I M \[Omega]+5100 I M \[Lambda] \[Omega])+2 n^2 (53109+8364 \[Lambda]^2+400 \[Lambda]^3+4860 I M \[Omega]+27 \[Lambda] (1515+64 I M \[Omega]))) b[-6+n]+(2 n^4 (5103+6048 \[Lambda]+2268 \[Lambda]^2+288 \[Lambda]^3+8 \[Lambda]^4)-8 n^3 (720 \[Lambda]^3+16 \[Lambda]^4+1701 (10+I M \[Omega])+216 \[Lambda]^2 (30+I M \[Omega])+108 \[Lambda] (175+12 I M \[Omega]))+4 n^2 (5184 \[Lambda]^3+128 \[Lambda]^4+405 \[Lambda] (425+64 I M \[Omega])+36 \[Lambda]^2 (1475+108 I M \[Omega])-81 (-2065-450 I M \[Omega]+4 M^2 \[Omega]^2))-4 n (8544 \[Lambda]^3+352 \[Lambda]^4+36 \[Lambda]^2 (2591+296 I M \[Omega])+27 \[Lambda] (12595+3044 I M \[Omega])-324 (-1115-390 I M \[Omega]+8 M^2 \[Omega]^2))+6 (5392 \[Lambda]^3+400 \[Lambda]^4+24 \[Lambda]^2 (1867+244 I M \[Omega])+9 \[Lambda] (19075+6116 I M \[Omega])-270 (-731-351 I M \[Omega]+12 M^2 \[Omega]^2))) b[-5+n]-2 (3488 \[Lambda]^4+208 \[Lambda]^5+n^4 (5103+7560 \[Lambda]+3780 \[Lambda]^2+720 \[Lambda]^3+40 \[Lambda]^4)+48 \[Lambda]^3 (469+60 I M \[Omega])+36 \[Lambda]^2 (3083+1392 I M \[Omega])+162 (1631+1550 I M \[Omega]-192 M^2 \[Omega]^2)-27 \[Lambda] (-10955-8232 I M \[Omega]+512 M^2 \[Omega]^2)-4 n^3 (64 \[Lambda]^4+1080 \[Lambda]^2 (8+I M \[Omega])+96 \[Lambda]^3 (15+I M \[Omega])+567 (24+5 I M \[Omega])+540 \[Lambda] (35+6 I M \[Omega]))+2 n^2 (480 \[Lambda]^4+16 \[Lambda]^5+96 \[Lambda]^3 (91+12 I M \[Omega])+72 \[Lambda]^2 (805+216 I M \[Omega])-81 (-1337-600 I M \[Omega]+20 M^2 \[Omega]^2)-27 \[Lambda] (-5175-1920 I M \[Omega]+32 M^2 \[Omega]^2))-2 n (1168 \[Lambda]^4+48 \[Lambda]^5+48 \[Lambda]^3 (269+44 I M \[Omega])+648 \[Lambda]^2 (133+54 I M \[Omega])-324 (-593-420 I M \[Omega]+32 M^2 \[Omega]^2)-27 \[Lambda] (-8465-4936 I M \[Omega]+192 M^2 \[Omega]^2))) b[-4+n]+2 (3+2 \[Lambda]) (208 \[Lambda]^4+16 \[Lambda]^5+2 n^4 (567+630 \[Lambda]+210 \[Lambda]^2+20 \[Lambda]^3)+24 \[Lambda]^3 (59+16 I M \[Omega])+12 \[Lambda]^2 (405+248 I M \[Omega])-54 (-391-690 I M \[Omega]+216 M^2 \[Omega]^2)-9 \[Lambda] (-1715-2240 I M \[Omega]+288 M^2 \[Omega]^2)-4 I n^3 (8 \[Lambda]^3 (-6 I+M \[Omega])+189 (-12 I+5 M \[Omega])+162 \[Lambda] (-14 I+5 M \[Omega])+36 \[Lambda]^2 (-18 I+5 M \[Omega]))+6 n^2 (8 \[Lambda]^4+4 \[Lambda]^3 (25+4 I M \[Omega])+2 \[Lambda]^2 (517+276 I M \[Omega])+\[Lambda] (4089+3060 I M \[Omega]-144 M^2 \[Omega]^2)+9 (511+450 I M \[Omega]-40 M^2 \[Omega]^2))-2 n (56 \[Lambda]^4+4 \[Lambda]^3 (149+32 I M \[Omega])+6 \[Lambda]^2 (607+416 I M \[Omega])-324 (-59-80 I M \[Omega]+16 M^2 \[Omega]^2)-9 \[Lambda] (-1665-1864 I M \[Omega]+192 M^2 \[Omega]^2))) b[-3+n]-2 (3+2 \[Lambda])^2 (8 \[Lambda]^4+2 n^4 (81+60 \[Lambda]+10 \[Lambda]^2)+54 \[Lambda]^2 (3+4 I M \[Omega])+4 \[Lambda]^3 (11+4 I M \[Omega])+3 \[Lambda] (97+188 I M \[Omega])+18 (41+135 I M \[Omega]-96 M^2 \[Omega]^2)+n^3 (-864-756 I M \[Omega]+\[Lambda]^2 (-64-48 I M \[Omega])+\[Lambda] (-528-432 I M \[Omega]))+2 n^2 (909+12 \[Lambda]^3+1620 I M \[Omega]-360 M^2 \[Omega]^2+\[Lambda]^2 (68+48 I M \[Omega])+\[Lambda] (453+720 I M \[Omega]-96 M^2 \[Omega]^2))+2 n (\[Lambda]^3 (-20-16 I M \[Omega])+\[Lambda]^2 (-96-96 I M \[Omega])+36 (-25-66 I M \[Omega]+32 M^2 \[Omega]^2)+3 \[Lambda] (-121-260 I M \[Omega]+64 M^2 \[Omega]^2))) b[-2+n]+(3+2 \[Lambda])^3 (n^4 (27+10 \[Lambda])-4 I n (12+\[Lambda]+2 \[Lambda]^2+24 I M \[Omega]) (-I+4 M \[Omega])+2 (-I+4 M \[Omega]) (6 I+2 I \[Lambda]^2-18 M \[Omega]+\[Lambda] (I+4 M \[Omega]))-8 I n^3 (-9 I+21 M \[Omega]+\[Lambda] (-2 I+6 M \[Omega]))+4 n^2 (21+2 \[Lambda]^2+90 I M \[Omega]-60 M^2 \[Omega]^2+\[Lambda] (3+12 I M \[Omega]-8 M^2 \[Omega]^2))) b[-1+n]+324 (-192+104 n-18 n^2+n^3) c[-9+n]+108 (3684+851 \[Lambda]+24 n^2 (18+5 \[Lambda])-n^3 (27+8 \[Lambda])-6 n (371+95 \[Lambda])) c[-8+n]+36 (12 n^3 (27+16 \[Lambda]+2 \[Lambda]^2)-18 n^2 (252+140 \[Lambda]+16 \[Lambda]^2+3 I M \[Omega])+2 n (10269+5265 \[Lambda]+536 \[Lambda]^2+270 I M \[Omega])-3 (10020+4651 \[Lambda]+408 \[Lambda]^2+432 I M \[Omega])) c[-7+n]-12 (4 n^3 (567+504 \[Lambda]+126 \[Lambda]^2+8 \[Lambda]^3)-18 n^2 (1512+1260 \[Lambda]+288 \[Lambda]^2+16 \[Lambda]^3+63 I M \[Omega]+24 I M \[Lambda] \[Omega])-3 (45036+31545 \[Lambda]+5636 \[Lambda]^2+240 \[Lambda]^3+6696 I M \[Omega]+2172 I M \[Lambda] \[Omega])+2 n (53109+8364 \[Lambda]^2+400 \[Lambda]^3+4860 I M \[Omega]+27 \[Lambda] (1515+64 I M \[Omega]))) c[-6+n]-4 (8544 \[Lambda]^3+352 \[Lambda]^4-2 n^3 (5103+6048 \[Lambda]+2268 \[Lambda]^2+288 \[Lambda]^3+8 \[Lambda]^4)+36 \[Lambda]^2 (2591+296 I M \[Omega])+27 \[Lambda] (12595+3044 I M \[Omega])-324 (-1115-390 I M \[Omega]+8 M^2 \[Omega]^2)+6 n^2 (720 \[Lambda]^3+16 \[Lambda]^4+1701 (10+I M \[Omega])+216 \[Lambda]^2 (30+I M \[Omega])+108 \[Lambda] (175+12 I M \[Omega]))-2 n (5184 \[Lambda]^3+128 \[Lambda]^4+405 \[Lambda] (425+64 I M \[Omega])+36 \[Lambda]^2 (1475+108 I M \[Omega])-81 (-2065-450 I M \[Omega]+4 M^2 \[Omega]^2))) c[-5+n]+4 (1168 \[Lambda]^4+48 \[Lambda]^5-2 n^3 (5103+7560 \[Lambda]+3780 \[Lambda]^2+720 \[Lambda]^3+40 \[Lambda]^4)+48 \[Lambda]^3 (269+44 I M \[Omega])+648 \[Lambda]^2 (133+54 I M \[Omega])-324 (-593-420 I M \[Omega]+32 M^2 \[Omega]^2)-27 \[Lambda] (-8465-4936 I M \[Omega]+192 M^2 \[Omega]^2)+6 n^2 (64 \[Lambda]^4+1080 \[Lambda]^2 (8+I M \[Omega])+96 \[Lambda]^3 (15+I M \[Omega])+567 (24+5 I M \[Omega])+540 \[Lambda] (35+6 I M \[Omega]))-2 n (480 \[Lambda]^4+16 \[Lambda]^5+96 \[Lambda]^3 (91+12 I M \[Omega])+72 \[Lambda]^2 (805+216 I M \[Omega])-81 (-1337-600 I M \[Omega]+20 M^2 \[Omega]^2)-27 \[Lambda] (-5175-1920 I M \[Omega]+32 M^2 \[Omega]^2))) c[-4+n]-4 (3+2 \[Lambda]) (56 \[Lambda]^4-4 n^3 (567+630 \[Lambda]+210 \[Lambda]^2+20 \[Lambda]^3)+4 \[Lambda]^3 (149+32 I M \[Omega])+6 \[Lambda]^2 (607+416 I M \[Omega])-324 (-59-80 I M \[Omega]+16 M^2 \[Omega]^2)-9 \[Lambda] (-1665-1864 I M \[Omega]+192 M^2 \[Omega]^2)+6 n^2 (8 \[Lambda]^3 (6+I M \[Omega])+189 (12+5 I M \[Omega])+162 \[Lambda] (14+5 I M \[Omega])+36 \[Lambda]^2 (18+5 I M \[Omega]))-6 n (8 \[Lambda]^4+4 \[Lambda]^3 (25+4 I M \[Omega])+2 \[Lambda]^2 (517+276 I M \[Omega])+\[Lambda] (4089+3060 I M \[Omega]-144 M^2 \[Omega]^2)+9 (511+450 I M \[Omega]-40 M^2 \[Omega]^2))) c[-3+n]-4 (3+2 \[Lambda])^2 (4 n^3 (81+60 \[Lambda]+10 \[Lambda]^2)-96 \[Lambda]^2 (1+I M \[Omega])-4 \[Lambda]^3 (5+4 I M \[Omega])+36 (-25-66 I M \[Omega]+32 M^2 \[Omega]^2)+3 \[Lambda] (-121-260 I M \[Omega]+64 M^2 \[Omega]^2)-6 n^2 (4 \[Lambda]^2 (4+3 I M \[Omega])+27 (8+7 I M \[Omega])+12 \[Lambda] (11+9 I M \[Omega]))+2 n (909+12 \[Lambda]^3+1620 I M \[Omega]-360 M^2 \[Omega]^2+\[Lambda]^2 (68+48 I M \[Omega])+\[Lambda] (453+720 I M \[Omega]-96 M^2 \[Omega]^2))) c[-2+n]+(3+2 \[Lambda])^3 (4 n^3 (27+10 \[Lambda])-4 (1+4 I M \[Omega]) (12+\[Lambda]+2 \[Lambda]^2+24 I M \[Omega])-24 n^2 (9+21 I M \[Omega]+\[Lambda] (2+6 I M \[Omega]))+8 n (21+2 \[Lambda]^2+90 I M \[Omega]-60 M^2 \[Omega]^2+\[Lambda] (3+12 I M \[Omega]-8 M^2 \[Omega]^2))) c[-1+n]-4 n (3+2 \[Lambda])^4 (n-2 I M \[Omega]) (n-4 I M \[Omega]) c[n]);

c[n_]:=c[n]=(1/(n^2 (3+2 \[Lambda])^4 (n-4 I M \[Omega])^2))(81 (32-12 n+n^2)^2 c[-9+n]-27 (17772+3658 \[Lambda]-32 n^3 (18+5 \[Lambda])+n^4 (27+8 \[Lambda])+12 n^2 (371+95 \[Lambda])-4 n (3684+851 \[Lambda])) c[-8+n]+18 (64818+27075 \[Lambda]+2090 \[Lambda]^2+6 n^4 (27+16 \[Lambda]+2 \[Lambda]^2)+3960 I M \[Omega]-12 n^3 (252+140 \[Lambda]+16 \[Lambda]^2+3 I M \[Omega])+2 n^2 (10269+5265 \[Lambda]+536 \[Lambda]^2+270 I M \[Omega])-6 n (10020+4651 \[Lambda]+408 \[Lambda]^2+432 I M \[Omega])) c[-7+n]-6 (2 n^4 (567+504 \[Lambda]+126 \[Lambda]^2+8 \[Lambda]^3)-12 n^3 (1512+1260 \[Lambda]+288 \[Lambda]^2+16 \[Lambda]^3+63 I M \[Omega]+24 I M \[Lambda] \[Omega])-6 n (45036+31545 \[Lambda]+5636 \[Lambda]^2+240 \[Lambda]^3+6696 I M \[Omega]+2172 I M \[Lambda] \[Omega])+3 (85518+54549 \[Lambda]+8902 \[Lambda]^2+480 \[Lambda]^3+17766 I M \[Omega]+5100 I M \[Lambda] \[Omega])+2 n^2 (53109+8364 \[Lambda]^2+400 \[Lambda]^3+4860 I M \[Omega]+27 \[Lambda] (1515+64 I M \[Omega]))) c[-6+n]+(2 n^4 (5103+6048 \[Lambda]+2268 \[Lambda]^2+288 \[Lambda]^3+8 \[Lambda]^4)-8 n^3 (720 \[Lambda]^3+16 \[Lambda]^4+1701 (10+I M \[Omega])+216 \[Lambda]^2 (30+I M \[Omega])+108 \[Lambda] (175+12 I M \[Omega]))+4 n^2 (5184 \[Lambda]^3+128 \[Lambda]^4+405 \[Lambda] (425+64 I M \[Omega])+36 \[Lambda]^2 (1475+108 I M \[Omega])-81 (-2065-450 I M \[Omega]+4 M^2 \[Omega]^2))-4 n (8544 \[Lambda]^3+352 \[Lambda]^4+36 \[Lambda]^2 (2591+296 I M \[Omega])+27 \[Lambda] (12595+3044 I M \[Omega])-324 (-1115-390 I M \[Omega]+8 M^2 \[Omega]^2))+6 (5392 \[Lambda]^3+400 \[Lambda]^4+24 \[Lambda]^2 (1867+244 I M \[Omega])+9 \[Lambda] (19075+6116 I M \[Omega])-270 (-731-351 I M \[Omega]+12 M^2 \[Omega]^2))) c[-5+n]-2 (3488 \[Lambda]^4+208 \[Lambda]^5+n^4 (5103+7560 \[Lambda]+3780 \[Lambda]^2+720 \[Lambda]^3+40 \[Lambda]^4)+48 \[Lambda]^3 (469+60 I M \[Omega])+36 \[Lambda]^2 (3083+1392 I M \[Omega])+162 (1631+1550 I M \[Omega]-192 M^2 \[Omega]^2)-27 \[Lambda] (-10955-8232 I M \[Omega]+512 M^2 \[Omega]^2)-4 n^3 (64 \[Lambda]^4+1080 \[Lambda]^2 (8+I M \[Omega])+96 \[Lambda]^3 (15+I M \[Omega])+567 (24+5 I M \[Omega])+540 \[Lambda] (35+6 I M \[Omega]))+2 n^2 (480 \[Lambda]^4+16 \[Lambda]^5+96 \[Lambda]^3 (91+12 I M \[Omega])+72 \[Lambda]^2 (805+216 I M \[Omega])-81 (-1337-600 I M \[Omega]+20 M^2 \[Omega]^2)-27 \[Lambda] (-5175-1920 I M \[Omega]+32 M^2 \[Omega]^2))-2 n (1168 \[Lambda]^4+48 \[Lambda]^5+48 \[Lambda]^3 (269+44 I M \[Omega])+648 \[Lambda]^2 (133+54 I M \[Omega])-324 (-593-420 I M \[Omega]+32 M^2 \[Omega]^2)-27 \[Lambda] (-8465-4936 I M \[Omega]+192 M^2 \[Omega]^2))) c[-4+n]+2 (3+2 \[Lambda]) (208 \[Lambda]^4+16 \[Lambda]^5+2 n^4 (567+630 \[Lambda]+210 \[Lambda]^2+20 \[Lambda]^3)+24 \[Lambda]^3 (59+16 I M \[Omega])+12 \[Lambda]^2 (405+248 I M \[Omega])-54 (-391-690 I M \[Omega]+216 M^2 \[Omega]^2)-9 \[Lambda] (-1715-2240 I M \[Omega]+288 M^2 \[Omega]^2)-4 I n^3 (8 \[Lambda]^3 (-6 I+M \[Omega])+189 (-12 I+5 M \[Omega])+162 \[Lambda] (-14 I+5 M \[Omega])+36 \[Lambda]^2 (-18 I+5 M \[Omega]))+6 n^2 (8 \[Lambda]^4+4 \[Lambda]^3 (25+4 I M \[Omega])+2 \[Lambda]^2 (517+276 I M \[Omega])+\[Lambda] (4089+3060 I M \[Omega]-144 M^2 \[Omega]^2)+9 (511+450 I M \[Omega]-40 M^2 \[Omega]^2))-2 n (56 \[Lambda]^4+4 \[Lambda]^3 (149+32 I M \[Omega])+6 \[Lambda]^2 (607+416 I M \[Omega])-324 (-59-80 I M \[Omega]+16 M^2 \[Omega]^2)-9 \[Lambda] (-1665-1864 I M \[Omega]+192 M^2 \[Omega]^2))) c[-3+n]-2 (3+2 \[Lambda])^2 (8 \[Lambda]^4+2 n^4 (81+60 \[Lambda]+10 \[Lambda]^2)+54 \[Lambda]^2 (3+4 I M \[Omega])+4 \[Lambda]^3 (11+4 I M \[Omega])+3 \[Lambda] (97+188 I M \[Omega])+18 (41+135 I M \[Omega]-96 M^2 \[Omega]^2)+n^3 (-864-756 I M \[Omega]+\[Lambda]^2 (-64-48 I M \[Omega])+\[Lambda] (-528-432 I M \[Omega]))+2 n^2 (909+12 \[Lambda]^3+1620 I M \[Omega]-360 M^2 \[Omega]^2+\[Lambda]^2 (68+48 I M \[Omega])+\[Lambda] (453+720 I M \[Omega]-96 M^2 \[Omega]^2))+2 n (\[Lambda]^3 (-20-16 I M \[Omega])+\[Lambda]^2 (-96-96 I M \[Omega])+36 (-25-66 I M \[Omega]+32 M^2 \[Omega]^2)+3 \[Lambda] (-121-260 I M \[Omega]+64 M^2 \[Omega]^2))) c[-2+n]+(3+2 \[Lambda])^3 (n^4 (27+10 \[Lambda])-4 I n (12+\[Lambda]+2 \[Lambda]^2+24 I M \[Omega]) (-I+4 M \[Omega])+2 (-I+4 M \[Omega]) (6 I+2 I \[Lambda]^2-18 M \[Omega]+\[Lambda] (I+4 M \[Omega]))-8 I n^3 (-9 I+21 M \[Omega]+\[Lambda] (-2 I+6 M \[Omega]))+4 n^2 (21+2 \[Lambda]^2+90 I M \[Omega]-60 M^2 \[Omega]^2+\[Lambda] (3+12 I M \[Omega]-8 M^2 \[Omega]^2))) c[-1+n]);

Do[b[i]=0;c[i]=0;,{i,-9,-1}];
{b[0],c[0]}=basis;

Do[b[i];c[i];,{i,1,nmax}];

rs=r+2M Log[r/(2M)-1];
rsp=1/(1-2M/r);
rsp2=-((2 M)/(-2 M+r)^2);
rsp3=-((4 M)/(2 M-r)^3);
rsp4=-((12 M)/(-2 M+r)^4);
rsp5=-((48 M)/(2 M-r)^5);

E^(-I rs \[Omega]) Sum[
{rsp^-i (b[i]+c[i] Log[1/rsp]),
rsp^(-1-i) ((-i rsp2-I rsp^2 \[Omega]) b[i]+c[i] (-I rsp^2 \[Omega] Log[1/rsp]-rsp2 (1+i Log[1/rsp]))),
rsp^(-2-i) ((i (1+i) rsp2^2-rsp^2 \[Omega] (I rsp2+rsp^2 \[Omega])+rsp (-i rsp3+2 I i rsp rsp2 \[Omega])) b[i]+c[i] (-rsp^2 \[Omega] (I rsp2+rsp^2 \[Omega]) Log[1/rsp]+I rsp (I rsp3+2 rsp rsp2 \[Omega]) (1+i Log[1/rsp])+rsp2^2 (1+2 i+i (1+i) Log[1/rsp]))),
rsp^(-3-i) ((-i (2+3 i+i^2) rsp2^3+3 i (1+i) rsp rsp2 (rsp3-I rsp rsp2 \[Omega])+I rsp^3 \[Omega] (-rsp3+3 I rsp rsp2 \[Omega]+rsp^3 \[Omega]^2)+i rsp^2 (-rsp4+3 I rsp2^2 \[Omega]+3 I rsp rsp3 \[Omega]+3 rsp^2 rsp2 \[Omega]^2)) b[i]+c[i] (I rsp^3 \[Omega] (-rsp3+3 I rsp rsp2 \[Omega]+rsp^3 \[Omega]^2) Log[1/rsp]+rsp^2 (-rsp4+3 I rsp2^2 \[Omega]+3 I rsp rsp3 \[Omega]+3 rsp^2 rsp2 \[Omega]^2) (1+i Log[1/rsp])+3 rsp rsp2 (rsp3-I rsp rsp2 \[Omega]) (1+2 i+i (1+i) Log[1/rsp])-rsp2^3 (2+6 i+3 i^2+i (2+3 i+i^2) Log[1/rsp]))),
rsp^(-4-i) ((i (6+11 i+6 i^2+i^3) rsp2^4+2 I i (2+3 i+i^2) rsp rsp2^2 (3 I rsp3+2 rsp rsp2 \[Omega])-i (1+i) rsp^2 (-3 rsp3^2-4 rsp2 rsp4+6 I rsp2^3 \[Omega]+12 I rsp rsp2 rsp3 \[Omega]+6 rsp^2 rsp2^2 \[Omega]^2)+rsp^4 \[Omega] (-I rsp4-3 rsp2^2 \[Omega]-4 rsp rsp3 \[Omega]+6 I rsp^2 rsp2 \[Omega]^2+rsp^4 \[Omega]^3)+i rsp^3 (-rsp5+10 I rsp2 rsp3 \[Omega]+6 rsp^2 rsp3 \[Omega]^2-4 I rsp^3 rsp2 \[Omega]^3+4 rsp \[Omega] (I rsp4+3 rsp2^2 \[Omega]))) b[i]+c[i] (rsp^4 \[Omega] (-I rsp4-3 rsp2^2 \[Omega]-4 rsp rsp3 \[Omega]+6 I rsp^2 rsp2 \[Omega]^2+rsp^4 \[Omega]^3) Log[1/rsp]+rsp^3 (-rsp5+10 I rsp2 rsp3 \[Omega]+6 rsp^2 rsp3 \[Omega]^2-4 I rsp^3 rsp2 \[Omega]^3+4 rsp \[Omega] (I rsp4+3 rsp2^2 \[Omega])) (1+i Log[1/rsp])-rsp^2 (-3 rsp3^2-4 rsp2 rsp4+6 I rsp2^3 \[Omega]+12 I rsp rsp2 rsp3 \[Omega]+6 rsp^2 rsp2^2 \[Omega]^2) (1+2 i+i (1+i) Log[1/rsp])+2 I rsp rsp2^2 (3 I rsp3+2 rsp rsp2 \[Omega]) (2+6 i+3 i^2+i (2+3 i+i^2) Log[1/rsp])+rsp2^4 (6+22 i+18 i^2+4 i^3+i (6+11 i+6 i^2+i^3) Log[1/rsp])))},{i,-1,nmax}]
];


(* ::Input::Initialization:: *)
OuterBC\[Chi][l_,\[Omega]_,nmax_,r_]:=OuterBC\[Chi][l,\[Omega],nmax,r,{1,0}];


(* ::Input::Initialization:: *)
OuterBC\[Chi][l_,\[Omega]_,nmax_,r_,basis_]:=Module[{M=1,a,n,rs,rsp,rsp2,rsp3,rsp4},
a[n_]:=a[n]=-(1/(4 (-1+n) n \[Omega]^2))(-4 (4-5 n+n^2)^2 a[-4+n]-4 (-6+5 l (1+l)) a[-3+n]-4 (-4+n) n (-5+l+l^2-(-4+n) n) a[-3+n]-(2 l^3+l^4+(-3+n) (-2+n) (-1+n) n+l^2 (-5-2 (-3+n) n)-2 l (3+(-3+n) n)+4 I (-3+2 n) (1+(-3+n) n) \[Omega]) a[-2+n]-4 I (-1+n) (l+l^2-(-2+n) n) \[Omega] a[-1+n]);

Do[a[i]=0,{i,-6,-1}];
a[0]=basis[[1]];
a[1]=basis[[2]];

Do[a[i];,{i,2,nmax}];

rs=r+2M Log[r/(2M)-1];
rsp=1/(1-2M/r);
rsp2=-((2 M)/(-2 M+r)^2);
rsp3=-((4 M)/(2 M-r)^3);
rsp4=-((12 M)/(-2 M+r)^4);

E^(I rs \[Omega]) Sum[
{r^(1-i) a[i],
-r^-i (-1+i-I r rsp \[Omega]) a[i],
r^(-1-i) ((-1+i) i-2 I (-1+i) r rsp \[Omega]+I r^2 rsp2 \[Omega]-r^2 rsp^2 \[Omega]^2) a[i],
r^(-2-i) (i-i^3-3 I (-1+i) r^2 rsp2 \[Omega]+I r^3 rsp3 \[Omega]+3 (-1+i) r^2 rsp^2 \[Omega]^2-I r^3 rsp^3 \[Omega]^3+3 I r rsp \[Omega] ((-1+i) i+I r^2 rsp2 \[Omega])) a[i],
r^(-3-i) (-2 i-i^2+2 i^3+i^4+6 I (-1+i) i r^2 rsp2 \[Omega]+4 I r^3 rsp3 \[Omega]-4 I i r^3 rsp3 \[Omega]+I r^4 rsp4 \[Omega]-3 r^4 rsp2^2 \[Omega]^2+4 I (-1+i) r^3 rsp^3 \[Omega]^3+r^4 rsp^4 \[Omega]^4-6 r^2 rsp^2 \[Omega]^2 ((-1+i) i+I r^2 rsp2 \[Omega])-4 r rsp \[Omega] (I i (-1+i^2)-3 (-1+i) r^2 rsp2 \[Omega]+r^3 rsp3 \[Omega])) a[i]},{i,0,nmax}]
];


(* ::Input::Initialization:: *)
InnerBC\[Chi][l_,\[Omega]_,nmax_,r_]:=InnerBC\[Chi][l,\[Omega],nmax,r,{1,0}];


(* ::Input::Initialization:: *)
InnerBC\[Chi][l_,\[Omega]_,nmax_,r_,basis_]:=Module[{M=1,b,n,rs,rsp,rsp2,rsp3,rsp4,rsp5},
b[n_]:=b[n]=-(1/(n (1+n) (n-4 I \[Omega]) (1+n-4 I \[Omega])))(-(-3+n)^2 n^2 b[-5+n]+(4 l (1+l)-4 l (1+l) n+(25+2 l (1+l)) n^2-22 n^3+5 n^4) b[-4+n]-(2 l^3+l^4+l (6-8 n+6 n^2)+l^2 (7-8 n+6 n^2)+2 n^2 (11+n (-14+5 n))-4 I (-1+2 n) (-1+(-1+n) n) \[Omega]) b[-3+n]+(2 l^3+l^4+2 n^2 (3+n (-6+5 n))+l (2+2 n (-2+3 n-4 I \[Omega]))+l^2 (3+2 n (-2+3 n-4 I \[Omega]))-4 I (1+2 n) (1+3 (-1+n) n) \[Omega]) b[-2+n]-n (n-4 I \[Omega]) (1+2 l (1+l)+2 n+5 n^2-4 I (1+n) \[Omega]) b[-1+n]);

Do[b[i]=0,{i,-6,-2}];
b[-1]=basis[[1]];
b[0]=basis[[2]];

Do[b[i];,{i,1,nmax}];

rs=r+2M Log[r/(2M)-1];
rsp=1/(1-2M/r);
rsp2=-((2 M)/(-2 M+r)^2);
rsp3=-((4 M)/(2 M-r)^3);
rsp4=-((12 M)/(-2 M+r)^4);
rsp5=-((48 M)/(2 M-r)^5);

E^(-I rs \[Omega]) Sum[
{rsp^(-1-i) b[i],
rsp^(-2-i) (-((1+i) rsp2)-I rsp^2 \[Omega]) b[i],
-rsp^(-3-i) (-((2+3 i+i^2) rsp2^2)+rsp^2 \[Omega] (I rsp2+rsp^2 \[Omega])+(1+i) rsp (rsp3-2 I rsp rsp2 \[Omega])) b[i],
rsp^(-4-i) (-((6+11 i+6 i^2+i^3) rsp2^3)+3 (2+3 i+i^2) rsp rsp2 (rsp3-I rsp rsp2 \[Omega])+I rsp^3 \[Omega] (-rsp3+3 I rsp rsp2 \[Omega]+rsp^3 \[Omega]^2)+(1+i) rsp^2 (-rsp4+3 I rsp2^2 \[Omega]+3 I rsp rsp3 \[Omega]+3 rsp^2 rsp2 \[Omega]^2)) b[i],
rsp^(-5-i) ((24+50 i+35 i^2+10 i^3+i^4) rsp2^4+2 I (6+11 i+6 i^2+i^3) rsp rsp2^2 (3 I rsp3+2 rsp rsp2 \[Omega])-(2+3 i+i^2) rsp^2 (-3 rsp3^2-4 rsp2 rsp4+6 I rsp2^3 \[Omega]+12 I rsp rsp2 rsp3 \[Omega]+6 rsp^2 rsp2^2 \[Omega]^2)+rsp^4 \[Omega] (-I rsp4-3 rsp2^2 \[Omega]-4 rsp rsp3 \[Omega]+6 I rsp^2 rsp2 \[Omega]^2+rsp^4 \[Omega]^3)+(1+i) rsp^3 (-rsp5+10 I rsp2 rsp3 \[Omega]+6 rsp^2 rsp3 \[Omega]^2-4 I rsp^3 rsp2 \[Omega]^3+4 rsp \[Omega] (I rsp4+3 rsp2^2 \[Omega]))) b[i]},{i,-1,nmax}]
];


(* ::Input::Initialization:: *)
OuterBC\[Chi]1[l_,\[Omega]_,nmax_,r_]:=OuterBC\[Chi]1[l,\[Omega],nmax,r,{1,0,0}];


(* ::Input::Initialization:: *)
OuterBC\[Chi]1[l_,\[Omega]_,nmax_,r_,basis_]:=Module[{M=1,a,b,n,rs,rsp,rsp2,rsp3,rsp4,rsp5,rsp6},
a[n_]:=a[n]=-(1/(8 (-2+n) n (2-3 n+n^2) \[Omega]^3))(I (2-n) (16 (-40+53 n-14 n^2+n^3)^2 a[-7+n]+8 (-3164+9384 n-9711 n^2+4341 n^3-945 n^4+99 n^5-4 n^6+l (858-788 n+301 n^2-50 n^3+3 n^4)+l^2 (858-788 n+301 n^2-50 n^3+3 n^4)) a[-6+n]+7776 a[-5+n]-6168 l a[-5+n]-5956 l^2 a[-5+n]+424 l^3 a[-5+n]+212 l^4 a[-5+n]-27576 n a[-5+n]+6344 l n a[-5+n]+6256 l^2 n a[-5+n]-176 l^3 n a[-5+n]-88 l^4 n a[-5+n]+33060 n^2 a[-5+n]-2740 l n^2 a[-5+n]-2728 l^2 n^2 a[-5+n]+24 l^3 n^2 a[-5+n]+12 l^4 n^2 a[-5+n]-17044 n^3 a[-5+n]+520 l n^3 a[-5+n]+520 l^2 n^3 a[-5+n]+4276 n^4 a[-5+n]-36 l n^4 a[-5+n]-36 l^2 n^4 a[-5+n]-516 n^5 a[-5+n]+24 n^6 a[-5+n]-5104 I \[Omega] a[-5+n]+18256 I n \[Omega] a[-5+n]-16544 I n^2 \[Omega] a[-5+n]+5824 I n^3 \[Omega] a[-5+n]-880 I n^4 \[Omega] a[-5+n]+48 I n^5 \[Omega] a[-5+n]-720 a[-4+n]+1644 l a[-4+n]+1490 l^2 a[-4+n]-306 l^3 a[-4+n]-148 l^4 a[-4+n]+6 l^5 a[-4+n]+2 l^6 a[-4+n]+3684 n a[-4+n]-1968 l n a[-4+n]-1894 l^2 n a[-4+n]+148 l^3 n a[-4+n]+74 l^4 n a[-4+n]-5498 n^2 a[-4+n]+990 l n^2 a[-4+n]+978 l^2 n^2 a[-4+n]-24 l^3 n^2 a[-4+n]-12 l^4 n^2 a[-4+n]+3418 n^3 a[-4+n]-220 l n^3 a[-4+n]-220 l^2 n^3 a[-4+n]-1022 n^4 a[-4+n]+18 l n^4 a[-4+n]+18 l^2 n^4 a[-4+n]+146 n^5 a[-4+n]-8 n^6 a[-4+n]+3288 I \[Omega] a[-4+n]-1448 I l \[Omega] a[-4+n]-1448 I l^2 \[Omega] a[-4+n]-14240 I n \[Omega] a[-4+n]+1400 I l n \[Omega] a[-4+n]+1400 I l^2 n \[Omega] a[-4+n]+15168 I n^2 \[Omega] a[-4+n]-456 I l n^2 \[Omega] a[-4+n]-456 I l^2 n^2 \[Omega] a[-4+n]-6288 I n^3 \[Omega] a[-4+n]+48 I l n^3 \[Omega] a[-4+n]+48 I l^2 n^3 \[Omega] a[-4+n]+1120 I n^4 \[Omega] a[-4+n]-72 I n^5 \[Omega] a[-4+n]-120 l a[-3+n]-94 l^2 a[-3+n]+51 l^3 a[-3+n]+23 l^4 a[-3+n]-3 l^5 a[-3+n]-l^6 a[-3+n]-120 n a[-3+n]+180 l n a[-3+n]+165 l^2 n a[-3+n]-30 l^3 n a[-3+n]-15 l^4 n a[-3+n]+274 n^2 a[-3+n]-111 l n^2 a[-3+n]-108 l^2 n^2 a[-3+n]+6 l^3 n^2 a[-3+n]+3 l^4 n^2 a[-3+n]-225 n^3 a[-3+n]+30 l n^3 a[-3+n]+30 l^2 n^3 a[-3+n]+85 n^4 a[-3+n]-3 l n^4 a[-3+n]-3 l^2 n^4 a[-3+n]-15 n^5 a[-3+n]+n^6 a[-3+n]-480 I \[Omega] a[-3+n]+820 I l \[Omega] a[-3+n]+788 I l^2 \[Omega] a[-3+n]-64 I l^3 \[Omega] a[-3+n]-32 I l^4 \[Omega] a[-3+n]+3052 I n \[Omega] a[-3+n]-948 I l n \[Omega] a[-3+n]-936 I l^2 n \[Omega] a[-3+n]+24 I l^3 n \[Omega] a[-3+n]+12 I l^4 n \[Omega] a[-3+n]-4112 I n^2 \[Omega] a[-3+n]+372 I l n^2 \[Omega] a[-3+n]+372 I l^2 n^2 \[Omega] a[-3+n]+2108 I n^3 \[Omega] a[-3+n]-48 I l n^3 \[Omega] a[-3+n]-48 I l^2 n^3 \[Omega] a[-3+n]-460 I n^4 \[Omega] a[-3+n]+36 I n^5 \[Omega] a[-3+n]-320 \[Omega]^2 a[-3+n]+2016 n \[Omega]^2 a[-3+n]-1760 n^2 \[Omega]^2 a[-3+n]+512 n^3 \[Omega]^2 a[-3+n]-48 n^4 \[Omega]^2 a[-3+n]-96 I l \[Omega] a[-2+n]-84 I l^2 \[Omega] a[-2+n]+24 I l^3 \[Omega] a[-2+n]+12 I l^4 \[Omega] a[-2+n]-144 I n \[Omega] a[-2+n]+144 I l n \[Omega] a[-2+n]+138 I l^2 n \[Omega] a[-2+n]-12 I l^3 n \[Omega] a[-2+n]-6 I l^4 n \[Omega] a[-2+n]+300 I n^2 \[Omega] a[-2+n]-72 I l n^2 \[Omega] a[-2+n]-72 I l^2 n^2 \[Omega] a[-2+n]-210 I n^3 \[Omega] a[-2+n]+12 I l n^3 \[Omega] a[-2+n]+12 I l^2 n^3 \[Omega] a[-2+n]+60 I n^4 \[Omega] a[-2+n]-6 I n^5 \[Omega] a[-2+n]+96 \[Omega]^2 a[-2+n]-96 l \[Omega]^2 a[-2+n]-96 l^2 \[Omega]^2 a[-2+n]-928 n \[Omega]^2 a[-2+n]+104 l n \[Omega]^2 a[-2+n]+104 l^2 n \[Omega]^2 a[-2+n]+1064 n^2 \[Omega]^2 a[-2+n]-24 l n^2 \[Omega]^2 a[-2+n]-24 l^2 n^2 \[Omega]^2 a[-2+n]-400 n^3 \[Omega]^2 a[-2+n]+48 n^4 \[Omega]^2 a[-2+n]+24 l \[Omega]^2 a[-1+n]+24 l^2 \[Omega]^2 a[-1+n]+72 n \[Omega]^2 a[-1+n]-36 l n \[Omega]^2 a[-1+n]-36 l^2 n \[Omega]^2 a[-1+n]-132 n^2 \[Omega]^2 a[-1+n]+12 l n^2 \[Omega]^2 a[-1+n]+12 l^2 n^2 \[Omega]^2 a[-1+n]+72 n^3 \[Omega]^2 a[-1+n]-12 n^4 \[Omega]^2 a[-1+n]-96 I n \[Omega]^3 a[-1+n]+80 I n^2 \[Omega]^3 a[-1+n]-16 I n^3 \[Omega]^3 a[-1+n])+32 I (2-3 n+n^2) (2120-1809 n+537 n^2-67 n^3+3 n^4) b[-7+n]-8 I (2-n) (2 l (-394+301 n-75 n^2+6 n^3)+2 l^2 (-394+301 n-75 n^2+6 n^3)+3 (3128-6474 n+4341 n^2-1260 n^3+165 n^4-8 n^5)) b[-6+n]+4 I (2-n) (6894+l^3 (44-12 n)+l^4 (22-6 n)-36 n^5+2 l^2 (-782+682 n-195 n^2+18 n^3)+2 l (-793+685 n-195 n^2+18 n^3)+15 n^4 (43-4 I \[Omega])+n^3 (-4276+880 I \[Omega])+3 n^2 (4261-1456 I \[Omega])+n (-16530+8272 I \[Omega])-4564 I \[Omega]) b[-5+n]-2 I (2-n) (1842+l^3 (74-24 n)+l^4 (37-12 n)-24 n^5+5 n^4 (73-36 I \[Omega])+l^2 (-947+36 n^3+n^2 (-330+72 I \[Omega])+6 n (163-76 I \[Omega])+700 I \[Omega])+l (-984+36 n^3+n^2 (-330+72 I \[Omega])+6 n (165-76 I \[Omega])+700 I \[Omega])+n^2 (5127-9432 I \[Omega])+n (-5498+15168 I \[Omega])-7120 I \[Omega]+28 I n^3 (73 I+80 \[Omega])) b[-4+n]-I (2-n) (6 n^5+6 l^3 (-5+2 n+4 I \[Omega])+3 l^4 (-5+2 n+4 I \[Omega])+n^4 (-75+180 I \[Omega])-4 n^3 (-85+460 I \[Omega]+48 \[Omega]^2)+4 (-30+763 I \[Omega]+504 \[Omega]^2)+3 n^2 (-225+2108 I \[Omega]+512 \[Omega]^2)-4 n (-137+2056 I \[Omega]+880 \[Omega]^2)-6 l (-30+2 n^3+n (37-124 I \[Omega])+158 I \[Omega]+3 I n^2 (5 I+8 \[Omega]))-3 l^2 (-55+4 n^3+8 n (9-31 I \[Omega])+312 I \[Omega]+6 I n^2 (5 I+8 \[Omega]))) b[-3+n]-2 (2-n) \[Omega] (72+6 l^3+3 l^4+15 n^4+15 n^2 (21-40 I \[Omega])-464 I \[Omega]+24 I n^3 (5 I+4 \[Omega])+4 I n (75 I+266 \[Omega])-2 l (36+9 n^2-26 I \[Omega]+12 I n (3 I+\[Omega]))-l^2 (69+18 n^2-52 I \[Omega]+24 I n (3 I+\[Omega]))) b[-2+n]-4 I (2-n) (l (-9+6 n)+l^2 (-9+6 n)-2 (-9+6 n^3+n^2 (-27+6 I \[Omega])+n (33-20 I \[Omega])+12 I \[Omega])) \[Omega]^2 b[-1+n]-8 (-2+n) (2-6 n+3 n^2) \[Omega]^3 b[n]);

b[n_]:=b[n]=(1/(8 n \[Omega]^3))((16 I (-1+n) (40-13 n+n^2)^2 b[-7+n])/(-2+n)+(8 I (-3164+9384 n-9711 n^2+4341 n^3-945 n^4+99 n^5-4 n^6+l (858-788 n+301 n^2-50 n^3+3 n^4)+l^2 (858-788 n+301 n^2-50 n^3+3 n^4)) b[-6+n])/(2-3 n+n^2)+(1/(2-3 n+n^2))4 I (6 n^6+2 l^3 (53-22 n+3 n^2)+l^4 (53-22 n+3 n^2)+l (-1542+1586 n-685 n^2+130 n^3-9 n^4)+l^2 (-1489+1564 n-682 n^2+130 n^3-9 n^4)+n^4 (1069-220 I \[Omega])+4 (486-319 I \[Omega])+n^3 (-4261+1456 I \[Omega])+n^2 (8265-4136 I \[Omega])+n (-6894+4564 I \[Omega])+3 I n^5 (43 I+4 \[Omega])) b[-5+n]+(1/(2-3 n+n^2))2 I (-360+3 l^5+l^6-4 n^6+l^3 (-153+74 n-12 n^2)+l^4 (-74+37 n-6 n^2)+n^5 (73-36 I \[Omega])+l (822+9 n^4+n^3 (-110+24 I \[Omega])+3 n^2 (165-76 I \[Omega])+n (-984+700 I \[Omega])-724 I \[Omega])+l^2 (745+9 n^4+n^3 (-110+24 I \[Omega])+3 n^2 (163-76 I \[Omega])+n (-947+700 I \[Omega])-724 I \[Omega])+n^3 (1709-3144 I \[Omega])+2 n (921-3560 I \[Omega])+n^2 (-2749+7584 I \[Omega])+1644 I \[Omega]+7 I n^4 (73 I+80 \[Omega])) b[-4+n]-(1/(2-3 n+n^2))I (3 l^5+l^6-n^6+3 n^5 (5-12 I \[Omega])+l^4 (-23-3 n^2+3 n (5-4 I \[Omega])+32 I \[Omega])+l^3 (-51-6 n^2+6 n (5-4 I \[Omega])+64 I \[Omega])+160 \[Omega] (3 I+2 \[Omega])+n^3 (225-2108 I \[Omega]-512 \[Omega]^2)+n^4 (-85+460 I \[Omega]+48 \[Omega]^2)-4 n (-30+763 I \[Omega]+504 \[Omega]^2)+2 n^2 (-137+2056 I \[Omega]+880 \[Omega]^2)+l (3 n^4+20 (6-41 I \[Omega])+3 n^2 (37-124 I \[Omega])+n (-180+948 I \[Omega])+6 I n^3 (5 I+8 \[Omega]))+l^2 (94+3 n^4+12 n^2 (9-31 I \[Omega])+n (-165+936 I \[Omega])-788 I \[Omega]+6 I n^3 (5 I+8 \[Omega]))) b[-3+n]+(1/(2-3 n+n^2))2 \[Omega] (6 l^3 (-2+n)+3 l^4 (-2+n)+3 n^5+l^2 (-6 n^3+12 n^2 (3-I \[Omega])+6 (7-8 I \[Omega])+n (-69+52 I \[Omega]))+5 n^3 (21-40 I \[Omega])+8 n (9-58 I \[Omega])+n^2 (-150+532 I \[Omega])+48 I \[Omega]+6 I n^4 (5 I+4 \[Omega])-2 l (3 n^3+n (36-26 I \[Omega])+24 I (I+\[Omega])+6 I n^2 (3 I+\[Omega]))) b[-2+n]+(4 I (3 l (-1+n)+3 l^2 (-1+n)-(-3+n) n (-3+3 n+4 I \[Omega])) \[Omega]^2 b[-1+n])/(-1+n));

Do[a[i]=0;b[i]=0;,{i,-7,-1}];
b[0]=0;
b[1]=basis[[1]];
a[0]=b[1]/4;
a[1]=basis[[2]];
a[2]=basis[[3]];
b[2]=(I (1+l+l^2+4 I \[Omega]) b[1])/(2 \[Omega]);

Do[a[i];b[i];,{i,3,nmax}];

rs=r+2M Log[r/(2M)-1];
rsp=1/(1-2M/r);
rsp2=-((2 M)/(-2 M+r)^2);
rsp3=-((4 M)/(2 M-r)^3);
rsp4=-((12 M)/(-2 M+r)^4);
rsp5=-((48 M)/(2 M-r)^5);
rsp6=-((240 M)/(-2 M+r)^6);

E^(I rs \[Omega]) Sum[
{r^(2-i) (a[i]+b[i] Log[r]),
r^(1-i) ((2-i+I r rsp \[Omega]) a[i]+b[i] (1-(-2+i) Log[r]+I r rsp \[Omega] Log[r])),
r^-i ((2-3 i+i^2-2 I (-2+i) r rsp \[Omega]+I r^2 rsp2 \[Omega]-r^2 rsp^2 \[Omega]^2) a[i]+b[i] (3-2 i+2 Log[r]-3 i Log[r]+i^2 Log[r]+I r^2 rsp2 \[Omega] Log[r]-r^2 rsp^2 \[Omega]^2 Log[r]-2 I r rsp \[Omega] (-1+(-2+i) Log[r]))),
r^(-1-i) (-((2 i-3 i^2+i^3+3 I (-2+i) r^2 rsp2 \[Omega]-I r^3 rsp3 \[Omega]-3 (-2+i) r^2 rsp^2 \[Omega]^2+I r^3 rsp^3 \[Omega]^3-3 I r rsp \[Omega] (2-3 i+i^2+I r^2 rsp2 \[Omega])) a[i])+b[i] (2-6 i+3 i^2-2 i Log[r]+3 i^2 Log[r]-i^3 Log[r]+I r^3 rsp3 \[Omega] Log[r]-I r^3 rsp^3 \[Omega]^3 Log[r]-3 I r^2 rsp2 \[Omega] (-1+(-2+i) Log[r])+3 r^2 rsp^2 \[Omega]^2 (-1+(-2+i) Log[r])+3 I r rsp \[Omega] (3-2 i+(2-3 i+i^2) Log[r]+I r^2 rsp2 \[Omega] Log[r]))),
r^(-2-i) ((2 i-i^2-2 i^3+i^4+6 I (2-3 i+i^2) r^2 rsp2 \[Omega]+8 I r^3 rsp3 \[Omega]-4 I i r^3 rsp3 \[Omega]+I r^4 rsp4 \[Omega]-3 r^4 rsp2^2 \[Omega]^2+4 I (-2+i) r^3 rsp^3 \[Omega]^3+r^4 rsp^4 \[Omega]^4+6 r^2 rsp^2 \[Omega]^2 (-2+3 i-i^2-I r^2 rsp2 \[Omega])-4 r rsp \[Omega] (I i (2-3 i+i^2)-3 (-2+i) r^2 rsp2 \[Omega]+r^3 rsp3 \[Omega])) a[i]+b[i] (-2+2 i+6 i^2-4 i^3+4 I r^3 rsp3 \[Omega]+2 i Log[r]-i^2 Log[r]-2 i^3 Log[r]+i^4 Log[r]+8 I r^3 rsp3 \[Omega] Log[r]-4 I i r^3 rsp3 \[Omega] Log[r]+I r^4 rsp4 \[Omega] Log[r]-3 r^4 rsp2^2 \[Omega]^2 Log[r]+r^4 rsp^4 \[Omega]^4 Log[r]+4 I r^3 rsp^3 \[Omega]^3 (-1+(-2+i) Log[r])+6 I r^2 rsp2 \[Omega] (3-2 i+(2-3 i+i^2) Log[r])+6 r^2 rsp^2 \[Omega]^2 (-3+2 i-(2-3 i+i^2) Log[r]-I r^2 rsp2 \[Omega] Log[r])-4 r rsp \[Omega] (3 r^2 rsp2 \[Omega] (1-(-2+i) Log[r])+I (-2+6 i-3 i^2+i (2-3 i+i^2) Log[r]-I r^3 rsp3 \[Omega] Log[r])))),
r^(-3-i) (-((4 i-5 i^3+i^5-20 I r^3 rsp3 \[Omega]+30 I i r^3 rsp3 \[Omega]-10 I i^2 r^3 rsp3 \[Omega]-10 I r^4 rsp4 \[Omega]+5 I i r^4 rsp4 \[Omega]-I r^5 rsp5 \[Omega]-15 (-2+i) r^4 rsp2^2 \[Omega]^2+5 (-2+i) r^4 rsp^4 \[Omega]^4-I r^5 rsp^5 \[Omega]^5+10 I r^3 rsp^3 \[Omega]^3 (2-3 i+i^2+I r^2 rsp2 \[Omega])-10 r^2 rsp^2 \[Omega]^2 (i (2-3 i+i^2)+3 I (-2+i) r^2 rsp2 \[Omega]-I r^3 rsp3 \[Omega])+10 r^2 rsp2 \[Omega] (I i (2-3 i+i^2)+r^3 rsp3 \[Omega])+5 r rsp \[Omega] (-I i (2-i-2 i^2+i^3)+6 (2-3 i+i^2) r^2 rsp2 \[Omega]-4 (-2+i) r^3 rsp3 \[Omega]+r^4 rsp4 \[Omega]+3 I r^4 rsp2^2 \[Omega]^2)) a[i])-b[i] (-4+15 i^2-5 i^4-30 I r^3 rsp3 \[Omega]+20 I i r^3 rsp3 \[Omega]-5 I r^4 rsp4 \[Omega]+4 i Log[r]-5 i^3 Log[r]+i^5 Log[r]-20 I r^3 rsp3 \[Omega] Log[r]+30 I i r^3 rsp3 \[Omega] Log[r]-10 I i^2 r^3 rsp3 \[Omega] Log[r]-10 I r^4 rsp4 \[Omega] Log[r]+5 I i r^4 rsp4 \[Omega] Log[r]-I r^5 rsp5 \[Omega] Log[r]-I r^5 rsp^5 \[Omega]^5 Log[r]-15 r^4 rsp2^2 \[Omega]^2 (-1+(-2+i) Log[r])+5 r^4 rsp^4 \[Omega]^4 (-1+(-2+i) Log[r])+10 I r^3 rsp^3 \[Omega]^3 (3-2 i+(2-3 i+i^2) Log[r]+I r^2 rsp2 \[Omega] Log[r])+10 I r^2 rsp2 \[Omega] (-2+6 i-3 i^2+i (2-3 i+i^2) Log[r]-I r^3 rsp3 \[Omega] Log[r])+10 r^2 rsp^2 \[Omega]^2 (2-6 i+3 i^2-2 i Log[r]+3 i^2 Log[r]-i^3 Log[r]+I r^3 rsp3 \[Omega] Log[r]-3 I r^2 rsp2 \[Omega] (-1+(-2+i) Log[r]))+5 r rsp \[Omega] (3 I r^4 rsp2^2 \[Omega]^2 Log[r]+6 r^2 rsp2 \[Omega] (3-2 i+(2-3 i+i^2) Log[r])-I (-2+2 i+6 i^2-4 i^3+2 i Log[r]-i^2 Log[r]-2 i^3 Log[r]+i^4 Log[r]+I r^4 rsp4 \[Omega] Log[r]-4 I r^3 rsp3 \[Omega] (-1+(-2+i) Log[r]))))),
r^(-4-i) ((12 i+4 i^2-15 i^3-5 i^4+3 i^5+i^6-40 I i r^3 rsp3 \[Omega]+60 I i^2 r^3 rsp3 \[Omega]-20 I i^3 r^3 rsp3 \[Omega]+30 I r^4 rsp4 \[Omega]-45 I i r^4 rsp4 \[Omega]+15 I i^2 r^4 rsp4 \[Omega]+12 I r^5 rsp5 \[Omega]-6 I i r^5 rsp5 \[Omega]+I r^6 rsp6 \[Omega]-45 (2-3 i+i^2) r^4 rsp2^2 \[Omega]^2-10 r^6 rsp3^2 \[Omega]^2-15 I r^6 rsp2^3 \[Omega]^3-6 I (-2+i) r^5 rsp^5 \[Omega]^5-r^6 rsp^6 \[Omega]^6+15 r^4 rsp^4 \[Omega]^4 (2-3 i+i^2+I r^2 rsp2 \[Omega])+20 r^3 rsp^3 \[Omega]^3 (I i (2-3 i+i^2)-3 (-2+i) r^2 rsp2 \[Omega]+r^3 rsp3 \[Omega])-15 r^2 rsp2 \[Omega] (-I i (2-i-2 i^2+i^3)-4 (-2+i) r^3 rsp3 \[Omega]+r^4 rsp4 \[Omega])-15 r^2 rsp^2 \[Omega]^2 (2 i-i^2-2 i^3+i^4+6 I (2-3 i+i^2) r^2 rsp2 \[Omega]-4 I (-2+i) r^3 rsp3 \[Omega]+I r^4 rsp4 \[Omega]-3 r^4 rsp2^2 \[Omega]^2)+6 r rsp \[Omega] (-4 I i+5 I i^3-I i^5-10 (2-3 i+i^2) r^3 rsp3 \[Omega]-10 r^4 rsp4 \[Omega]+5 i r^4 rsp4 \[Omega]-r^5 rsp5 \[Omega]+15 I (-2+i) r^4 rsp2^2 \[Omega]^2+10 r^2 rsp2 \[Omega] (i (2-3 i+i^2)-I r^3 rsp3 \[Omega]))) a[i]+b[i] (-12-8 i+45 i^2+20 i^3-15 i^4-6 i^5+40 I r^3 rsp3 \[Omega]-120 I i r^3 rsp3 \[Omega]+60 I i^2 r^3 rsp3 \[Omega]+45 I r^4 rsp4 \[Omega]-30 I i r^4 rsp4 \[Omega]+6 I r^5 rsp5 \[Omega]+12 i Log[r]+4 i^2 Log[r]-15 i^3 Log[r]-5 i^4 Log[r]+3 i^5 Log[r]+i^6 Log[r]-40 I i r^3 rsp3 \[Omega] Log[r]+60 I i^2 r^3 rsp3 \[Omega] Log[r]-20 I i^3 r^3 rsp3 \[Omega] Log[r]+30 I r^4 rsp4 \[Omega] Log[r]-45 I i r^4 rsp4 \[Omega] Log[r]+15 I i^2 r^4 rsp4 \[Omega] Log[r]+12 I r^5 rsp5 \[Omega] Log[r]-6 I i r^5 rsp5 \[Omega] Log[r]+I r^6 rsp6 \[Omega] Log[r]-10 r^6 rsp3^2 \[Omega]^2 Log[r]-15 I r^6 rsp2^3 \[Omega]^3 Log[r]-r^6 rsp^6 \[Omega]^6 Log[r]-6 I r^5 rsp^5 \[Omega]^5 (-1+(-2+i) Log[r])-45 r^4 rsp2^2 \[Omega]^2 (3-2 i+(2-3 i+i^2) Log[r])+15 r^4 rsp^4 \[Omega]^4 (3-2 i+(2-3 i+i^2) Log[r]+I r^2 rsp2 \[Omega] Log[r])+15 I r^2 rsp2 \[Omega] (-2+2 i+6 i^2-4 i^3+2 i Log[r]-i^2 Log[r]-2 i^3 Log[r]+i^4 Log[r]+I r^4 rsp4 \[Omega] Log[r]-4 I r^3 rsp3 \[Omega] (-1+(-2+i) Log[r]))+15 r^2 rsp^2 \[Omega]^2 (2-2 i-6 i^2+4 i^3-2 i Log[r]+i^2 Log[r]+2 i^3 Log[r]-i^4 Log[r]-I r^4 rsp4 \[Omega] Log[r]+3 r^4 rsp2^2 \[Omega]^2 Log[r]+4 I r^3 rsp3 \[Omega] (-1+(-2+i) Log[r])-6 I r^2 rsp2 \[Omega] (3-2 i+(2-3 i+i^2) Log[r]))+20 r^3 rsp^3 \[Omega]^3 (3 r^2 rsp2 \[Omega] (1-(-2+i) Log[r])+I (-2+6 i-3 i^2+i (2-3 i+i^2) Log[r]-I r^3 rsp3 \[Omega] Log[r]))+6 r rsp \[Omega] (4 I-15 I i^2+5 I i^4-5 r^4 rsp4 \[Omega]-4 I i Log[r]+5 I i^3 Log[r]-I i^5 Log[r]-10 r^4 rsp4 \[Omega] Log[r]+5 i r^4 rsp4 \[Omega] Log[r]-r^5 rsp5 \[Omega] Log[r]+15 I r^4 rsp2^2 \[Omega]^2 (-1+(-2+i) Log[r])-10 r^3 rsp3 \[Omega] (3-2 i+(2-3 i+i^2) Log[r])+10 r^2 rsp2 \[Omega] (-2+6 i-3 i^2+i (2-3 i+i^2) Log[r]-I r^3 rsp3 \[Omega] Log[r]))))},{i,0,nmax}]
];


(* ::Input::Initialization:: *)
InnerBC\[Chi]1[l_,\[Omega]_,nmax_,r_]:=InnerBC\[Chi]1[l,\[Omega],nmax,r,{0,0,1}];


(* ::Input::Initialization:: *)
InnerBC\[Chi]1[l_,\[Omega]_,nmax_,r_,basis_]:=Module[{M=1,b,c,n,rs,rsp,rsp2,rsp3,rsp4,rsp5,rsp6,rsp7},
c[n_]:=c[n]=(1/((-1+n)^2 n (-1+n-4 I \[Omega])^2 (n-4 I \[Omega])))(-n^2 (28-11 n+n^2)^2 c[-8+n]-(324+324 n-4591 n^2+3724 n^3-1155 n^4+158 n^5-8 n^6+l (-324+324 n-169 n^2+38 n^3-3 n^4)+l^2 (-324+324 n-169 n^2+38 n^3-3 n^4)) c[-7+n]-(-1224+28 n^6+l^4 (34-16 n+3 n^2)+l^3 (68-32 n+6 n^2)+6 l (215-246 n+138 n^2-34 n^3+3 n^4)+l^2 (1324-1492 n+831 n^2-204 n^3+18 n^4)+n^5 (-490-12 I \[Omega])+n^4 (3219+160 I \[Omega])+n^3 (-9532-696 I \[Omega])+n^2 (11311+968 I \[Omega])-400 I \[Omega]+4 I n (391 I+40 \[Omega])) c[-6+n]-(-3 l^5-l^6-56 n^6+l^3 (-207+116 n-24 n^2)-2 l^4 (53-29 n+6 n^2)+4 n (764-29 I \[Omega])+n^5 (854+72 I \[Omega])+l (-2036-45 n^4+6 n^3 (75+4 I \[Omega])+4 n (674+79 I \[Omega])+n^2 (-1647-156 I \[Omega])-228 I \[Omega])+l^2 (-2139-45 n^4+6 n^3 (75+4 I \[Omega])+n^2 (-1659-156 I \[Omega])+n (2754+316 I \[Omega])-228 I \[Omega])+4 (437+417 I \[Omega])+4 n^3 (3341+822 I \[Omega])+n^4 (-4971-840 I \[Omega])+n^2 (-15131-4396 I \[Omega])) c[-5+n]-(6 l^5+2 l^6+70 n^6+4 l^3 (57+9 n^2+n (-39-6 I \[Omega])+10 I \[Omega])+l^4 (119+18 n^2+n (-78-12 I \[Omega])+20 I \[Omega])+n^5 (-910-180 I \[Omega])+2 l (801+30 n^4+n^3 (-260-48 I \[Omega])+4 n^2 (211+69 I \[Omega])+n (-1246-512 I \[Omega])+336 I \[Omega])+l^2 (1715+60 n^4+n^3 (-520-96 I \[Omega])+2 n^2 (853+276 I \[Omega])+n (-2570-1036 I \[Omega])+692 I \[Omega])+n^2 (11795+7928 I \[Omega]-512 \[Omega]^2)+n^4 (4605+1800 I \[Omega]-48 \[Omega]^2)+20 n^3 (-553-312 I \[Omega]+16 \[Omega]^2)-4 n (766+207 I \[Omega]+40 \[Omega]^2)+4 (-284-605 I \[Omega]+100 \[Omega]^2)) c[-4+n]-(-3 l^5-l^6-56 n^6+l^3 (-107-24 n^2+n (92+48 I \[Omega])-80 I \[Omega])+n^5 (602+240 I \[Omega])-2 l^4 (28-23 n+6 n^2+20 I \[Omega]-12 I n \[Omega])+n^3 (5396+6000 I \[Omega]-1088 \[Omega]^2)+20 (15+71 I \[Omega]-48 \[Omega]^2)+4 n (409+396 I \[Omega]+20 \[Omega]^2)+n^4 (-2577-2000 I \[Omega]+192 \[Omega]^2)+n^2 (-5309-7112 I \[Omega]+1648 \[Omega]^2)+l (-642-45 n^4+6 n^3 (55+24 I \[Omega])-700 I \[Omega]+32 \[Omega]^2-16 n (-75-75 I \[Omega]+7 \[Omega]^2)+n^2 (-927-720 I \[Omega]+48 \[Omega]^2))+l^2 (-695-45 n^4+6 n^3 (55+24 I \[Omega])-740 I \[Omega]+32 \[Omega]^2+n^2 (-939-720 I \[Omega]+48 \[Omega]^2)-2 n (-623-612 I \[Omega]+56 \[Omega]^2))) c[-3+n]-(28 n^6+2 l^3 (9+3 n^2+n (-10-12 I \[Omega])+20 I \[Omega])+l^4 (9+3 n^2+n (-10-12 I \[Omega])+20 I \[Omega])+n^5 (-238-180 I \[Omega])+n^4 (825+1200 I \[Omega]-288 \[Omega]^2)+4 n (-107-256 I \[Omega]+88 \[Omega]^2-16 I \[Omega]^3)+4 n^3 (-361-750 I \[Omega]+336 \[Omega]^2+16 I \[Omega]^3)+4 (-2-63 I \[Omega]+148 \[Omega]^2+32 I \[Omega]^3)+n^2 (1261+3208 I \[Omega]-1872 \[Omega]^2-128 I \[Omega]^3)+2 l (58+9 n^4+n^3 (-54-48 I \[Omega])+148 I \[Omega]-48 \[Omega]^2-6 n^2 (-21-34 I \[Omega]+8 \[Omega]^2)+8 n (-17-37 I \[Omega]+14 \[Omega]^2))+l^2 (125+18 n^4+n^3 (-108-96 I \[Omega])+316 I \[Omega]-96 \[Omega]^2+n^2 (255+408 I \[Omega]-96 \[Omega]^2)+n (-282-604 I \[Omega]+224 \[Omega]^2))) c[-2+n]+(-1+n) (-1+n-4 I \[Omega]) (4+8 n^4+l (6+3 n^2+n (-8-12 I \[Omega])+16 I \[Omega])+l^2 (6+3 n^2+n (-8-12 I \[Omega])+16 I \[Omega])+n^3 (-34-40 I \[Omega])+32 \[Omega]^2+n^2 (53+112 I \[Omega]-32 \[Omega]^2)+4 n (-8-21 I \[Omega]+8 \[Omega]^2)) c[-1+n]);

b[n_]:=b[n]=(1/((-1+n)^2 n (-1+n-4 I \[Omega])^2 (n-4 I \[Omega])))(-n^2 (28-11 n+n^2)^2 b[-8+n]-(324+324 n-4591 n^2+3724 n^3-1155 n^4+158 n^5-8 n^6+l (-324+324 n-169 n^2+38 n^3-3 n^4)+l^2 (-324+324 n-169 n^2+38 n^3-3 n^4)) b[-7+n]-(-1224+28 n^6+l^4 (34-16 n+3 n^2)+l^3 (68-32 n+6 n^2)+6 l (215-246 n+138 n^2-34 n^3+3 n^4)+l^2 (1324-1492 n+831 n^2-204 n^3+18 n^4)+n^5 (-490-12 I \[Omega])+n^4 (3219+160 I \[Omega])+n^3 (-9532-696 I \[Omega])+n^2 (11311+968 I \[Omega])-400 I \[Omega]+4 I n (391 I+40 \[Omega])) b[-6+n]-(-3 l^5-l^6-56 n^6+l^3 (-207+116 n-24 n^2)-2 l^4 (53-29 n+6 n^2)+4 n (764-29 I \[Omega])+n^5 (854+72 I \[Omega])+l (-2036-45 n^4+6 n^3 (75+4 I \[Omega])+4 n (674+79 I \[Omega])+n^2 (-1647-156 I \[Omega])-228 I \[Omega])+l^2 (-2139-45 n^4+6 n^3 (75+4 I \[Omega])+n^2 (-1659-156 I \[Omega])+n (2754+316 I \[Omega])-228 I \[Omega])+4 (437+417 I \[Omega])+4 n^3 (3341+822 I \[Omega])+n^4 (-4971-840 I \[Omega])+n^2 (-15131-4396 I \[Omega])) b[-5+n]-(6 l^5+2 l^6+70 n^6+4 l^3 (57+9 n^2+n (-39-6 I \[Omega])+10 I \[Omega])+l^4 (119+18 n^2+n (-78-12 I \[Omega])+20 I \[Omega])+n^5 (-910-180 I \[Omega])+2 l (801+30 n^4+n^3 (-260-48 I \[Omega])+4 n^2 (211+69 I \[Omega])+n (-1246-512 I \[Omega])+336 I \[Omega])+l^2 (1715+60 n^4+n^3 (-520-96 I \[Omega])+2 n^2 (853+276 I \[Omega])+n (-2570-1036 I \[Omega])+692 I \[Omega])+n^2 (11795+7928 I \[Omega]-512 \[Omega]^2)+n^4 (4605+1800 I \[Omega]-48 \[Omega]^2)+20 n^3 (-553-312 I \[Omega]+16 \[Omega]^2)-4 n (766+207 I \[Omega]+40 \[Omega]^2)+4 (-284-605 I \[Omega]+100 \[Omega]^2)) b[-4+n]-(-3 l^5-l^6-56 n^6+l^3 (-107-24 n^2+n (92+48 I \[Omega])-80 I \[Omega])+n^5 (602+240 I \[Omega])-2 l^4 (28-23 n+6 n^2+20 I \[Omega]-12 I n \[Omega])+n^3 (5396+6000 I \[Omega]-1088 \[Omega]^2)+20 (15+71 I \[Omega]-48 \[Omega]^2)+4 n (409+396 I \[Omega]+20 \[Omega]^2)+n^4 (-2577-2000 I \[Omega]+192 \[Omega]^2)+n^2 (-5309-7112 I \[Omega]+1648 \[Omega]^2)+l (-642-45 n^4+6 n^3 (55+24 I \[Omega])-700 I \[Omega]+32 \[Omega]^2-16 n (-75-75 I \[Omega]+7 \[Omega]^2)+n^2 (-927-720 I \[Omega]+48 \[Omega]^2))+l^2 (-695-45 n^4+6 n^3 (55+24 I \[Omega])-740 I \[Omega]+32 \[Omega]^2+n^2 (-939-720 I \[Omega]+48 \[Omega]^2)-2 n (-623-612 I \[Omega]+56 \[Omega]^2))) b[-3+n]-(28 n^6+2 l^3 (9+3 n^2+n (-10-12 I \[Omega])+20 I \[Omega])+l^4 (9+3 n^2+n (-10-12 I \[Omega])+20 I \[Omega])+n^5 (-238-180 I \[Omega])+n^4 (825+1200 I \[Omega]-288 \[Omega]^2)+4 n (-107-256 I \[Omega]+88 \[Omega]^2-16 I \[Omega]^3)+4 n^3 (-361-750 I \[Omega]+336 \[Omega]^2+16 I \[Omega]^3)+4 (-2-63 I \[Omega]+148 \[Omega]^2+32 I \[Omega]^3)+n^2 (1261+3208 I \[Omega]-1872 \[Omega]^2-128 I \[Omega]^3)+2 l (58+9 n^4+n^3 (-54-48 I \[Omega])+148 I \[Omega]-48 \[Omega]^2-6 n^2 (-21-34 I \[Omega]+8 \[Omega]^2)+8 n (-17-37 I \[Omega]+14 \[Omega]^2))+l^2 (125+18 n^4+n^3 (-108-96 I \[Omega])+316 I \[Omega]-96 \[Omega]^2+n^2 (255+408 I \[Omega]-96 \[Omega]^2)+n (-282-604 I \[Omega]+224 \[Omega]^2))) b[-2+n]+(-1+n) (-1+n-4 I \[Omega]) (4+8 n^4+l (6+3 n^2+n (-8-12 I \[Omega])+16 I \[Omega])+l^2 (6+3 n^2+n (-8-12 I \[Omega])+16 I \[Omega])+n^3 (-34-40 I \[Omega])+32 \[Omega]^2+n^2 (53+112 I \[Omega]-32 \[Omega]^2)+4 n (-8-21 I \[Omega]+8 \[Omega]^2)) b[-1+n]-2 n (784-924 n+354 n^2-55 n^3+3 n^4) c[-8+n]+2 (-162+4591 n-5586 n^2+2310 n^3-395 n^4+24 n^5+l (-162+169 n-57 n^2+6 n^3)+l^2 (-162+169 n-57 n^2+6 n^3)) c[-7+n]-2 (-782+84 n^5+2 l^3 (-8+3 n)+l^4 (-8+3 n)+18 l (-41+46 n-17 n^2+2 n^3)+l^2 (-746+831 n-306 n^2+36 n^3)+n^4 (-1225-30 I \[Omega])+n^3 (6438+320 I \[Omega])+n (11311+968 I \[Omega])+n^2 (-14298-1044 I \[Omega])+80 I \[Omega]) c[-6+n]+2 (-1528+168 n^5+l^4 (-29+12 n)+l^3 (-58+24 n)+l (-1348+90 n^3+n^2 (-675-36 I \[Omega])+3 n (549+52 I \[Omega])-158 I \[Omega])+l^2 (-1377+90 n^3+n^2 (-675-36 I \[Omega])+3 n (553+52 I \[Omega])-158 I \[Omega])+n^4 (-2135-180 I \[Omega])+6 n^3 (1657+280 I \[Omega])+n (15131+4396 I \[Omega])+n^2 (-20046-4932 I \[Omega])+58 I \[Omega]) c[-5+n]-2 (210 n^5+6 l^3 (-13+6 n-2 I \[Omega])+3 l^4 (-13+6 n-2 I \[Omega])+2 l (-623+60 n^3+4 n (211+69 I \[Omega])+n^2 (-390-72 I \[Omega])-256 I \[Omega])+n^4 (-2275-450 I \[Omega])+l^2 (-1285+120 n^3+n^2 (-780-144 I \[Omega])+2 n (853+276 I \[Omega])-518 I \[Omega])+n (11795+7928 I \[Omega]-512 \[Omega]^2)+n^3 (9210+3600 I \[Omega]-96 \[Omega]^2)+30 n^2 (-553-312 I \[Omega]+16 \[Omega]^2)-2 (766+207 I \[Omega]+40 \[Omega]^2)) c[-4+n]+2 (168 n^5+l^4 (-23+12 n-12 I \[Omega])+l^3 (-46+24 n-24 I \[Omega])+n^4 (-1505-600 I \[Omega])+n (5309+7112 I \[Omega]-1648 \[Omega]^2)+n^3 (5154+4000 I \[Omega]-384 \[Omega]^2)-2 (409+396 I \[Omega]+20 \[Omega]^2)+6 n^2 (-1349-1500 I \[Omega]+272 \[Omega]^2)+l^2 (-623+90 n^3+n^2 (-495-216 I \[Omega])-612 I \[Omega]+56 \[Omega]^2+n (939+720 I \[Omega]-48 \[Omega]^2))+l (90 n^3+n^2 (-495-216 I \[Omega])+n (927+720 I \[Omega]-48 \[Omega]^2)+8 (-75-75 I \[Omega]+7 \[Omega]^2))) c[-3+n]-2 (-214+84 n^5+2 l^3 (-5+3 n-6 I \[Omega])+l^4 (-5+3 n-6 I \[Omega])+n^4 (-595-450 I \[Omega])-512 I \[Omega]+176 \[Omega]^2-32 I \[Omega]^3-6 n^3 (-275-400 I \[Omega]+96 \[Omega]^2)+6 n^2 (-361-750 I \[Omega]+336 \[Omega]^2+16 I \[Omega]^3)+n (1261+3208 I \[Omega]-1872 \[Omega]^2-128 I \[Omega]^3)+l^2 (-141+36 n^3-302 I \[Omega]+112 \[Omega]^2-18 I n^2 (-9 I+8 \[Omega])+n (255+408 I \[Omega]-96 \[Omega]^2))+2 l (-68+18 n^3+n^2 (-81-72 I \[Omega])-148 I \[Omega]+56 \[Omega]^2-6 n (-21-34 I \[Omega]+8 \[Omega]^2))) c[-2+n]+2 (24 n^5+n^4 (-125-180 I \[Omega])+n^3 (258+720 I \[Omega]-384 \[Omega]^2)+2 (-10-57 I \[Omega]+76 \[Omega]^2)+6 n^2 (-43-174 I \[Omega]+176 \[Omega]^2+32 I \[Omega]^3)+n (121+620 I \[Omega]-848 \[Omega]^2-256 I \[Omega]^3)+l (-10+6 n^3+n^2 (-21-36 I \[Omega])-50 I \[Omega]+56 \[Omega]^2+n (25+84 I \[Omega]-48 \[Omega]^2))+l^2 (-10+6 n^3+n^2 (-21-36 I \[Omega])-50 I \[Omega]+56 \[Omega]^2+n (25+84 I \[Omega]-48 \[Omega]^2))) c[-1+n]-2 (-1+n) (3 n^4+n^3 (-7-30 I \[Omega])-2 I (I-4 \[Omega])^2 \[Omega]+n^2 (5+50 I \[Omega]-96 \[Omega]^2)+n (-1-22 I \[Omega]+96 \[Omega]^2+96 I \[Omega]^3)) c[n]);

Do[c[i]=0;b[i]=0;,{i,-6,-1}];
b[0]=basis[[1]];
b[1]=basis[[2]];
c[0]=0;
c[1]=basis[[3]];

Do[c[i];b[i];,{i,2,nmax}];


rs=r+2M Log[r/(2M)-1];
rsp=1/(1-2M/r);
rsp2=-((2 M)/(-2 M+r)^2);
rsp3=-((4 M)/(2 M-r)^3);
rsp4=-((12 M)/(-2 M+r)^4);
rsp5=-((48 M)/(2 M-r)^5);
rsp6=-((240 M)/(-2 M+r)^6);
rsp7=-((1440 M)/(2 M-r)^7);

E^(-I rs \[Omega]) Sum[
{rsp^-i (b[i]+c[i] Log[1/rsp]),
rsp^(-1-i) ((-i rsp2-I rsp^2 \[Omega]) b[i]+c[i] (-I rsp^2 \[Omega] Log[1/rsp]-rsp2 (1+i Log[1/rsp]))),
rsp^(-2-i) ((i (1+i) rsp2^2-rsp^2 \[Omega] (I rsp2+rsp^2 \[Omega])+rsp (-i rsp3+2 I i rsp rsp2 \[Omega])) b[i]+c[i] (-rsp^2 \[Omega] (I rsp2+rsp^2 \[Omega]) Log[1/rsp]+I rsp (I rsp3+2 rsp rsp2 \[Omega]) (1+i Log[1/rsp])+rsp2^2 (1+2 i+i (1+i) Log[1/rsp]))),
rsp^(-3-i) ((-i (2+3 i+i^2) rsp2^3+3 i (1+i) rsp rsp2 (rsp3-I rsp rsp2 \[Omega])+I rsp^3 \[Omega] (-rsp3+3 I rsp rsp2 \[Omega]+rsp^3 \[Omega]^2)+i rsp^2 (-rsp4+3 I rsp2^2 \[Omega]+3 I rsp rsp3 \[Omega]+3 rsp^2 rsp2 \[Omega]^2)) b[i]+c[i] (I rsp^3 \[Omega] (-rsp3+3 I rsp rsp2 \[Omega]+rsp^3 \[Omega]^2) Log[1/rsp]+rsp^2 (-rsp4+3 I rsp2^2 \[Omega]+3 I rsp rsp3 \[Omega]+3 rsp^2 rsp2 \[Omega]^2) (1+i Log[1/rsp])+3 rsp rsp2 (rsp3-I rsp rsp2 \[Omega]) (1+2 i+i (1+i) Log[1/rsp])-rsp2^3 (2+6 i+3 i^2+i (2+3 i+i^2) Log[1/rsp]))),
rsp^(-4-i) ((i (6+11 i+6 i^2+i^3) rsp2^4+2 I i (2+3 i+i^2) rsp rsp2^2 (3 I rsp3+2 rsp rsp2 \[Omega])-i (1+i) rsp^2 (-3 rsp3^2-4 rsp2 rsp4+6 I rsp2^3 \[Omega]+12 I rsp rsp2 rsp3 \[Omega]+6 rsp^2 rsp2^2 \[Omega]^2)+rsp^4 \[Omega] (-I rsp4-3 rsp2^2 \[Omega]-4 rsp rsp3 \[Omega]+6 I rsp^2 rsp2 \[Omega]^2+rsp^4 \[Omega]^3)+i rsp^3 (-rsp5+10 I rsp2 rsp3 \[Omega]+6 rsp^2 rsp3 \[Omega]^2-4 I rsp^3 rsp2 \[Omega]^3+4 rsp \[Omega] (I rsp4+3 rsp2^2 \[Omega]))) b[i]+c[i] (rsp^4 \[Omega] (-I rsp4-3 rsp2^2 \[Omega]-4 rsp rsp3 \[Omega]+6 I rsp^2 rsp2 \[Omega]^2+rsp^4 \[Omega]^3) Log[1/rsp]+rsp^3 (-rsp5+10 I rsp2 rsp3 \[Omega]+6 rsp^2 rsp3 \[Omega]^2-4 I rsp^3 rsp2 \[Omega]^3+4 rsp \[Omega] (I rsp4+3 rsp2^2 \[Omega])) (1+i Log[1/rsp])-rsp^2 (-3 rsp3^2-4 rsp2 rsp4+6 I rsp2^3 \[Omega]+12 I rsp rsp2 rsp3 \[Omega]+6 rsp^2 rsp2^2 \[Omega]^2) (1+2 i+i (1+i) Log[1/rsp])+2 I rsp rsp2^2 (3 I rsp3+2 rsp rsp2 \[Omega]) (2+6 i+3 i^2+i (2+3 i+i^2) Log[1/rsp])+rsp2^4 (6+22 i+18 i^2+4 i^3+i (6+11 i+6 i^2+i^3) Log[1/rsp]))),
rsp^(-5-i) (-i ((24+50 i+35 i^2+10 i^3+i^4) rsp2^5-10 (6+11 i+6 i^2+i^3) rsp rsp2^3 rsp3+10 (2+3 i+i^2) rsp^2 rsp2^2 rsp4+5 (1+i) rsp^2 rsp2 (3 (2+i) rsp3^2-rsp rsp5)+rsp^3 (-10 (1+i) rsp3 rsp4+rsp rsp6)) (b[i]+c[i] Log[1/rsp])-5 I i ((6+11 i+6 i^2+i^3) rsp2^4-6 (2+3 i+i^2) rsp rsp2^2 rsp3+4 (1+i) rsp^2 rsp2 rsp4+rsp^2 (3 (1+i) rsp3^2-rsp rsp5)) (rsp^2 \[Omega] b[i]+c[i] (-I rsp2+rsp^2 \[Omega] Log[1/rsp]))+10 i ((2+3 i+i^2) rsp2^3-3 (1+i) rsp rsp2 rsp3+rsp^2 rsp4) (rsp^2 \[Omega] (I rsp2+rsp^2 \[Omega]) b[i]+c[i] (-rsp2^2+rsp (rsp3-2 I rsp rsp2 \[Omega])+rsp^2 \[Omega] (I rsp2+rsp^2 \[Omega]) Log[1/rsp]))-10 i ((1+i) rsp2^2-rsp rsp3) (rsp^3 \[Omega] (I rsp3+3 rsp rsp2 \[Omega]-I rsp^3 \[Omega]^2) b[i]+c[i] (2 rsp2^3+3 I rsp rsp2 (I rsp3+rsp rsp2 \[Omega])+rsp^2 (rsp4-3 I rsp2^2 \[Omega]-3 I rsp rsp3 \[Omega]-3 rsp^2 rsp2 \[Omega]^2)+rsp^3 \[Omega] (I rsp3+3 rsp rsp2 \[Omega]-I rsp^3 \[Omega]^2) Log[1/rsp]))-5 i rsp2 (rsp^4 \[Omega] (-I rsp4-3 rsp2^2 \[Omega]-4 rsp rsp3 \[Omega]+6 I rsp^2 rsp2 \[Omega]^2+rsp^4 \[Omega]^3) b[i]+c[i] (6 rsp2^4+4 rsp rsp2^2 (-3 rsp3+2 I rsp rsp2 \[Omega])+rsp^2 (3 rsp3^2+4 rsp2 rsp4-6 I rsp2^3 \[Omega]-12 I rsp rsp2 rsp3 \[Omega]-6 rsp^2 rsp2^2 \[Omega]^2)+rsp^3 (-rsp5+10 I rsp2 rsp3 \[Omega]+6 rsp^2 rsp3 \[Omega]^2-4 I rsp^3 rsp2 \[Omega]^3+4 rsp \[Omega] (I rsp4+3 rsp2^2 \[Omega]))+rsp^4 \[Omega] (-I rsp4-3 rsp2^2 \[Omega]-4 rsp rsp3 \[Omega]+6 I rsp^2 rsp2 \[Omega]^2+rsp^4 \[Omega]^3) Log[1/rsp]))-I (rsp^5 \[Omega] (rsp5-10 I rsp2 rsp3 \[Omega]-10 rsp^2 rsp3 \[Omega]^2+10 I rsp^3 rsp2 \[Omega]^3+rsp^5 \[Omega]^4-5 rsp \[Omega] (I rsp4+3 rsp2^2 \[Omega])) b[i]+c[i] (-24 I rsp2^5+30 rsp rsp2^3 (2 I rsp3+rsp rsp2 \[Omega])+10 I rsp^2 rsp2 (-3 rsp3^2-2 rsp2 rsp4+2 I rsp2^3 \[Omega]+6 I rsp rsp2 rsp3 \[Omega]+2 rsp^2 rsp2^2 \[Omega]^2)-5 rsp^3 (-2 I rsp3 rsp4-2 rsp2^2 rsp3 \[Omega]+6 I rsp^2 rsp2 rsp3 \[Omega]^2+2 rsp^3 rsp2^2 \[Omega]^3+rsp \[Omega] (-3 rsp3^2-4 rsp2 rsp4+6 I rsp2^3 \[Omega])-rsp2 (I rsp5+6 rsp2 rsp3 \[Omega]))+rsp^4 (-I rsp6-10 rsp3^2 \[Omega]-10 rsp2 rsp4 \[Omega]+10 rsp^3 rsp3 \[Omega]^3-5 I rsp^4 rsp2 \[Omega]^4+5 rsp2 \[Omega] (-rsp4+3 I rsp2^2 \[Omega])+10 rsp^2 \[Omega]^2 (I rsp4+3 rsp2^2 \[Omega])+5 I rsp \[Omega] (I rsp5+10 rsp2 rsp3 \[Omega]))+rsp^5 \[Omega] (rsp5-10 I rsp2 rsp3 \[Omega]-10 rsp^2 rsp3 \[Omega]^2+10 I rsp^3 rsp2 \[Omega]^3+rsp^5 \[Omega]^4-5 rsp \[Omega] (I rsp4+3 rsp2^2 \[Omega])) Log[1/rsp]))),
rsp^(-6-i) ((120 rsp2^6-360 rsp rsp2^4 rsp3+120 rsp^2 rsp2^3 rsp4-30 rsp^2 rsp2^2 (-9 rsp3^2+rsp rsp5)+6 rsp^3 rsp2 (-20 rsp3 rsp4+rsp rsp6)+rsp^3 (-30 rsp3^3+15 rsp rsp3 rsp5+rsp (10 rsp4^2-rsp rsp7))) c[i]+6 I rsp^2 (24 rsp2^5-60 rsp rsp2^3 rsp3+20 rsp^2 rsp2^2 rsp4-5 rsp^2 rsp2 (-6 rsp3^2+rsp rsp5)+rsp^3 (-10 rsp3 rsp4+rsp rsp6)) \[Omega] c[i]+15 rsp^2 (-6 rsp2^4+12 rsp rsp2^2 rsp3-4 rsp^2 rsp2 rsp4+rsp^2 (-3 rsp3^2+rsp rsp5)) \[Omega] (I rsp2+rsp^2 \[Omega]) c[i]+20 rsp^3 (2 rsp2^3-3 rsp rsp2 rsp3+rsp^2 rsp4) \[Omega] (I rsp3+3 rsp rsp2 \[Omega]-I rsp^3 \[Omega]^2) c[i]-15 rsp^4 (-rsp2^2+rsp rsp3) \[Omega] (-I rsp4-3 rsp2^2 \[Omega]-4 rsp rsp3 \[Omega]+6 I rsp^2 rsp2 \[Omega]^2+rsp^4 \[Omega]^3) c[i]-6 rsp^5 rsp2 \[Omega] (-I rsp5-10 rsp2 rsp3 \[Omega]+10 I rsp^2 rsp3 \[Omega]^2+10 rsp^3 rsp2 \[Omega]^3-I rsp^5 \[Omega]^4+5 rsp \[Omega] (-rsp4+3 I rsp2^2 \[Omega])) c[i]+i ((120+274 i+225 i^2+85 i^3+15 i^4+i^5) rsp2^6-15 (24+50 i+35 i^2+10 i^3+i^4) rsp rsp2^4 rsp3+20 (6+11 i+6 i^2+i^3) rsp^2 rsp2^3 rsp4+15 (2+3 i+i^2) rsp^2 rsp2^2 (3 (3+i) rsp3^2-rsp rsp5)-6 (1+i) rsp^3 rsp2 (10 (2+i) rsp3 rsp4-rsp rsp6)+rsp^3 (-15 (2+3 i+i^2) rsp3^3+15 (1+i) rsp rsp3 rsp5+rsp (10 (1+i) rsp4^2-rsp rsp7))) (b[i]+c[i] Log[1/rsp])-rsp^6 \[Omega] (I rsp6+10 rsp3^2 \[Omega]+15 rsp2 rsp4 \[Omega]-15 I rsp2^3 \[Omega]^2-20 rsp^3 rsp3 \[Omega]^3+15 I rsp^4 rsp2 \[Omega]^4+rsp^6 \[Omega]^5-15 rsp^2 \[Omega]^2 (I rsp4+3 rsp2^2 \[Omega])+6 rsp \[Omega] (rsp5-10 I rsp2 rsp3 \[Omega])) (b[i]+c[i] Log[1/rsp])+6 i ((24+50 i+35 i^2+10 i^3+i^4) rsp2^5-10 (6+11 i+6 i^2+i^3) rsp rsp2^3 rsp3+10 (2+3 i+i^2) rsp^2 rsp2^2 rsp4+5 (1+i) rsp^2 rsp2 (3 (2+i) rsp3^2-rsp rsp5)+rsp^3 (-10 (1+i) rsp3 rsp4+rsp rsp6)) (I rsp^2 \[Omega] b[i]+c[i] (rsp2+I rsp^2 \[Omega] Log[1/rsp]))-15 i ((6+11 i+6 i^2+i^3) rsp2^4-6 (2+3 i+i^2) rsp rsp2^2 rsp3+4 (1+i) rsp^2 rsp2 rsp4+rsp^2 (3 (1+i) rsp3^2-rsp rsp5)) (rsp^2 \[Omega] (I rsp2+rsp^2 \[Omega]) b[i]+c[i] (-rsp2^2+rsp (rsp3-2 I rsp rsp2 \[Omega])+rsp^2 \[Omega] (I rsp2+rsp^2 \[Omega]) Log[1/rsp]))+20 i ((2+3 i+i^2) rsp2^3-3 (1+i) rsp rsp2 rsp3+rsp^2 rsp4) (rsp^3 \[Omega] (I rsp3+3 rsp rsp2 \[Omega]-I rsp^3 \[Omega]^2) b[i]+c[i] (2 rsp2^3+3 I rsp rsp2 (I rsp3+rsp rsp2 \[Omega])+rsp^2 (rsp4-3 I rsp2^2 \[Omega]-3 I rsp rsp3 \[Omega]-3 rsp^2 rsp2 \[Omega]^2)+rsp^3 \[Omega] (I rsp3+3 rsp rsp2 \[Omega]-I rsp^3 \[Omega]^2) Log[1/rsp]))+15 i ((1+i) rsp2^2-rsp rsp3) (rsp^4 \[Omega] (-I rsp4-3 rsp2^2 \[Omega]-4 rsp rsp3 \[Omega]+6 I rsp^2 rsp2 \[Omega]^2+rsp^4 \[Omega]^3) b[i]+c[i] (6 rsp2^4+4 rsp rsp2^2 (-3 rsp3+2 I rsp rsp2 \[Omega])+rsp^2 (3 rsp3^2+4 rsp2 rsp4-6 I rsp2^3 \[Omega]-12 I rsp rsp2 rsp3 \[Omega]-6 rsp^2 rsp2^2 \[Omega]^2)+rsp^3 (-rsp5+10 I rsp2 rsp3 \[Omega]+6 rsp^2 rsp3 \[Omega]^2-4 I rsp^3 rsp2 \[Omega]^3+4 rsp \[Omega] (I rsp4+3 rsp2^2 \[Omega]))+rsp^4 \[Omega] (-I rsp4-3 rsp2^2 \[Omega]-4 rsp rsp3 \[Omega]+6 I rsp^2 rsp2 \[Omega]^2+rsp^4 \[Omega]^3) Log[1/rsp]))+6 i rsp2 (rsp^5 \[Omega] (I rsp5+10 rsp2 rsp3 \[Omega]-10 I rsp^2 rsp3 \[Omega]^2-10 rsp^3 rsp2 \[Omega]^3+I rsp^5 \[Omega]^4+5 rsp \[Omega] (rsp4-3 I rsp2^2 \[Omega])) b[i]+c[i] (24 rsp2^5+30 I rsp rsp2^3 (2 I rsp3+rsp rsp2 \[Omega])-10 rsp^2 rsp2 (-3 rsp3^2-2 rsp2 rsp4+2 I rsp2^3 \[Omega]+6 I rsp rsp2 rsp3 \[Omega]+2 rsp^2 rsp2^2 \[Omega]^2)+5 rsp^3 (-2 rsp3 rsp4+2 I rsp2^2 rsp3 \[Omega]+6 rsp^2 rsp2 rsp3 \[Omega]^2-2 I rsp^3 rsp2^2 \[Omega]^3+rsp \[Omega] (3 I rsp3^2+4 I rsp2 rsp4+6 rsp2^3 \[Omega])+rsp2 (-rsp5+6 I rsp2 rsp3 \[Omega]))+rsp^4 (rsp6-10 I rsp3^2 \[Omega]-10 I rsp2 rsp4 \[Omega]+10 I rsp^3 rsp3 \[Omega]^3+5 rsp^4 rsp2 \[Omega]^4+10 rsp^2 \[Omega]^2 (-rsp4+3 I rsp2^2 \[Omega])-5 rsp2 \[Omega] (I rsp4+3 rsp2^2 \[Omega])-5 rsp \[Omega] (I rsp5+10 rsp2 rsp3 \[Omega]))+rsp^5 \[Omega] (I rsp5+10 rsp2 rsp3 \[Omega]-10 I rsp^2 rsp3 \[Omega]^2-10 rsp^3 rsp2 \[Omega]^3+I rsp^5 \[Omega]^4+5 rsp \[Omega] (rsp4-3 I rsp2^2 \[Omega])) Log[1/rsp])))},{i,0,nmax}]
];


(* ::Input::Initialization:: *)
OuterBC\[Chi]2[l_,\[Omega]_,nmax_,r_]:=OuterBC\[Chi]2[l,\[Omega],nmax,r,{1,0,0}];


(* ::Input::Initialization:: *)
OuterBC\[Chi]2[l_,\[Omega]_,nmax_,r_,basis_]:=Module[{M=1,a,b,n,rs,rsp,rsp2,rsp3,rsp4,rsp5,rsp6},
a[n_]:=a[n]=-(1/(8 (-2+n) n (2-3 n+n^2) \[Omega]^3))(I (2-n) (16 (-32+44 n-13 n^2+n^3)^2 a[-7+n]+8 (-2268+6792 n-7287 n^2+3499 n^3-825 n^4+93 n^5-4 n^6+l (506-572 n+253 n^2-46 n^3+3 n^4)+l^2 (506-572 n+253 n^2-46 n^3+3 n^4)) a[-6+n]+6432 a[-5+n]-4096 l a[-5+n]-3912 l^2 a[-5+n]+368 l^3 a[-5+n]+184 l^4 a[-5+n]-22096 n a[-5+n]+4968 l n a[-5+n]+4888 l^2 n a[-5+n]-160 l^3 n a[-5+n]-80 l^4 n a[-5+n]+26760 n^2 a[-5+n]-2404 l n^2 a[-5+n]-2392 l^2 n^2 a[-5+n]+24 l^3 n^2 a[-5+n]+12 l^4 n^2 a[-5+n]-14484 n^3 a[-5+n]+488 l n^3 a[-5+n]+488 l^2 n^3 a[-5+n]+3856 n^4 a[-5+n]-36 l n^4 a[-5+n]-36 l^2 n^4 a[-5+n]-492 n^5 a[-5+n]+24 n^6 a[-5+n]-3520 I \[Omega] a[-5+n]+11648 I n \[Omega] a[-5+n]-11680 I n^2 \[Omega] a[-5+n]+4704 I n^3 \[Omega] a[-5+n]-800 I n^4 \[Omega] a[-5+n]+48 I n^5 \[Omega] a[-5+n]-720 a[-4+n]+1284 l a[-4+n]+1142 l^2 a[-4+n]-282 l^3 a[-4+n]-136 l^4 a[-4+n]+6 l^5 a[-4+n]+2 l^6 a[-4+n]+3324 n a[-4+n]-1704 l n a[-4+n]-1634 l^2 n a[-4+n]+140 l^3 n a[-4+n]+70 l^4 n a[-4+n]-4886 n^2 a[-4+n]+918 l n^2 a[-4+n]+906 l^2 n^2 a[-4+n]-24 l^3 n^2 a[-4+n]-12 l^4 n^2 a[-4+n]+3110 n^3 a[-4+n]-212 l n^3 a[-4+n]-212 l^2 n^3 a[-4+n]-962 n^4 a[-4+n]+18 l n^4 a[-4+n]+18 l^2 n^4 a[-4+n]+142 n^5 a[-4+n]-8 n^6 a[-4+n]+2664 I \[Omega] a[-4+n]-904 I l \[Omega] a[-4+n]-904 I l^2 \[Omega] a[-4+n]-10208 I n \[Omega] a[-4+n]+1112 I l n \[Omega] a[-4+n]+1112 I l^2 n \[Omega] a[-4+n]+11616 I n^2 \[Omega] a[-4+n]-408 I l n^2 \[Omega] a[-4+n]-408 I l^2 n^2 \[Omega] a[-4+n]-5328 I n^3 \[Omega] a[-4+n]+48 I l n^3 \[Omega] a[-4+n]+48 I l^2 n^3 \[Omega] a[-4+n]+1040 I n^4 \[Omega] a[-4+n]-72 I n^5 \[Omega] a[-4+n]-120 l a[-3+n]-94 l^2 a[-3+n]+51 l^3 a[-3+n]+23 l^4 a[-3+n]-3 l^5 a[-3+n]-l^6 a[-3+n]-120 n a[-3+n]+180 l n a[-3+n]+165 l^2 n a[-3+n]-30 l^3 n a[-3+n]-15 l^4 n a[-3+n]+274 n^2 a[-3+n]-111 l n^2 a[-3+n]-108 l^2 n^2 a[-3+n]+6 l^3 n^2 a[-3+n]+3 l^4 n^2 a[-3+n]-225 n^3 a[-3+n]+30 l n^3 a[-3+n]+30 l^2 n^3 a[-3+n]+85 n^4 a[-3+n]-3 l n^4 a[-3+n]-3 l^2 n^4 a[-3+n]-15 n^5 a[-3+n]+n^6 a[-3+n]-480 I \[Omega] a[-3+n]+620 I l \[Omega] a[-3+n]+592 I l^2 \[Omega] a[-3+n]-56 I l^3 \[Omega] a[-3+n]-28 I l^4 \[Omega] a[-3+n]+2532 I n \[Omega] a[-3+n]-828 I l n \[Omega] a[-3+n]-816 I l^2 n \[Omega] a[-3+n]+24 I l^3 n \[Omega] a[-3+n]+12 I l^4 n \[Omega] a[-3+n]-3508 I n^2 \[Omega] a[-3+n]+348 I l n^2 \[Omega] a[-3+n]+348 I l^2 n^2 \[Omega] a[-3+n]+1908 I n^3 \[Omega] a[-3+n]-48 I l n^3 \[Omega] a[-3+n]-48 I l^2 n^3 \[Omega] a[-3+n]-440 I n^4 \[Omega] a[-3+n]+36 I n^5 \[Omega] a[-3+n]-240 \[Omega]^2 a[-3+n]+1184 n \[Omega]^2 a[-3+n]-1280 n^2 \[Omega]^2 a[-3+n]+448 n^3 \[Omega]^2 a[-3+n]-48 n^4 \[Omega]^2 a[-3+n]-96 I l \[Omega] a[-2+n]-84 I l^2 \[Omega] a[-2+n]+24 I l^3 \[Omega] a[-2+n]+12 I l^4 \[Omega] a[-2+n]-144 I n \[Omega] a[-2+n]+144 I l n \[Omega] a[-2+n]+138 I l^2 n \[Omega] a[-2+n]-12 I l^3 n \[Omega] a[-2+n]-6 I l^4 n \[Omega] a[-2+n]+300 I n^2 \[Omega] a[-2+n]-72 I l n^2 \[Omega] a[-2+n]-72 I l^2 n^2 \[Omega] a[-2+n]-210 I n^3 \[Omega] a[-2+n]+12 I l n^3 \[Omega] a[-2+n]+12 I l^2 n^3 \[Omega] a[-2+n]+60 I n^4 \[Omega] a[-2+n]-6 I n^5 \[Omega] a[-2+n]+96 \[Omega]^2 a[-2+n]-64 l \[Omega]^2 a[-2+n]-64 l^2 \[Omega]^2 a[-2+n]-672 n \[Omega]^2 a[-2+n]+88 l n \[Omega]^2 a[-2+n]+88 l^2 n \[Omega]^2 a[-2+n]+872 n^2 \[Omega]^2 a[-2+n]-24 l n^2 \[Omega]^2 a[-2+n]-24 l^2 n^2 \[Omega]^2 a[-2+n]-368 n^3 \[Omega]^2 a[-2+n]+48 n^4 \[Omega]^2 a[-2+n]+24 l \[Omega]^2 a[-1+n]+24 l^2 \[Omega]^2 a[-1+n]+72 n \[Omega]^2 a[-1+n]-36 l n \[Omega]^2 a[-1+n]-36 l^2 n \[Omega]^2 a[-1+n]-132 n^2 \[Omega]^2 a[-1+n]+12 l n^2 \[Omega]^2 a[-1+n]+12 l^2 n^2 \[Omega]^2 a[-1+n]+72 n^3 \[Omega]^2 a[-1+n]-12 n^4 \[Omega]^2 a[-1+n]-48 I n \[Omega]^3 a[-1+n]+64 I n^2 \[Omega]^3 a[-1+n]-16 I n^3 \[Omega]^3 a[-1+n])+32 I (2-3 n+n^2) (1408-1360 n+452 n^2-62 n^3+3 n^4) b[-7+n]-8 I (2-n) (2 l (-286+253 n-69 n^2+6 n^3)+2 l^2 (-286+253 n-69 n^2+6 n^3)+3 (2264-4858 n+3499 n^2-1100 n^3+155 n^4-8 n^5)) b[-6+n]+4 I (2-n) (5524+l^3 (40-12 n)+l^4 (20-6 n)-36 n^5+2 l^2 (-611+598 n-183 n^2+18 n^3)+2 l (-621+601 n-183 n^2+18 n^3)+15 n^4 (41-4 I \[Omega])+9 n^2 (1207-392 I \[Omega])+n^3 (-3856+800 I \[Omega])-2912 I \[Omega]+20 I n (669 I+292 \[Omega])) b[-5+n]-2 I (2-n) (1662+l^3 (70-24 n)+l^4 (35-12 n)-24 n^5+5 n^4 (71-36 I \[Omega])+l (-852+36 n^3+102 n (9-4 I \[Omega])+n^2 (-318+72 I \[Omega])+556 I \[Omega])+l^2 (-817+36 n^3+6 n (151-68 I \[Omega])+n^2 (-318+72 I \[Omega])+556 I \[Omega])+n^2 (4665-7992 I \[Omega])+n (-4886+11616 I \[Omega])-5104 I \[Omega]+52 I n^3 (37 I+40 \[Omega])) b[-4+n]-I (2-n) (6 n^5+6 l^3 (-5+2 n+4 I \[Omega])+3 l^4 (-5+2 n+4 I \[Omega])+n^4 (-75+180 I \[Omega])-4 n^3 (-85+440 I \[Omega]+48 \[Omega]^2)+4 (-30+633 I \[Omega]+296 \[Omega]^2)+3 n^2 (-225+1908 I \[Omega]+448 \[Omega]^2)-4 n (-137+1754 I \[Omega]+640 \[Omega]^2)-6 l (-30+2 n^3+n (37-116 I \[Omega])+138 I \[Omega]+3 I n^2 (5 I+8 \[Omega]))-3 l^2 (-55+4 n^3+8 n (9-29 I \[Omega])+272 I \[Omega]+6 I n^2 (5 I+8 \[Omega]))) b[-3+n]-2 (2-n) \[Omega] (72+6 l^3+3 l^4+15 n^4+l^2 (-69-18 n^2+24 n (3-I \[Omega])+44 I \[Omega])+n^2 (315-552 I \[Omega])+n (-300+872 I \[Omega])-336 I \[Omega]+24 I n^3 (5 I+4 \[Omega])-2 l (36+9 n^2-22 I \[Omega]+12 I n (3 I+\[Omega]))) b[-2+n]-4 I (2-n) (l (-9+6 n)+l^2 (-9+6 n)-2 (-9+6 n^3+n^2 (-27+6 I \[Omega])+n (33-16 I \[Omega])+6 I \[Omega])) \[Omega]^2 b[-1+n]-8 (-2+n) (2-6 n+3 n^2) \[Omega]^3 b[n]);

b[n_]:=b[n]=(1/(8 (-2+n) (-1+n) n \[Omega]^3))I (16 (-8+n)^2 (-4+n)^2 (-1+n)^2 b[-7+n]-8 (2268-506 l (1+l)-6792 n+572 l (1+l) n+(7287-253 l (1+l)) n^2+(-3499+46 l (1+l)) n^3-3 (-275+l+l^2) n^4-93 n^5+4 n^6) b[-6+n]+4 (1608-5524 n+6690 n^2-3621 n^3+964 n^4-123 n^5+6 n^6+l^3 (92-40 n+6 n^2)+l^4 (46+n (-20+3 n))+l (-1024+n (1242+n (-601+(122-9 n) n)))+l^2 (-978+n (1222+n (-598+(122-9 n) n)))+4 I (-10+(-6+n) (-4+n) n) (22+n (-20+3 n)) \[Omega]) b[-5+n]+2 (3 l^5+l^6+l^4 (-68+(35-6 n) n)+l^3 (-141+2 (35-6 n) n)+6 (-60+277 n+222 I \[Omega])+l^2 (571-817 n+453 n^2-106 n^3+9 n^4+4 I (-113+n (139-51 n+6 n^2)) \[Omega])+l (642-852 n+459 n^2-106 n^3+9 n^4+4 I (-113+n (139-51 n+6 n^2)) \[Omega])+n (n (-2443+n (1555+n (-481+(71-4 n) n)))-4 I (1276+n (-1452+n (666+n (-130+9 n)))) \[Omega])) b[-4+n]-(3 l^5+l^6-(-5+n) (-4+n) (-3+n) (-2+n) (-1+n) n+3 l ((6-2 I)+(-5+n) n) ((6+2 I)+(-5+n) n)+l^4 (-23-3 n (-5+n+4 I \[Omega])+28 I \[Omega])+l^3 (-51-6 n (-5+n+4 I \[Omega])+56 I \[Omega])+4 I l (-155+3 n (69+n (-29+4 n))) \[Omega]-4 I (-120+n (633+n (-877+n (477+n (-110+9 n))))) \[Omega]+16 (-3+n) (-5+n (23+n (-19+3 n))) \[Omega]^2+l^2 (94-592 I \[Omega]+3 n (-55+36 n-10 n^2+n^3+4 I (68+n (-29+4 n)) \[Omega]))) b[-3+n]-2 I \[Omega] (3 (-2+n) (2 l^3+l^4-2 l (-2+n)^2+(-4+n) (-3+n) (-1+n) n+l^2 (-7-2 (-4+n) n))-4 I (-12+8 l (1+l)+(84-11 l (1+l)) n+(-109+3 l (1+l)) n^2+46 n^3-6 n^4) \[Omega]) b[-2+n]-4 (1-n) \[Omega]^2 (3 (-2+n) (l+l^2-(-3+n) n)-4 I (-3+n) n \[Omega]) b[-1+n]);

Table[a[i]=0;b[i]=0;,{i,-7,-1}];
a[0]=basis[[1]];
a[1]=basis[[2]];
a[2]=basis[[3]];
b[0]=0;
b[1]=0;
b[2]=-((I (4+l+l^2) a[0])/\[Omega])+2 a[1];

Do[a[i];b[i];,{i,3,nmax}];

rs=r+2M Log[r/(2M)-1];
rsp=1/(1-2M/r);
rsp2=-((2 M)/(-2 M+r)^2);
rsp3=-((4 M)/(2 M-r)^3);
rsp4=-((12 M)/(-2 M+r)^4);
rsp5=-((48 M)/(2 M-r)^5);
rsp6=-((240 M)/(-2 M+r)^6);

E^(I rs \[Omega]) Sum[
{r^(2-i) (a[i]+b[i] Log[r]),
r^(1-i) ((2-i+I r rsp \[Omega]) a[i]+b[i] (1-(-2+i) Log[r]+I r rsp \[Omega] Log[r])),
r^-i ((2-3 i+i^2-2 I (-2+i) r rsp \[Omega]+I r^2 rsp2 \[Omega]-r^2 rsp^2 \[Omega]^2) a[i]+b[i] (3-2 i+2 Log[r]-3 i Log[r]+i^2 Log[r]+I r^2 rsp2 \[Omega] Log[r]-r^2 rsp^2 \[Omega]^2 Log[r]-2 I r rsp \[Omega] (-1+(-2+i) Log[r]))),
r^(-1-i) (-((2 i-3 i^2+i^3+3 I (-2+i) r^2 rsp2 \[Omega]-I r^3 rsp3 \[Omega]-3 (-2+i) r^2 rsp^2 \[Omega]^2+I r^3 rsp^3 \[Omega]^3-3 I r rsp \[Omega] (2-3 i+i^2+I r^2 rsp2 \[Omega])) a[i])+b[i] (2-6 i+3 i^2-2 i Log[r]+3 i^2 Log[r]-i^3 Log[r]+I r^3 rsp3 \[Omega] Log[r]-I r^3 rsp^3 \[Omega]^3 Log[r]-3 I r^2 rsp2 \[Omega] (-1+(-2+i) Log[r])+3 r^2 rsp^2 \[Omega]^2 (-1+(-2+i) Log[r])+3 I r rsp \[Omega] (3-2 i+(2-3 i+i^2) Log[r]+I r^2 rsp2 \[Omega] Log[r]))),
r^(-2-i) ((2 i-i^2-2 i^3+i^4+6 I (2-3 i+i^2) r^2 rsp2 \[Omega]+8 I r^3 rsp3 \[Omega]-4 I i r^3 rsp3 \[Omega]+I r^4 rsp4 \[Omega]-3 r^4 rsp2^2 \[Omega]^2+4 I (-2+i) r^3 rsp^3 \[Omega]^3+r^4 rsp^4 \[Omega]^4+6 r^2 rsp^2 \[Omega]^2 (-2+3 i-i^2-I r^2 rsp2 \[Omega])-4 r rsp \[Omega] (I i (2-3 i+i^2)-3 (-2+i) r^2 rsp2 \[Omega]+r^3 rsp3 \[Omega])) a[i]+b[i] (-2+2 i+6 i^2-4 i^3+4 I r^3 rsp3 \[Omega]+2 i Log[r]-i^2 Log[r]-2 i^3 Log[r]+i^4 Log[r]+8 I r^3 rsp3 \[Omega] Log[r]-4 I i r^3 rsp3 \[Omega] Log[r]+I r^4 rsp4 \[Omega] Log[r]-3 r^4 rsp2^2 \[Omega]^2 Log[r]+r^4 rsp^4 \[Omega]^4 Log[r]+4 I r^3 rsp^3 \[Omega]^3 (-1+(-2+i) Log[r])+6 I r^2 rsp2 \[Omega] (3-2 i+(2-3 i+i^2) Log[r])+6 r^2 rsp^2 \[Omega]^2 (-3+2 i-(2-3 i+i^2) Log[r]-I r^2 rsp2 \[Omega] Log[r])-4 r rsp \[Omega] (3 r^2 rsp2 \[Omega] (1-(-2+i) Log[r])+I (-2+6 i-3 i^2+i (2-3 i+i^2) Log[r]-I r^3 rsp3 \[Omega] Log[r])))),
r^(-3-i) (-((4 i-5 i^3+i^5-20 I r^3 rsp3 \[Omega]+30 I i r^3 rsp3 \[Omega]-10 I i^2 r^3 rsp3 \[Omega]-10 I r^4 rsp4 \[Omega]+5 I i r^4 rsp4 \[Omega]-I r^5 rsp5 \[Omega]-15 (-2+i) r^4 rsp2^2 \[Omega]^2+5 (-2+i) r^4 rsp^4 \[Omega]^4-I r^5 rsp^5 \[Omega]^5+10 I r^3 rsp^3 \[Omega]^3 (2-3 i+i^2+I r^2 rsp2 \[Omega])-10 r^2 rsp^2 \[Omega]^2 (i (2-3 i+i^2)+3 I (-2+i) r^2 rsp2 \[Omega]-I r^3 rsp3 \[Omega])+10 r^2 rsp2 \[Omega] (I i (2-3 i+i^2)+r^3 rsp3 \[Omega])+5 r rsp \[Omega] (-I i (2-i-2 i^2+i^3)+6 (2-3 i+i^2) r^2 rsp2 \[Omega]-4 (-2+i) r^3 rsp3 \[Omega]+r^4 rsp4 \[Omega]+3 I r^4 rsp2^2 \[Omega]^2)) a[i])-b[i] (-4+15 i^2-5 i^4-30 I r^3 rsp3 \[Omega]+20 I i r^3 rsp3 \[Omega]-5 I r^4 rsp4 \[Omega]+4 i Log[r]-5 i^3 Log[r]+i^5 Log[r]-20 I r^3 rsp3 \[Omega] Log[r]+30 I i r^3 rsp3 \[Omega] Log[r]-10 I i^2 r^3 rsp3 \[Omega] Log[r]-10 I r^4 rsp4 \[Omega] Log[r]+5 I i r^4 rsp4 \[Omega] Log[r]-I r^5 rsp5 \[Omega] Log[r]-I r^5 rsp^5 \[Omega]^5 Log[r]-15 r^4 rsp2^2 \[Omega]^2 (-1+(-2+i) Log[r])+5 r^4 rsp^4 \[Omega]^4 (-1+(-2+i) Log[r])+10 I r^3 rsp^3 \[Omega]^3 (3-2 i+(2-3 i+i^2) Log[r]+I r^2 rsp2 \[Omega] Log[r])+10 I r^2 rsp2 \[Omega] (-2+6 i-3 i^2+i (2-3 i+i^2) Log[r]-I r^3 rsp3 \[Omega] Log[r])+10 r^2 rsp^2 \[Omega]^2 (2-6 i+3 i^2-2 i Log[r]+3 i^2 Log[r]-i^3 Log[r]+I r^3 rsp3 \[Omega] Log[r]-3 I r^2 rsp2 \[Omega] (-1+(-2+i) Log[r]))+5 r rsp \[Omega] (3 I r^4 rsp2^2 \[Omega]^2 Log[r]+6 r^2 rsp2 \[Omega] (3-2 i+(2-3 i+i^2) Log[r])-I (-2+2 i+6 i^2-4 i^3+2 i Log[r]-i^2 Log[r]-2 i^3 Log[r]+i^4 Log[r]+I r^4 rsp4 \[Omega] Log[r]-4 I r^3 rsp3 \[Omega] (-1+(-2+i) Log[r]))))),
r^(-4-i) ((12 i+4 i^2-15 i^3-5 i^4+3 i^5+i^6-40 I i r^3 rsp3 \[Omega]+60 I i^2 r^3 rsp3 \[Omega]-20 I i^3 r^3 rsp3 \[Omega]+30 I r^4 rsp4 \[Omega]-45 I i r^4 rsp4 \[Omega]+15 I i^2 r^4 rsp4 \[Omega]+12 I r^5 rsp5 \[Omega]-6 I i r^5 rsp5 \[Omega]+I r^6 rsp6 \[Omega]-45 (2-3 i+i^2) r^4 rsp2^2 \[Omega]^2-10 r^6 rsp3^2 \[Omega]^2-15 I r^6 rsp2^3 \[Omega]^3-6 I (-2+i) r^5 rsp^5 \[Omega]^5-r^6 rsp^6 \[Omega]^6+15 r^4 rsp^4 \[Omega]^4 (2-3 i+i^2+I r^2 rsp2 \[Omega])+20 r^3 rsp^3 \[Omega]^3 (I i (2-3 i+i^2)-3 (-2+i) r^2 rsp2 \[Omega]+r^3 rsp3 \[Omega])-15 r^2 rsp2 \[Omega] (-I i (2-i-2 i^2+i^3)-4 (-2+i) r^3 rsp3 \[Omega]+r^4 rsp4 \[Omega])-15 r^2 rsp^2 \[Omega]^2 (2 i-i^2-2 i^3+i^4+6 I (2-3 i+i^2) r^2 rsp2 \[Omega]-4 I (-2+i) r^3 rsp3 \[Omega]+I r^4 rsp4 \[Omega]-3 r^4 rsp2^2 \[Omega]^2)+6 r rsp \[Omega] (-4 I i+5 I i^3-I i^5-10 (2-3 i+i^2) r^3 rsp3 \[Omega]-10 r^4 rsp4 \[Omega]+5 i r^4 rsp4 \[Omega]-r^5 rsp5 \[Omega]+15 I (-2+i) r^4 rsp2^2 \[Omega]^2+10 r^2 rsp2 \[Omega] (i (2-3 i+i^2)-I r^3 rsp3 \[Omega]))) a[i]+b[i] (-12-8 i+45 i^2+20 i^3-15 i^4-6 i^5+40 I r^3 rsp3 \[Omega]-120 I i r^3 rsp3 \[Omega]+60 I i^2 r^3 rsp3 \[Omega]+45 I r^4 rsp4 \[Omega]-30 I i r^4 rsp4 \[Omega]+6 I r^5 rsp5 \[Omega]+12 i Log[r]+4 i^2 Log[r]-15 i^3 Log[r]-5 i^4 Log[r]+3 i^5 Log[r]+i^6 Log[r]-40 I i r^3 rsp3 \[Omega] Log[r]+60 I i^2 r^3 rsp3 \[Omega] Log[r]-20 I i^3 r^3 rsp3 \[Omega] Log[r]+30 I r^4 rsp4 \[Omega] Log[r]-45 I i r^4 rsp4 \[Omega] Log[r]+15 I i^2 r^4 rsp4 \[Omega] Log[r]+12 I r^5 rsp5 \[Omega] Log[r]-6 I i r^5 rsp5 \[Omega] Log[r]+I r^6 rsp6 \[Omega] Log[r]-10 r^6 rsp3^2 \[Omega]^2 Log[r]-15 I r^6 rsp2^3 \[Omega]^3 Log[r]-r^6 rsp^6 \[Omega]^6 Log[r]-6 I r^5 rsp^5 \[Omega]^5 (-1+(-2+i) Log[r])-45 r^4 rsp2^2 \[Omega]^2 (3-2 i+(2-3 i+i^2) Log[r])+15 r^4 rsp^4 \[Omega]^4 (3-2 i+(2-3 i+i^2) Log[r]+I r^2 rsp2 \[Omega] Log[r])+15 I r^2 rsp2 \[Omega] (-2+2 i+6 i^2-4 i^3+2 i Log[r]-i^2 Log[r]-2 i^3 Log[r]+i^4 Log[r]+I r^4 rsp4 \[Omega] Log[r]-4 I r^3 rsp3 \[Omega] (-1+(-2+i) Log[r]))+15 r^2 rsp^2 \[Omega]^2 (2-2 i-6 i^2+4 i^3-2 i Log[r]+i^2 Log[r]+2 i^3 Log[r]-i^4 Log[r]-I r^4 rsp4 \[Omega] Log[r]+3 r^4 rsp2^2 \[Omega]^2 Log[r]+4 I r^3 rsp3 \[Omega] (-1+(-2+i) Log[r])-6 I r^2 rsp2 \[Omega] (3-2 i+(2-3 i+i^2) Log[r]))+20 r^3 rsp^3 \[Omega]^3 (3 r^2 rsp2 \[Omega] (1-(-2+i) Log[r])+I (-2+6 i-3 i^2+i (2-3 i+i^2) Log[r]-I r^3 rsp3 \[Omega] Log[r]))+6 r rsp \[Omega] (4 I-15 I i^2+5 I i^4-5 r^4 rsp4 \[Omega]-4 I i Log[r]+5 I i^3 Log[r]-I i^5 Log[r]-10 r^4 rsp4 \[Omega] Log[r]+5 i r^4 rsp4 \[Omega] Log[r]-r^5 rsp5 \[Omega] Log[r]+15 I r^4 rsp2^2 \[Omega]^2 (-1+(-2+i) Log[r])-10 r^3 rsp3 \[Omega] (3-2 i+(2-3 i+i^2) Log[r])+10 r^2 rsp2 \[Omega] (-2+6 i-3 i^2+i (2-3 i+i^2) Log[r]-I r^3 rsp3 \[Omega] Log[r]))))},{i,0,nmax}]
];


(* ::Input::Initialization:: *)
InnerBC\[Chi]2[l_,\[Omega]_,nmax_,r_]:=InnerBC\[Chi]2[l,\[Omega],nmax,r,{1,0,0}];


(* ::Input::Initialization:: *)
InnerBC\[Chi]2[l_,\[Omega]_,nmax_,r_,basis_]:=Module[{M=1,b,c,n,rs,rsp,rsp2,rsp3,rsp4,rsp5,rsp6,rsp7},
c[n_]:=c[n]=(1/((-1+n) n^2 (-1+n-4 I \[Omega]) (n-4 I \[Omega])^2))(-n^2 (21-10 n+n^2)^2 c[-8+n]-(144+96 n-2465 n^2+2452 n^3-905 n^4+142 n^5-8 n^6+l (-144+192 n-133 n^2+34 n^3-3 n^4)+l^2 (-144+192 n-133 n^2+34 n^3-3 n^4)) c[-7+n]-(-544+28 n^6+l^4 (29-14 n+3 n^2)+l^3 (58-28 n+6 n^2)+2 l (270-428 n+318 n^2-90 n^3+9 n^4)+l^2 (569-870 n+639 n^2-180 n^3+18 n^4)+n^5 (-434-12 I \[Omega])+n (-436+140 I \[Omega])+n^4 (2449+140 I \[Omega])+n^2 (5733+472 I \[Omega])+n^3 (-6012-496 I \[Omega])-100 I \[Omega]) c[-6+n]-(784-3 l^5-l^6-56 n^6+l^3 (-171+100 n-24 n^2)-2 l^4 (44-25 n+6 n^2)+n^5 (742+72 I \[Omega])+l^2 (-889-45 n^4+6 n^3 (65+4 I \[Omega])+2 n (787+110 I \[Omega])+n^2 (-1239-132 I \[Omega])-76 I \[Omega])+l (-804-45 n^4+6 n^3 (65+4 I \[Omega])+4 n (381+55 I \[Omega])+n^2 (-1227-132 I \[Omega])-76 I \[Omega])+n (788-428 I \[Omega])+4 n^3 (1995+562 I \[Omega])+n^4 (-3641-720 I \[Omega])+n^2 (-7125-2036 I \[Omega])+500 I \[Omega]) c[-5+n]-(-528+6 l^5+2 l^6+70 n^6+4 l^3 (45+9 n^2+n (-33-6 I \[Omega])+8 I \[Omega])+l^4 (95+18 n^2+n (-66-12 I \[Omega])+16 I \[Omega])+2 l (301+30 n^4+n^3 (-220-48 I \[Omega])+4 n^2 (151+57 I \[Omega])+n (-682-344 I \[Omega])+124 I \[Omega])+n^5 (-770-180 I \[Omega])+l^2 (691+60 n^4+n^3 (-440-96 I \[Omega])+2 n^2 (613+228 I \[Omega])+n (-1430-700 I \[Omega])+264 I \[Omega])-836 I \[Omega]+64 \[Omega]^2+n^2 (5035+3424 I \[Omega]-224 \[Omega]^2)+n^4 (3205+1500 I \[Omega]-48 \[Omega]^2)-8 n (89-54 I \[Omega]+28 \[Omega]^2)+4 n^3 (-1535-1010 I \[Omega]+64 \[Omega]^2)) c[-4+n]-(-3 l^5-l^6-56 n^6-2 l^4 (21+6 n^2+n (-19-12 I \[Omega])+16 I \[Omega])+10 n^5 (49+24 I \[Omega])+l^3 (-79-24 n^2+n (76+48 I \[Omega])-64 I \[Omega])+n^3 (2700+3600 I \[Omega]-832 \[Omega]^2)+20 (8+29 I \[Omega]-16 \[Omega]^2)+8 n (41-16 I \[Omega]+62 \[Omega]^2)+n^4 (-1667-1600 I \[Omega]+192 \[Omega]^2)+n^2 (-1971-2776 I \[Omega]+688 \[Omega]^2)+l^2 (-273-45 n^4+18 n^3 (15+8 I \[Omega])-316 I \[Omega]+n (666+792 I \[Omega]-80 \[Omega]^2)+n^2 (-639-576 I \[Omega]+48 \[Omega]^2))+l (-234-45 n^4+18 n^3 (15+8 I \[Omega])-284 I \[Omega]+n (628+768 I \[Omega]-80 \[Omega]^2)+n^2 (-627-576 I \[Omega]+48 \[Omega]^2))) c[-3+n]-(28 n^6+2 l^3 (6+3 n^2+n (-8-12 I \[Omega])+16 I \[Omega])+l^4 (6+3 n^2+n (-8-12 I \[Omega])+16 I \[Omega])+n^5 (-182-180 I \[Omega])+n^4 (475+900 I \[Omega]-288 \[Omega]^2)+8 (-2-19 I \[Omega]+40 \[Omega]^2)+4 n^3 (-153-400 I \[Omega]+240 \[Omega]^2+16 I \[Omega]^3)+n^2 (375+1064 I \[Omega]-720 \[Omega]^2-64 I \[Omega]^3)-4 I n (-17 I+7 \[Omega]-80 I \[Omega]^2+32 \[Omega]^3)+2 l (21+9 n^4+n^3 (-42-48 I \[Omega])+64 I \[Omega]-16 \[Omega]^2+n^2 (78+156 I \[Omega]-48 \[Omega]^2)+2 n (-33-88 I \[Omega]+40 \[Omega]^2))+l^2 (18 n^4+n^3 (-84-96 I \[Omega])+n^2 (159+312 I \[Omega]-96 \[Omega]^2)+16 (3+9 I \[Omega]-2 \[Omega]^2)+4 n (-35-91 I \[Omega]+40 \[Omega]^2))) c[-2+n]+(-1+n) (-1+n-4 I \[Omega]) (8 n^4+l (2+3 n^2+n (-4-12 I \[Omega])+8 I \[Omega])+l^2 (2+3 n^2+n (-4-12 I \[Omega])+8 I \[Omega])+n (-4-12 I \[Omega])+n^3 (-18-40 I \[Omega])+8 \[Omega] (-I+4 \[Omega])+n^2 (15+56 I \[Omega]-32 \[Omega]^2)) c[-1+n]);

b[n_]:=b[n]=(1/((-1+n) n^2 (-1+n-4 I \[Omega]) (n-4 I \[Omega])^2))(-n^2 (21-10 n+n^2)^2 b[-8+n]-(144+96 n-2465 n^2+2452 n^3-905 n^4+142 n^5-8 n^6+l (-144+192 n-133 n^2+34 n^3-3 n^4)+l^2 (-144+192 n-133 n^2+34 n^3-3 n^4)) b[-7+n]-(-544+28 n^6+l^4 (29-14 n+3 n^2)+l^3 (58-28 n+6 n^2)+2 l (270-428 n+318 n^2-90 n^3+9 n^4)+l^2 (569-870 n+639 n^2-180 n^3+18 n^4)+n^5 (-434-12 I \[Omega])+n (-436+140 I \[Omega])+n^4 (2449+140 I \[Omega])+n^2 (5733+472 I \[Omega])+n^3 (-6012-496 I \[Omega])-100 I \[Omega]) b[-6+n]-(784-3 l^5-l^6-56 n^6+l^3 (-171+100 n-24 n^2)-2 l^4 (44-25 n+6 n^2)+n^5 (742+72 I \[Omega])+l^2 (-889-45 n^4+6 n^3 (65+4 I \[Omega])+2 n (787+110 I \[Omega])+n^2 (-1239-132 I \[Omega])-76 I \[Omega])+l (-804-45 n^4+6 n^3 (65+4 I \[Omega])+4 n (381+55 I \[Omega])+n^2 (-1227-132 I \[Omega])-76 I \[Omega])+n (788-428 I \[Omega])+4 n^3 (1995+562 I \[Omega])+n^4 (-3641-720 I \[Omega])+n^2 (-7125-2036 I \[Omega])+500 I \[Omega]) b[-5+n]-(-528+6 l^5+2 l^6+70 n^6+4 l^3 (45+9 n^2+n (-33-6 I \[Omega])+8 I \[Omega])+l^4 (95+18 n^2+n (-66-12 I \[Omega])+16 I \[Omega])+2 l (301+30 n^4+n^3 (-220-48 I \[Omega])+4 n^2 (151+57 I \[Omega])+n (-682-344 I \[Omega])+124 I \[Omega])+n^5 (-770-180 I \[Omega])+l^2 (691+60 n^4+n^3 (-440-96 I \[Omega])+2 n^2 (613+228 I \[Omega])+n (-1430-700 I \[Omega])+264 I \[Omega])-836 I \[Omega]+64 \[Omega]^2+n^2 (5035+3424 I \[Omega]-224 \[Omega]^2)+n^4 (3205+1500 I \[Omega]-48 \[Omega]^2)-8 n (89-54 I \[Omega]+28 \[Omega]^2)+4 n^3 (-1535-1010 I \[Omega]+64 \[Omega]^2)) b[-4+n]-(-3 l^5-l^6-56 n^6-2 l^4 (21+6 n^2+n (-19-12 I \[Omega])+16 I \[Omega])+10 n^5 (49+24 I \[Omega])+l^3 (-79-24 n^2+n (76+48 I \[Omega])-64 I \[Omega])+n^3 (2700+3600 I \[Omega]-832 \[Omega]^2)+20 (8+29 I \[Omega]-16 \[Omega]^2)+8 n (41-16 I \[Omega]+62 \[Omega]^2)+n^4 (-1667-1600 I \[Omega]+192 \[Omega]^2)+n^2 (-1971-2776 I \[Omega]+688 \[Omega]^2)+l^2 (-273-45 n^4+18 n^3 (15+8 I \[Omega])-316 I \[Omega]+n (666+792 I \[Omega]-80 \[Omega]^2)+n^2 (-639-576 I \[Omega]+48 \[Omega]^2))+l (-234-45 n^4+18 n^3 (15+8 I \[Omega])-284 I \[Omega]+n (628+768 I \[Omega]-80 \[Omega]^2)+n^2 (-627-576 I \[Omega]+48 \[Omega]^2))) b[-3+n]-(28 n^6+2 l^3 (6+3 n^2+n (-8-12 I \[Omega])+16 I \[Omega])+l^4 (6+3 n^2+n (-8-12 I \[Omega])+16 I \[Omega])+n^5 (-182-180 I \[Omega])+n^4 (475+900 I \[Omega]-288 \[Omega]^2)+8 (-2-19 I \[Omega]+40 \[Omega]^2)+4 n^3 (-153-400 I \[Omega]+240 \[Omega]^2+16 I \[Omega]^3)+n^2 (375+1064 I \[Omega]-720 \[Omega]^2-64 I \[Omega]^3)-4 I n (-17 I+7 \[Omega]-80 I \[Omega]^2+32 \[Omega]^3)+2 l (21+9 n^4+n^3 (-42-48 I \[Omega])+64 I \[Omega]-16 \[Omega]^2+n^2 (78+156 I \[Omega]-48 \[Omega]^2)+2 n (-33-88 I \[Omega]+40 \[Omega]^2))+l^2 (18 n^4+n^3 (-84-96 I \[Omega])+n^2 (159+312 I \[Omega]-96 \[Omega]^2)+16 (3+9 I \[Omega]-2 \[Omega]^2)+4 n (-35-91 I \[Omega]+40 \[Omega]^2))) b[-2+n]+(-1+n) (-1+n-4 I \[Omega]) (8 n^4+l (2+3 n^2+n (-4-12 I \[Omega])+8 I \[Omega])+l^2 (2+3 n^2+n (-4-12 I \[Omega])+8 I \[Omega])+n (-4-12 I \[Omega])+n^3 (-18-40 I \[Omega])+8 \[Omega] (-I+4 \[Omega])+n^2 (15+56 I \[Omega]-32 \[Omega]^2)) b[-1+n]-2 n (441-630 n+284 n^2-50 n^3+3 n^4) c[-8+n]+2 (-48+2465 n-3678 n^2+1810 n^3-355 n^4+24 n^5+l (-96+133 n-51 n^2+6 n^3)+l^2 (-96+133 n-51 n^2+6 n^3)) c[-7+n]-2 (-218+84 n^5+2 l^3 (-7+3 n)+l^4 (-7+3 n)+3 l^2 (-145+213 n-90 n^2+12 n^3)+l (-428+636 n-270 n^2+36 n^3)+n^4 (-1085-30 I \[Omega])+n^3 (4898+280 I \[Omega])+n (5733+472 I \[Omega])+n^2 (-9018-744 I \[Omega])+70 I \[Omega]) c[-6+n]+2 (-394+168 n^5+l^4 (-25+12 n)+l^3 (-50+24 n)+l (-762+90 n^3+n^2 (-585-36 I \[Omega])+3 n (409+44 I \[Omega])-110 I \[Omega])+l^2 (-787+90 n^3+n^2 (-585-36 I \[Omega])+3 n (413+44 I \[Omega])-110 I \[Omega])+n^4 (-1855-180 I \[Omega])+2 n^3 (3641+720 I \[Omega])+n (7125+2036 I \[Omega])+n^2 (-11970-3372 I \[Omega])+214 I \[Omega]) c[-5+n]-2 (210 n^5+6 l^3 (-11+6 n-2 I \[Omega])+3 l^4 (-11+6 n-2 I \[Omega])+2 l (-341+60 n^3+4 n (151+57 I \[Omega])+n^2 (-330-72 I \[Omega])-172 I \[Omega])+l^2 (-715+120 n^3+n^2 (-660-144 I \[Omega])+2 n (613+228 I \[Omega])-350 I \[Omega])+n^4 (-1925-450 I \[Omega])+n (5035+3424 I \[Omega]-224 \[Omega]^2)+n^3 (6410+3000 I \[Omega]-96 \[Omega]^2)-4 (89-54 I \[Omega]+28 \[Omega]^2)+6 n^2 (-1535-1010 I \[Omega]+64 \[Omega]^2)) c[-4+n]+2 (168 n^5+l^4 (-19+12 n-12 I \[Omega])+l^3 (-38+24 n-24 I \[Omega])+n^4 (-1225-600 I \[Omega])+n (1971+2776 I \[Omega]-688 \[Omega]^2)+n^3 (3334+3200 I \[Omega]-384 \[Omega]^2)-4 (41-16 I \[Omega]+62 \[Omega]^2)+6 n^2 (-675-900 I \[Omega]+208 \[Omega]^2)+l (-314+90 n^3+n^2 (-405-216 I \[Omega])-384 I \[Omega]+40 \[Omega]^2+n (627+576 I \[Omega]-48 \[Omega]^2))+l^2 (-333+90 n^3+n^2 (-405-216 I \[Omega])-396 I \[Omega]+40 \[Omega]^2+n (639+576 I \[Omega]-48 \[Omega]^2))) c[-3+n]-2 (-34+84 n^5+2 l^3 (-4+3 n-6 I \[Omega])+l^4 (-4+3 n-6 I \[Omega])+n^4 (-455-450 I \[Omega])-14 I \[Omega]-160 \[Omega]^2-64 I \[Omega]^3+n^3 (950+1800 I \[Omega]-576 \[Omega]^2)+6 n^2 (-153-400 I \[Omega]+240 \[Omega]^2+16 I \[Omega]^3)+n (375+1064 I \[Omega]-720 \[Omega]^2-64 I \[Omega]^3)+l^2 (-70+36 n^3-182 I \[Omega]+80 \[Omega]^2-18 I n^2 (-7 I+8 \[Omega])+n (159+312 I \[Omega]-96 \[Omega]^2))+2 l (-33+18 n^3+n^2 (-63-72 I \[Omega])-88 I \[Omega]+40 \[Omega]^2+n (78+156 I \[Omega]-48 \[Omega]^2))) c[-2+n]+2 (-2+24 n^5+n^4 (-85-180 I \[Omega])-6 I \[Omega]-24 \[Omega]^2-64 I \[Omega]^3+n^3 (118+480 I \[Omega]-384 \[Omega]^2)+6 n^2 (-13-74 I \[Omega]+112 \[Omega]^2+32 I \[Omega]^3)+n (23+148 I \[Omega]-272 \[Omega]^2-128 I \[Omega]^3)+l (-4+6 n^3+n^2 (-15-36 I \[Omega])-26 I \[Omega]+40 \[Omega]^2+n (13+60 I \[Omega]-48 \[Omega]^2))+l^2 (-4+6 n^3+n^2 (-15-36 I \[Omega])-26 I \[Omega]+40 \[Omega]^2+n (13+60 I \[Omega]-48 \[Omega]^2))) c[-1+n]-2 n (3 n^4+n^3 (-5-30 I \[Omega])+16 (-1-4 I \[Omega]) \[Omega]^2+n^2 (2+40 I \[Omega]-96 \[Omega]^2)+12 n \[Omega] (-I+8 \[Omega]+8 I \[Omega]^2)) c[n]);

Do[c[i]=0;b[i]=0;,{i,-6,-1}];
b[0]=basis[[1]];
b[1]=basis[[2]];
c[0]=basis[[3]];
c[1]=(I (1+l+l^2) c[0])/(I+4 \[Omega]);

Do[c[i];b[i];,{i,2,nmax}];

rs=r+2M Log[r/(2M)-1];
rsp=1/(1-2M/r);
rsp2=-((2 M)/(-2 M+r)^2);
rsp3=-((4 M)/(2 M-r)^3);
rsp4=-((12 M)/(-2 M+r)^4);
rsp5=-((48 M)/(2 M-r)^5);
rsp6=-((240 M)/(-2 M+r)^6);
rsp7=-((1440 M)/(2 M-r)^7);


E^(-I rs \[Omega]) Sum[
{rsp^-i (b[i]+c[i] Log[1/rsp]),
rsp^(-1-i) ((-i rsp2-I rsp^2 \[Omega]) b[i]+c[i] (-I rsp^2 \[Omega] Log[1/rsp]-rsp2 (1+i Log[1/rsp]))),
rsp^(-2-i) ((i (1+i) rsp2^2-rsp^2 \[Omega] (I rsp2+rsp^2 \[Omega])+rsp (-i rsp3+2 I i rsp rsp2 \[Omega])) b[i]+c[i] (-rsp^2 \[Omega] (I rsp2+rsp^2 \[Omega]) Log[1/rsp]+I rsp (I rsp3+2 rsp rsp2 \[Omega]) (1+i Log[1/rsp])+rsp2^2 (1+2 i+i (1+i) Log[1/rsp]))),rsp^(-3-i) ((-i (2+3 i+i^2) rsp2^3+3 i (1+i) rsp rsp2 (rsp3-I rsp rsp2 \[Omega])+I rsp^3 \[Omega] (-rsp3+3 I rsp rsp2 \[Omega]+rsp^3 \[Omega]^2)+i rsp^2 (-rsp4+3 I rsp2^2 \[Omega]+3 I rsp rsp3 \[Omega]+3 rsp^2 rsp2 \[Omega]^2)) b[i]+c[i] (I rsp^3 \[Omega] (-rsp3+3 I rsp rsp2 \[Omega]+rsp^3 \[Omega]^2) Log[1/rsp]+rsp^2 (-rsp4+3 I rsp2^2 \[Omega]+3 I rsp rsp3 \[Omega]+3 rsp^2 rsp2 \[Omega]^2) (1+i Log[1/rsp])+3 rsp rsp2 (rsp3-I rsp rsp2 \[Omega]) (1+2 i+i (1+i) Log[1/rsp])-rsp2^3 (2+6 i+3 i^2+i (2+3 i+i^2) Log[1/rsp]))),
rsp^(-4-i) ((i (6+11 i+6 i^2+i^3) rsp2^4+2 I i (2+3 i+i^2) rsp rsp2^2 (3 I rsp3+2 rsp rsp2 \[Omega])-i (1+i) rsp^2 (-3 rsp3^2-4 rsp2 rsp4+6 I rsp2^3 \[Omega]+12 I rsp rsp2 rsp3 \[Omega]+6 rsp^2 rsp2^2 \[Omega]^2)+rsp^4 \[Omega] (-I rsp4-3 rsp2^2 \[Omega]-4 rsp rsp3 \[Omega]+6 I rsp^2 rsp2 \[Omega]^2+rsp^4 \[Omega]^3)+i rsp^3 (-rsp5+10 I rsp2 rsp3 \[Omega]+6 rsp^2 rsp3 \[Omega]^2-4 I rsp^3 rsp2 \[Omega]^3+4 rsp \[Omega] (I rsp4+3 rsp2^2 \[Omega]))) b[i]+c[i] (rsp^4 \[Omega] (-I rsp4-3 rsp2^2 \[Omega]-4 rsp rsp3 \[Omega]+6 I rsp^2 rsp2 \[Omega]^2+rsp^4 \[Omega]^3) Log[1/rsp]+rsp^3 (-rsp5+10 I rsp2 rsp3 \[Omega]+6 rsp^2 rsp3 \[Omega]^2-4 I rsp^3 rsp2 \[Omega]^3+4 rsp \[Omega] (I rsp4+3 rsp2^2 \[Omega])) (1+i Log[1/rsp])-rsp^2 (-3 rsp3^2-4 rsp2 rsp4+6 I rsp2^3 \[Omega]+12 I rsp rsp2 rsp3 \[Omega]+6 rsp^2 rsp2^2 \[Omega]^2) (1+2 i+i (1+i) Log[1/rsp])+2 I rsp rsp2^2 (3 I rsp3+2 rsp rsp2 \[Omega]) (2+6 i+3 i^2+i (2+3 i+i^2) Log[1/rsp])+rsp2^4 (6+22 i+18 i^2+4 i^3+i (6+11 i+6 i^2+i^3) Log[1/rsp]))),
rsp^(-5-i) (-i ((24+50 i+35 i^2+10 i^3+i^4) rsp2^5-10 (6+11 i+6 i^2+i^3) rsp rsp2^3 rsp3+10 (2+3 i+i^2) rsp^2 rsp2^2 rsp4+5 (1+i) rsp^2 rsp2 (3 (2+i) rsp3^2-rsp rsp5)+rsp^3 (-10 (1+i) rsp3 rsp4+rsp rsp6)) (b[i]+c[i] Log[1/rsp])-5 I i ((6+11 i+6 i^2+i^3) rsp2^4-6 (2+3 i+i^2) rsp rsp2^2 rsp3+4 (1+i) rsp^2 rsp2 rsp4+rsp^2 (3 (1+i) rsp3^2-rsp rsp5)) (rsp^2 \[Omega] b[i]+c[i] (-I rsp2+rsp^2 \[Omega] Log[1/rsp]))+10 i ((2+3 i+i^2) rsp2^3-3 (1+i) rsp rsp2 rsp3+rsp^2 rsp4) (rsp^2 \[Omega] (I rsp2+rsp^2 \[Omega]) b[i]+c[i] (-rsp2^2+rsp (rsp3-2 I rsp rsp2 \[Omega])+rsp^2 \[Omega] (I rsp2+rsp^2 \[Omega]) Log[1/rsp]))-10 i ((1+i) rsp2^2-rsp rsp3) (rsp^3 \[Omega] (I rsp3+3 rsp rsp2 \[Omega]-I rsp^3 \[Omega]^2) b[i]+c[i] (2 rsp2^3+3 I rsp rsp2 (I rsp3+rsp rsp2 \[Omega])+rsp^2 (rsp4-3 I rsp2^2 \[Omega]-3 I rsp rsp3 \[Omega]-3 rsp^2 rsp2 \[Omega]^2)+rsp^3 \[Omega] (I rsp3+3 rsp rsp2 \[Omega]-I rsp^3 \[Omega]^2) Log[1/rsp]))-5 i rsp2 (rsp^4 \[Omega] (-I rsp4-3 rsp2^2 \[Omega]-4 rsp rsp3 \[Omega]+6 I rsp^2 rsp2 \[Omega]^2+rsp^4 \[Omega]^3) b[i]+c[i] (6 rsp2^4+4 rsp rsp2^2 (-3 rsp3+2 I rsp rsp2 \[Omega])+rsp^2 (3 rsp3^2+4 rsp2 rsp4-6 I rsp2^3 \[Omega]-12 I rsp rsp2 rsp3 \[Omega]-6 rsp^2 rsp2^2 \[Omega]^2)+rsp^3 (-rsp5+10 I rsp2 rsp3 \[Omega]+6 rsp^2 rsp3 \[Omega]^2-4 I rsp^3 rsp2 \[Omega]^3+4 rsp \[Omega] (I rsp4+3 rsp2^2 \[Omega]))+rsp^4 \[Omega] (-I rsp4-3 rsp2^2 \[Omega]-4 rsp rsp3 \[Omega]+6 I rsp^2 rsp2 \[Omega]^2+rsp^4 \[Omega]^3) Log[1/rsp]))-I (rsp^5 \[Omega] (rsp5-10 I rsp2 rsp3 \[Omega]-10 rsp^2 rsp3 \[Omega]^2+10 I rsp^3 rsp2 \[Omega]^3+rsp^5 \[Omega]^4-5 rsp \[Omega] (I rsp4+3 rsp2^2 \[Omega])) b[i]+c[i] (-24 I rsp2^5+30 rsp rsp2^3 (2 I rsp3+rsp rsp2 \[Omega])+10 I rsp^2 rsp2 (-3 rsp3^2-2 rsp2 rsp4+2 I rsp2^3 \[Omega]+6 I rsp rsp2 rsp3 \[Omega]+2 rsp^2 rsp2^2 \[Omega]^2)-5 rsp^3 (-2 I rsp3 rsp4-2 rsp2^2 rsp3 \[Omega]+6 I rsp^2 rsp2 rsp3 \[Omega]^2+2 rsp^3 rsp2^2 \[Omega]^3+rsp \[Omega] (-3 rsp3^2-4 rsp2 rsp4+6 I rsp2^3 \[Omega])-rsp2 (I rsp5+6 rsp2 rsp3 \[Omega]))+rsp^4 (-I rsp6-10 rsp3^2 \[Omega]-10 rsp2 rsp4 \[Omega]+10 rsp^3 rsp3 \[Omega]^3-5 I rsp^4 rsp2 \[Omega]^4+5 rsp2 \[Omega] (-rsp4+3 I rsp2^2 \[Omega])+10 rsp^2 \[Omega]^2 (I rsp4+3 rsp2^2 \[Omega])+5 I rsp \[Omega] (I rsp5+10 rsp2 rsp3 \[Omega]))+rsp^5 \[Omega] (rsp5-10 I rsp2 rsp3 \[Omega]-10 rsp^2 rsp3 \[Omega]^2+10 I rsp^3 rsp2 \[Omega]^3+rsp^5 \[Omega]^4-5 rsp \[Omega] (I rsp4+3 rsp2^2 \[Omega])) Log[1/rsp]))),
rsp^(-6-i) ((120 rsp2^6-360 rsp rsp2^4 rsp3+120 rsp^2 rsp2^3 rsp4-30 rsp^2 rsp2^2 (-9 rsp3^2+rsp rsp5)+6 rsp^3 rsp2 (-20 rsp3 rsp4+rsp rsp6)+rsp^3 (-30 rsp3^3+15 rsp rsp3 rsp5+rsp (10 rsp4^2-rsp rsp7))) c[i]+6 I rsp^2 (24 rsp2^5-60 rsp rsp2^3 rsp3+20 rsp^2 rsp2^2 rsp4-5 rsp^2 rsp2 (-6 rsp3^2+rsp rsp5)+rsp^3 (-10 rsp3 rsp4+rsp rsp6)) \[Omega] c[i]+15 rsp^2 (-6 rsp2^4+12 rsp rsp2^2 rsp3-4 rsp^2 rsp2 rsp4+rsp^2 (-3 rsp3^2+rsp rsp5)) \[Omega] (I rsp2+rsp^2 \[Omega]) c[i]+20 rsp^3 (2 rsp2^3-3 rsp rsp2 rsp3+rsp^2 rsp4) \[Omega] (I rsp3+3 rsp rsp2 \[Omega]-I rsp^3 \[Omega]^2) c[i]-15 rsp^4 (-rsp2^2+rsp rsp3) \[Omega] (-I rsp4-3 rsp2^2 \[Omega]-4 rsp rsp3 \[Omega]+6 I rsp^2 rsp2 \[Omega]^2+rsp^4 \[Omega]^3) c[i]-6 rsp^5 rsp2 \[Omega] (-I rsp5-10 rsp2 rsp3 \[Omega]+10 I rsp^2 rsp3 \[Omega]^2+10 rsp^3 rsp2 \[Omega]^3-I rsp^5 \[Omega]^4+5 rsp \[Omega] (-rsp4+3 I rsp2^2 \[Omega])) c[i]+i ((120+274 i+225 i^2+85 i^3+15 i^4+i^5) rsp2^6-15 (24+50 i+35 i^2+10 i^3+i^4) rsp rsp2^4 rsp3+20 (6+11 i+6 i^2+i^3) rsp^2 rsp2^3 rsp4+15 (2+3 i+i^2) rsp^2 rsp2^2 (3 (3+i) rsp3^2-rsp rsp5)-6 (1+i) rsp^3 rsp2 (10 (2+i) rsp3 rsp4-rsp rsp6)+rsp^3 (-15 (2+3 i+i^2) rsp3^3+15 (1+i) rsp rsp3 rsp5+rsp (10 (1+i) rsp4^2-rsp rsp7))) (b[i]+c[i] Log[1/rsp])-rsp^6 \[Omega] (I rsp6+10 rsp3^2 \[Omega]+15 rsp2 rsp4 \[Omega]-15 I rsp2^3 \[Omega]^2-20 rsp^3 rsp3 \[Omega]^3+15 I rsp^4 rsp2 \[Omega]^4+rsp^6 \[Omega]^5-15 rsp^2 \[Omega]^2 (I rsp4+3 rsp2^2 \[Omega])+6 rsp \[Omega] (rsp5-10 I rsp2 rsp3 \[Omega])) (b[i]+c[i] Log[1/rsp])+6 i ((24+50 i+35 i^2+10 i^3+i^4) rsp2^5-10 (6+11 i+6 i^2+i^3) rsp rsp2^3 rsp3+10 (2+3 i+i^2) rsp^2 rsp2^2 rsp4+5 (1+i) rsp^2 rsp2 (3 (2+i) rsp3^2-rsp rsp5)+rsp^3 (-10 (1+i) rsp3 rsp4+rsp rsp6)) (I rsp^2 \[Omega] b[i]+c[i] (rsp2+I rsp^2 \[Omega] Log[1/rsp]))-15 i ((6+11 i+6 i^2+i^3) rsp2^4-6 (2+3 i+i^2) rsp rsp2^2 rsp3+4 (1+i) rsp^2 rsp2 rsp4+rsp^2 (3 (1+i) rsp3^2-rsp rsp5)) (rsp^2 \[Omega] (I rsp2+rsp^2 \[Omega]) b[i]+c[i] (-rsp2^2+rsp (rsp3-2 I rsp rsp2 \[Omega])+rsp^2 \[Omega] (I rsp2+rsp^2 \[Omega]) Log[1/rsp]))+20 i ((2+3 i+i^2) rsp2^3-3 (1+i) rsp rsp2 rsp3+rsp^2 rsp4) (rsp^3 \[Omega] (I rsp3+3 rsp rsp2 \[Omega]-I rsp^3 \[Omega]^2) b[i]+c[i] (2 rsp2^3+3 I rsp rsp2 (I rsp3+rsp rsp2 \[Omega])+rsp^2 (rsp4-3 I rsp2^2 \[Omega]-3 I rsp rsp3 \[Omega]-3 rsp^2 rsp2 \[Omega]^2)+rsp^3 \[Omega] (I rsp3+3 rsp rsp2 \[Omega]-I rsp^3 \[Omega]^2) Log[1/rsp]))+15 i ((1+i) rsp2^2-rsp rsp3) (rsp^4 \[Omega] (-I rsp4-3 rsp2^2 \[Omega]-4 rsp rsp3 \[Omega]+6 I rsp^2 rsp2 \[Omega]^2+rsp^4 \[Omega]^3) b[i]+c[i] (6 rsp2^4+4 rsp rsp2^2 (-3 rsp3+2 I rsp rsp2 \[Omega])+rsp^2 (3 rsp3^2+4 rsp2 rsp4-6 I rsp2^3 \[Omega]-12 I rsp rsp2 rsp3 \[Omega]-6 rsp^2 rsp2^2 \[Omega]^2)+rsp^3 (-rsp5+10 I rsp2 rsp3 \[Omega]+6 rsp^2 rsp3 \[Omega]^2-4 I rsp^3 rsp2 \[Omega]^3+4 rsp \[Omega] (I rsp4+3 rsp2^2 \[Omega]))+rsp^4 \[Omega] (-I rsp4-3 rsp2^2 \[Omega]-4 rsp rsp3 \[Omega]+6 I rsp^2 rsp2 \[Omega]^2+rsp^4 \[Omega]^3) Log[1/rsp]))+6 i rsp2 (rsp^5 \[Omega] (I rsp5+10 rsp2 rsp3 \[Omega]-10 I rsp^2 rsp3 \[Omega]^2-10 rsp^3 rsp2 \[Omega]^3+I rsp^5 \[Omega]^4+5 rsp \[Omega] (rsp4-3 I rsp2^2 \[Omega])) b[i]+c[i] (24 rsp2^5+30 I rsp rsp2^3 (2 I rsp3+rsp rsp2 \[Omega])-10 rsp^2 rsp2 (-3 rsp3^2-2 rsp2 rsp4+2 I rsp2^3 \[Omega]+6 I rsp rsp2 rsp3 \[Omega]+2 rsp^2 rsp2^2 \[Omega]^2)+5 rsp^3 (-2 rsp3 rsp4+2 I rsp2^2 rsp3 \[Omega]+6 rsp^2 rsp2 rsp3 \[Omega]^2-2 I rsp^3 rsp2^2 \[Omega]^3+rsp \[Omega] (3 I rsp3^2+4 I rsp2 rsp4+6 rsp2^3 \[Omega])+rsp2 (-rsp5+6 I rsp2 rsp3 \[Omega]))+rsp^4 (rsp6-10 I rsp3^2 \[Omega]-10 I rsp2 rsp4 \[Omega]+10 I rsp^3 rsp3 \[Omega]^3+5 rsp^4 rsp2 \[Omega]^4+10 rsp^2 \[Omega]^2 (-rsp4+3 I rsp2^2 \[Omega])-5 rsp2 \[Omega] (I rsp4+3 rsp2^2 \[Omega])-5 rsp \[Omega] (I rsp5+10 rsp2 rsp3 \[Omega]))+rsp^5 \[Omega] (I rsp5+10 rsp2 rsp3 \[Omega]-10 I rsp^2 rsp3 \[Omega]^2-10 rsp^3 rsp2 \[Omega]^3+I rsp^5 \[Omega]^4+5 rsp \[Omega] (rsp4-3 I rsp2^2 \[Omega])) Log[1/rsp])))},{i,0,nmax}]

];


(* ::Input::Initialization:: *)
$NDSolveOpts={AccuracyGoal->\[Infinity],InterpolationOrder->All};
$rminIn=2+10^-5;
$rmaxUp=10^4;
$nmax=30;
$rminUp=$r0-1;
$rmaxIn=$r0+1;


(* ::Input::Initialization:: *)
\[Psi]2Up[s_,l_,\[Omega]_]:=Module[{\[Psi],M=1,\[Psi]BC,\[Psi]pBC,\[Psi]ppBC},
{\[Psi]BC,\[Psi]pBC,\[Psi]ppBC}=OuterBCRW2[s,l,\[Omega],$nmax,$rmaxUp];
NDSolveValue[{\[ScriptCapitalL][s,l,\[Omega]][\[Psi]][r]==0,\[Psi][$rmaxUp]==\[Psi]BC,\[Psi]'[$rmaxUp]==\[Psi]pBC},\[Psi],{r,$rminUp,$rmaxUp},Splice[$NDSolveOpts,NDSolveValue]]
];


(* ::Input::Initialization:: *)
\[Psi]2In[s_,l_,\[Omega]_]:=Module[{\[Psi],M=1,\[Psi]BC,\[Psi]pBC,\[Psi]ppBC},
{\[Psi]BC,\[Psi]pBC,\[Psi]ppBC}=InnerBCRW2[s,l,\[Omega],$nmax,$rminIn];
NDSolveValue[{\[ScriptCapitalL][s,l,\[Omega]][\[Psi]][r]==0,\[Psi][$rminIn]==\[Psi]BC,\[Psi]'[$rminIn]==\[Psi]pBC},\[Psi],{r,$rminIn,$rmaxIn},Splice[$NDSolveOpts,NDSolveValue]]
];


(* ::Input::Initialization:: *)
\[Psi]4Up[s_,l_,\[Omega]_]:=Module[{\[Psi],M=1,\[Psi]BC,\[Psi]pBC,\[Psi]ppBC,\[Psi]pppBC,\[Psi]ppppBC},
{\[Psi]BC,\[Psi]pBC,\[Psi]ppBC,\[Psi]pppBC,\[Psi]ppppBC}=OuterBCRW4[s,l,\[Omega],$nmax,$rmaxUp];
NDSolveValue[{\[ScriptCapitalL]2[s,l,\[Omega]][\[Psi]][r]==0,\[Psi][$rmaxUp]==\[Psi]BC,\[Psi]'[$rmaxUp]==\[Psi]pBC,\[Psi]''[$rmaxUp]==\[Psi]ppBC,\[Psi]'''[$rmaxUp]==\[Psi]pppBC},\[Psi],{r,$rminUp,$rmaxUp},Splice[$NDSolveOpts,NDSolveValue]]
];


(* ::Input::Initialization:: *)
\[Psi]4In[s_,l_,\[Omega]_]:=Module[{\[Psi],M=1,\[Psi]BC,\[Psi]pBC,\[Psi]ppBC,\[Psi]pppBC,\[Psi]ppppBC},
{\[Psi]BC,\[Psi]pBC,\[Psi]ppBC,\[Psi]pppBC,\[Psi]ppppBC}=InnerBCRW4[s,l,\[Omega],$nmax,$rminIn];
NDSolveValue[{\[ScriptCapitalL]2[s,l,\[Omega]][\[Psi]][r]==0,\[Psi][$rminIn]==\[Psi]BC,\[Psi]'[$rminIn]==\[Psi]pBC,\[Psi]''[$rminIn]==\[Psi]ppBC,\[Psi]'''[$rminIn]==\[Psi]pppBC},\[Psi],{r,$rminIn,$rmaxIn},Splice[$NDSolveOpts,NDSolveValue]]
];


(* ::Input::Initialization:: *)
\[Psi]Z2Up[l_,\[Omega]_]:=Module[{\[Psi],M=1,\[Psi]BC,\[Psi]pBC,\[Psi]ppBC,\[Psi]pppBC,\[Psi]ppppBC},
{\[Psi]BC,\[Psi]pBC,\[Psi]ppBC,\[Psi]pppBC,\[Psi]ppppBC}=OuterBCZ2[l,\[Omega],$nmax,$rmaxUp];
NDSolveValue[{\[ScriptCapitalL]Z[l,\[Omega]][\[Psi]][r]==0,\[Psi][$rmaxUp]==\[Psi]BC,\[Psi]'[$rmaxUp]==\[Psi]pBC},\[Psi],{r,$rminUp,$rmaxUp},Splice[$NDSolveOpts,NDSolveValue]]
];


(* ::Input::Initialization:: *)
\[Psi]Z2In[l_,\[Omega]_]:=Module[{\[Psi],M=1,\[Psi]BC,\[Psi]pBC,\[Psi]ppBC,\[Psi]pppBC,\[Psi]ppppBC},
{\[Psi]BC,\[Psi]pBC,\[Psi]ppBC,\[Psi]pppBC,\[Psi]ppppBC}=InnerBCZ2[l,\[Omega],$nmax,$rminIn];
NDSolveValue[{\[ScriptCapitalL]Z[l,\[Omega]][\[Psi]][r]==0,\[Psi][$rminIn]==\[Psi]BC,\[Psi]'[$rminIn]==\[Psi]pBC},\[Psi],{r,$rminIn,$rmaxIn},Splice[$NDSolveOpts,NDSolveValue]]
];


(* ::Input::Initialization:: *)
\[Psi]Z4Up[l_,\[Omega]_]:=Module[{\[Psi],M=1,\[Psi]BC,\[Psi]pBC,\[Psi]ppBC,\[Psi]pppBC,\[Psi]ppppBC},
{\[Psi]BC,\[Psi]pBC,\[Psi]ppBC,\[Psi]pppBC,\[Psi]ppppBC}=OuterBCZ4[l,\[Omega],$nmax,$rmaxUp];
NDSolveValue[{\[ScriptCapitalL]Z2[l,\[Omega]][\[Psi]][r]==0,\[Psi][$rmaxUp]==\[Psi]BC,\[Psi]'[$rmaxUp]==\[Psi]pBC,\[Psi]''[$rmaxUp]==\[Psi]ppBC,\[Psi]'''[$rmaxUp]==\[Psi]pppBC},\[Psi],{r,$rminUp,$rmaxUp},Splice[$NDSolveOpts,NDSolveValue]]
];


(* ::Input::Initialization:: *)
\[Psi]Z4In[l_,\[Omega]_]:=Module[{\[Psi],M=1,\[Psi]BC,\[Psi]pBC,\[Psi]ppBC,\[Psi]pppBC,\[Psi]ppppBC},
{\[Psi]BC,\[Psi]pBC,\[Psi]ppBC,\[Psi]pppBC,\[Psi]ppppBC}=InnerBCZ4[l,\[Omega],$nmax,$rminIn];
NDSolveValue[{\[ScriptCapitalL]Z2[l,\[Omega]][\[Psi]][r]==0,\[Psi][$rminIn]==\[Psi]BC,\[Psi]'[$rminIn]==\[Psi]pBC,\[Psi]''[$rminIn]==\[Psi]ppBC,\[Psi]'''[$rminIn]==\[Psi]pppBC},\[Psi],{r,$rminIn,$rmaxIn},Splice[$NDSolveOpts,NDSolveValue]]
];


(* ::Input::Initialization:: *)
\[Chi]Up[l_,\[Omega]_,basis_:{1,0}]:=Module[{\[Psi],M=1,\[Psi]BC,\[Psi]pBC,\[Psi]ppBC,\[Psi]pppBC,\[Psi]ppppBC},
{\[Psi]BC,\[Psi]pBC,\[Psi]ppBC,\[Psi]pppBC,\[Psi]ppppBC}=OuterBC\[Chi][l,\[Omega],$nmax,$rmaxUp,basis];
NDSolveValue[{\[ScriptCapitalL]finv\[ScriptCapitalL][0,l,\[Omega]][\[Psi]][r]==0,\[Psi][$rmaxUp]==\[Psi]BC,\[Psi]'[$rmaxUp]==\[Psi]pBC,\[Psi]''[$rmaxUp]==\[Psi]ppBC,\[Psi]'''[$rmaxUp]==\[Psi]pppBC},\[Psi],{r,$rminUp,$rmaxUp},Splice[$NDSolveOpts,NDSolveValue]]
];


(* ::Input::Initialization:: *)
\[Chi]In[l_,\[Omega]_,basis_:{1,0}]:=Module[{\[Psi],M=1,\[Psi]BC,\[Psi]pBC,\[Psi]ppBC,\[Psi]pppBC,\[Psi]ppppBC},
{\[Psi]BC,\[Psi]pBC,\[Psi]ppBC,\[Psi]pppBC,\[Psi]ppppBC}=InnerBC\[Chi][l,\[Omega],$nmax,$rminIn,basis];
NDSolveValue[{\[ScriptCapitalL]finv\[ScriptCapitalL][0,l,\[Omega]][\[Psi]][r]==0,\[Psi][$rminIn]==\[Psi]BC,\[Psi]'[$rminIn]==\[Psi]pBC,\[Psi]''[$rminIn]==\[Psi]ppBC,\[Psi]'''[$rminIn]==\[Psi]pppBC},\[Psi],{r,$rminIn,$rmaxIn},Splice[$NDSolveOpts,NDSolveValue]]
];


(* ::Input::Initialization:: *)
\[Chi]1Up[l_,\[Omega]_,basis_:{1,0,0}]:=Module[{\[Psi],M=1,\[Psi]BC,\[Psi]pBC,\[Psi]ppBC,\[Psi]pppBC,\[Psi]ppppBC,\[Psi]pppppBC,\[Psi]ppppppBC},
{\[Psi]BC,\[Psi]pBC,\[Psi]ppBC,\[Psi]pppBC,\[Psi]ppppBC,\[Psi]pppppBC,\[Psi]ppppppBC}=OuterBC\[Chi]1[l,\[Omega],$nmax,$rmaxUp,basis];
NDSolveValue[{\[ScriptCapitalL]\[ScriptCapitalL]finv\[ScriptCapitalL][0,l,\[Omega]][\[Psi]][r]==0,\[Psi][$rmaxUp]==\[Psi]BC,\[Psi]'[$rmaxUp]==\[Psi]pBC,\[Psi]''[$rmaxUp]==\[Psi]ppBC,\[Psi]'''[$rmaxUp]==\[Psi]pppBC,\[Psi]''''[$rmaxUp]==\[Psi]ppppBC,\[Psi]'''''[$rmaxUp]==\[Psi]pppppBC},\[Psi],{r,$rminUp,$rmaxUp},Splice[$NDSolveOpts,NDSolveValue]]
];


(* ::Input::Initialization:: *)
\[Chi]1In[l_,\[Omega]_,basis_:{0,0,1}]:=Module[{\[Psi],M=1,\[Psi]BC,\[Psi]pBC,\[Psi]ppBC,\[Psi]pppBC,\[Psi]ppppBC,\[Psi]pppppBC,\[Psi]ppppppBC},
{\[Psi]BC,\[Psi]pBC,\[Psi]ppBC,\[Psi]pppBC,\[Psi]ppppBC,\[Psi]pppppBC,\[Psi]ppppppBC}=InnerBC\[Chi]1[l,\[Omega],$nmax,$rminIn,basis];
NDSolveValue[{\[ScriptCapitalL]\[ScriptCapitalL]finv\[ScriptCapitalL][0,l,\[Omega]][\[Psi]][r]==0,\[Psi][$rminIn]==\[Psi]BC,\[Psi]'[$rminIn]==\[Psi]pBC,\[Psi]''[$rminIn]==\[Psi]ppBC,\[Psi]'''[$rminIn]==\[Psi]pppBC,\[Psi]''''[$rminIn]==\[Psi]ppppBC,\[Psi]'''''[$rminIn]==\[Psi]pppppBC},\[Psi],{r,$rminIn,$rmaxIn},Splice[$NDSolveOpts,NDSolveValue]]
];


(* ::Input::Initialization:: *)
\[Chi]2Up[l_,\[Omega]_,basis_:{1,0,0}]:=Module[{\[Psi],M=1,\[Psi]BC,\[Psi]pBC,\[Psi]ppBC,\[Psi]pppBC,\[Psi]ppppBC,\[Psi]pppppBC,\[Psi]ppppppBC},
{\[Psi]BC,\[Psi]pBC,\[Psi]ppBC,\[Psi]pppBC,\[Psi]ppppBC,\[Psi]pppppBC,\[Psi]ppppppBC}=OuterBC\[Chi]2[l,\[Omega],$nmax,$rmaxUp,basis];
NDSolveValue[{\[ScriptCapitalL]finv\[ScriptCapitalL]\[ScriptCapitalL][0,l,\[Omega]][\[Psi]][r]==0,\[Psi][$rmaxUp]==\[Psi]BC,\[Psi]'[$rmaxUp]==\[Psi]pBC,\[Psi]''[$rmaxUp]==\[Psi]ppBC,\[Psi]'''[$rmaxUp]==\[Psi]pppBC,\[Psi]''''[$rmaxUp]==\[Psi]ppppBC,\[Psi]'''''[$rmaxUp]==\[Psi]pppppBC},\[Psi],{r,$rminUp,$rmaxUp},Splice[$NDSolveOpts,NDSolveValue]]
];


(* ::Input::Initialization:: *)
\[Chi]2In[l_,\[Omega]_,basis_:{1,0,0}]:=Module[{\[Psi],M=1,\[Psi]BC,\[Psi]pBC,\[Psi]ppBC,\[Psi]pppBC,\[Psi]ppppBC,\[Psi]pppppBC,\[Psi]ppppppBC},
{\[Psi]BC,\[Psi]pBC,\[Psi]ppBC,\[Psi]pppBC,\[Psi]ppppBC,\[Psi]pppppBC,\[Psi]ppppppBC}=InnerBC\[Chi]2[l,\[Omega],$nmax,$rminIn,basis];
NDSolveValue[{\[ScriptCapitalL]finv\[ScriptCapitalL]\[ScriptCapitalL][0,l,\[Omega]][\[Psi]][r]==0,\[Psi][$rminIn]==\[Psi]BC,\[Psi]'[$rminIn]==\[Psi]pBC,\[Psi]''[$rminIn]==\[Psi]ppBC,\[Psi]'''[$rminIn]==\[Psi]pppBC,\[Psi]''''[$rminIn]==\[Psi]ppppBC,\[Psi]'''''[$rminIn]==\[Psi]pppppBC},\[Psi],{r,$rminIn,$rmaxIn},Splice[$NDSolveOpts,NDSolveValue]]
];


(* ::Input::Initialization:: *)
\[Psi][s_,l_,m_,r0_]/;OddQ[l+m]:=Module[{M=1,\[CapitalOmega],\[Omega],\[CapitalPhi],J,dY,RIn,RUp,cin,cup},
\[CapitalOmega]=Sqrt[M/r0^3];
\[Omega]=m \[CapitalOmega];
Block[{$rminUp=r0-1,$rmaxIn=r0+1},
RIn=\[Psi]2In[s,l,\[Omega]];
RUp=\[Psi]2Up[s,l,\[Omega]];
];

\[CapitalPhi]={{-RIn[r0],RUp[r0]},{-RIn'[r0],RUp'[r0]}};
dY=Derivative[0,0,1,0][SphericalHarmonicY][l,m,\[Pi]/2,0];
J=Switch[s,
2,{(16 I m M \[Pi] Sqrt[-(r0/(3 M-r0))] Conjugate[dY])/((-1+l) l (1+l) (2+l) r0^2),-((16 I m M \[Pi] Sqrt[-(r0/(3 M-r0))] Conjugate[dY])/((-1+l) l (1+l) (2+l) r0^3))},
1,{-((16 I m M \[Pi] Sqrt[-(r0/(3 M-r0))] Conjugate[dY])/(3 l (1+l) r0^2)),-((32 I m M \[Pi] Sqrt[-(r0/(3 M-r0))] Conjugate[dY])/(3 l (1+l) r0^3))},
_,{Indeterminate,Indeterminate}];
{cin,cup}=LinearSolve[\[CapitalPhi],J];
Function[{r},Evaluate[Piecewise[{{cin RIn[r],r<r0},{cup RUp[r],r>r0}},Indeterminate]]]
];


(* ::Input::Initialization:: *)
\[Phi][s_,l_,m_,r0_]/;OddQ[l+m]:=Module[{M=1,\[CapitalOmega],\[Omega],\[CapitalPhi],J,dY,R2In,R2Up,R4In,R4Up,cin2,cup2,cin4,cup4},
\[CapitalOmega]=Sqrt[M/r0^3];
\[Omega]=m \[CapitalOmega];
Block[{$rminUp=r0-1,$rmaxIn=r0+1},
R2In=\[Psi]2In[s,l,\[Omega]];
R2Up=\[Psi]2Up[s,l,\[Omega]];
R4In=\[Psi]4In[s,l,\[Omega]];
R4Up=\[Psi]4Up[s,l,\[Omega]];
];

\[CapitalPhi]={{-R2In[r0],-R4In[r0],R2Up[r0],R4Up[r0]},
{-R2In'[r0],-R4In'[r0],R2Up'[r0],R4Up'[r0]},
{-R2In''[r0],-R4In''[r0],R2Up''[r0],R4Up''[r0]},
{-R2In'''[r0],-R4In'''[r0],R2Up'''[r0],R4Up'''[r0]}};
dY=Derivative[0,0,1,0][SphericalHarmonicY][l,m,\[Pi]/2,0];
J=Switch[s,
2,{(8 I m M \[Pi] (3 M-2 r0) Conjugate[dY])/((-1+l) l (1+l) (2+l) r0^(5/2) (-3 M+r0)^(3/2)),(8 I m M \[Pi] (-12 M^3-2 (-22+6 l+6 l^2+3 m^2) M^2 r0+(-31+10 l+10 l^2+2 m^2) M r0^2-2 (-3+l+l^2) r0^3) Conjugate[dY])/((-1+l) l (1+l) (2+l) r0^(7/2) (-3 M+r0)^(3/2) (-2 M+r0)^2),-((8 I m M \[Pi] (-48 M^4+2 (16+18 l+18 l^2+27 m^2) M^3 r0-(4+40 l+40 l^2+41 m^2) M^2 r0^2+(15 l+15 l^2+8 m^2) M r0^3-2 l (1+l) r0^4) Conjugate[dY])/((-1+l) l (1+l) (2+l) (2 M-r0)^3 r0^(9/2) (-3 M+r0)^(3/2))),(8 I m M \[Pi] (-288 M^5-24 (-42+5 l+5 l^2+10 m^2) M^4 r0+2 (-476+24 l^3+12 l^4+59 m^2+3 m^4+2 l (5+6 m^2)+2 l^2 (11+6 m^2)) M^3 r0^2+(356-64 l^3-32 l^4+21 m^2-2 m^4+l^2 (70-20 m^2)+l (102-20 m^2)) M^2 r0^3+(28 l^3+14 l^4-12 (4+m^2)+l (-61+4 m^2)+l^2 (-47+4 m^2)) M r0^4-2 l (-5-4 l+2 l^2+l^3) r0^5) Conjugate[dY])/((-1+l) l (1+l) (2+l) r0^(11/2) (-3 M+r0)^(3/2) (-2 M+r0)^4)},
1,{-((8 I m M \[Pi] (21 M-8 r0) Conjugate[dY])/(3 l (1+l) r0^(5/2) (-3 M+r0)^(3/2))),(16 I m M \[Pi] (-84 M^3+(104+6 l+6 l^2+3 m^2) M^2 r0-(43+5 l+5 l^2+m^2) M r0^2+(6+l+l^2) r0^3) Conjugate[dY])/(3 l (1+l) r0^(7/2) (-3 M+r0)^(3/2) (-2 M+r0)^2),-((8 I m M \[Pi] (336 M^4-2 (208+54 l+54 l^2+45 m^2) M^3 r0+(172+136 l+136 l^2+71 m^2) M^2 r0^2-(24+57 l+57 l^2+14 m^2) M r0^3+8 l (1+l) r0^4) Conjugate[dY])/(3 l (1+l) (2 M-r0)^3 r0^(9/2) (-3 M+r0)^(3/2))),-(1/(3 l (1+l) r0^(9/2) (-3 M+r0)^(3/2) (-2 M+r0)^4))16 I m M \[Pi] (-6 (-56+28 l+28 l^2+65 m^2) M^4+(-416+24 l^3+12 l^4+389 m^2+3 m^4+4 l (46+3 m^2)+4 l^2 (49+3 m^2)) M^3 r0-(-172+32 l^3+16 l^4+123 m^2+m^4+10 l^2 (7+m^2)+2 l (27+5 m^2)) M^2 r0^2+(14 l^3+7 l^4+12 (-2+m^2)+2 l (-1+m^2)+l^2 (5+2 m^2)) M r0^3+l (2+l-2 l^2-l^3) r0^4) Conjugate[dY]},
_,{Indeterminate,Indeterminate}];
{cin2,cin4,cup2,cup4}=LinearSolve[\[CapitalPhi],J];
Function[{r},Evaluate[Piecewise[{{cin2 R2In[r]+cin4 R4In[r],r<r0},{cup2 R2Up[r]+cup4 R4Up[r],r>r0}},Indeterminate]]]
];


(* ::Input::Initialization:: *)
\[Psi]Z[l_,m_,r0_]/;EvenQ[l+m]:=Module[{M=1,\[CapitalOmega],\[Omega],\[CapitalPhi],J,Y,RIn,RUp,cin,cup},
\[CapitalOmega]=Sqrt[M/r0^3];
\[Omega]=m \[CapitalOmega];
Block[{$rminUp=r0-1,$rmaxIn=r0+1},
RIn=\[Psi]Z2In[l,\[Omega]];
RUp=\[Psi]Z2Up[l,\[Omega]];
];

\[CapitalPhi]={{-RIn[r0],RUp[r0]},{-RIn'[r0],RUp'[r0]}};
Y=SphericalHarmonicY[l,m,\[Pi]/2,0];
J={(32 \[Pi] (-2+r0)^3 Sqrt[r0/(-3+r0)] Conjugate[Y])/(l (1+l) (-2 M+r0)^2 (6+(-2+l+l^2) r0)),1/(2 M-r0)^2 r0^2 (-((64 M \[Pi] (-2+r0)^3 Sqrt[r0/(-3+r0)] Conjugate[Y])/(l (1+l) (2 M-r0) r0^3 (6+(-2+l+l^2) r0)))-1/((-1+l) l (1+l) (2+l) r0^3 (6+(-2+l+l^2) r0)^2) 16 \[Pi] (-2+r0) Sqrt[r0/(-3+r0)] (3 l^5 (-1+r0) r0^2+l^6 (-1+r0) r0^2-8 (-24+m^2 (-3+r0)^2+22 r0-5 r0^2)-l^4 r0 (8+(-11+2 m^2) r0+r0^2)-l^3 r0 (16+(-27+4 m^2) r0+7 r0^2)+6 l^2 (-10-4 (-4+m^2) r0+(-5+m^2) r0^2)+4 l (-15+(26-6 m^2) r0+(-11+2 m^2) r0^2+r0^3)) Conjugate[Y])};
{cin,cup}=LinearSolve[\[CapitalPhi],J];
Function[{r},Evaluate[Piecewise[{{cin RIn[r],r<=r0},{cup RUp[r],r>r0}},Indeterminate]]]
];


(* ::Input::Initialization:: *)
\[Phi]Z[l_,m_,r0_]/;EvenQ[l+m]:=Module[{M=1,\[CapitalOmega],\[Omega],\[CapitalPhi],J,Y,R2In,R2Up,R4In,R4Up,cin2,cup2,cin4,cup4},
\[CapitalOmega]=Sqrt[M/r0^3];
\[Omega]=m \[CapitalOmega];
Block[{$rminUp=r0-1,$rmaxIn=r0+1},
R2In=\[Psi]Z2In[l,\[Omega]];
R2Up=\[Psi]Z2Up[l,\[Omega]];
R4In=\[Psi]Z4In[l,\[Omega]];
R4Up=\[Psi]Z4Up[l,\[Omega]];
];

\[CapitalPhi]={{-R2In[r0],-R4In[r0],R2Up[r0],R4Up[r0]},
{-R2In'[r0],-R4In'[r0],R2Up'[r0],R4Up'[r0]},
{-R2In''[r0],-R4In''[r0],R2Up''[r0],R4Up''[r0]},
{-R2In'''[r0],-R4In'''[r0],R2Up'''[r0],R4Up'''[r0]}};
Y=SphericalHarmonicY[l,m,\[Pi]/2,0];
J={(16 \[Pi] (1/(-3+r0))^(3/2) (-2+r0) (r0 (6 (-28+11 l (1+l)+6 m^2)+(136-24 m^2+l (1+l) (-68+3 l (1+l)+6 m^2)) r0-(-1+l) (2+l) (-13+4 l (1+l)+2 m^2) r0^2+(-1+l) l (1+l) (2+l) r0^3)+2 M (6 (4+l+l^2-6 m^2)+8 (7+3 m^2) r0-l (1+l) (28+3 l (1+l)+6 m^2) r0+(-1+l) (2+l) (29+4 l (1+l)+2 m^2) r0^2-(-1+l) (2+l) (6+l+l^2) r0^3)) Conjugate[Y])/((-1+l) l (1+l) (2+l) Sqrt[r0] (-2 M+r0)^3 (6+(-2+l+l^2) r0)),
-((8 \[Pi] (r0/(-3+r0))^(3/2) (144 M^4 (4 l^7 r0^3 (18-17 r0+3 r0^2)+l^8 r0^3 (18-17 r0+3 r0^2)+2 l^6 r0^2 (-66+(151+18 m^2) r0-(118+11 m^2) r0^2+(29+2 m^2) r0^3-2 r0^4)-2 l^5 r0^2 (198-3 (109+18 m^2) r0+(235+33 m^2) r0^2-6 (11+m^2) r0^3+6 r0^4)+l^4 r0 (-648+24 (59+27 m^2) r0-12 (137+42 m^2) r0^2+23 (35+6 m^2) r0^3-3 (55+4 m^2) r0^4+12 r0^5)+2 l^3 r0 (-648+18 (97+36 m^2) r0-(2147+594 m^2) r0^2+(1157+193 m^2) r0^3-2 (134+11 m^2) r0^4+22 r0^5)-8 l (270-9 (59+54 m^2) r0+(879+621 m^2) r0^2-6 (131+51 m^2) r0^3+(343+69 m^2) r0^4-6 (12+m^2) r0^5+6 r0^6)-4 l^2 (540-36 (25+27 m^2) r0+45 (29+24 m^2) r0^2-3 (337+153 m^2) r0^3+(380+87 m^2) r0^4-6 (12+m^2) r0^5+6 r0^6)+16 (-3+r0) (72+48 r0-130 r0^2+70 r0^3-17 r0^4+2 r0^5-m^2 (-3+r0)^2 (18-11 r0+2 r0^2)))+(-2+l+l^2)^2 r0^4 (4 l^7 r0^2 (96-146 r0+81 r0^2-21 r0^3+2 r0^4)+l^8 r0^2 (96-146 r0+81 r0^2-21 r0^3+2 r0^4)+2 l^6 r0 (576-870 r0+(461+30 m^2) r0^2-3 (38+7 m^2) r0^3+2 (5+2 m^2) r0^4)-2 l^5 r0 (-1728+3282 r0-5 (481+18 m^2) r0^2+9 (101+7 m^2) r0^3-3 (59+4 m^2) r0^4+14 r0^5)+l^4 (3456-3384 r0+24 (-61+45 m^2) r0^2+(2476-936 m^2) r0^3+9 (-109+30 m^2) r0^4-3 (-55+8 m^2) r0^5-10 r0^6)-8 l (-486-135 (-17+6 m^2) r0+27 (-97+41 m^2) r0^2+(1231-576 m^2) r0^3+27 (-9+5 m^2) r0^4+(9-12 m^2) r0^5+2 r0^6)+4 l^2 (1836+180 (-35+9 m^2) r0+(6585-1944 m^2) r0^2+(-3155+873 m^2) r0^3-9 (-84+19 m^2) r0^4+3 (-27+4 m^2) r0^5+2 r0^6)+2 l^3 (3456-6264 r0+90 (47+12 m^2) r0^2-(1873+1086 m^2) r0^3+(723+375 m^2) r0^4-(179+44 m^2) r0^5+18 r0^6)-16 (-3+r0) (-720+1092 r0-640 r0^2+177 r0^3-20 r0^4+m^2 (-3+r0)^2 (30-21 r0+4 r0^2)))-48 M^3 r0 (l^10 r0^3 (-18+17 r0-3 r0^2)-5 l^9 r0^3 (18-17 r0+3 r0^2)+l^8 r0^2 (180-6 (59+6 m^2) r0+(246+22 m^2) r0^2-(55+4 m^2) r0^3+3 r0^4)+2 l^7 r0^2 (360-6 (73+12 m^2) r0+(237+44 m^2) r0^2-(65+8 m^2) r0^3+6 r0^4)+l^6 r0 (1224-12 (197+48 m^2) r0+6 (449+80 m^2) r0^2-(1551+122 m^2) r0^3-(-362+m^2) r0^4+3 (-10+m^2) r0^5)+l^5 r0 (3672-108 (89+16 m^2) r0+6 (1795+324 m^2) r0^2-(5955+674 m^2) r0^3+(1478+53 m^2) r0^4+3 (-44+3 m^2) r0^5)+l^3 (7776-1512 (13+4 m^2) r0+12 (2761+1092 m^2) r0^2-12 (2867+674 m^2) r0^3+2 (8898+869 m^2) r0^4+(-4261+11 m^2) r0^5+(384-33 m^2) r0^6)+l^4 (3888-144 (47+21 m^2) r0+72 (113+71 m^2) r0^2-6 (1301+390 m^2) r0^3+32 (117+8 m^2) r0^4+(-838+59 m^2) r0^5+(75-9 m^2) r0^6)-8 (-3+r0) (-1512+444 r0+1134 r0^2-871 r0^3+251 r0^4-30 r0^5+m^2 (-3+r0)^2 (192-104 r0+8 r0^2+3 r0^3))+4 l (-1296+3744 r0-9504 r0^2+9897 r0^3-4724 r0^4+1073 r0^5-96 r0^6+m^2 (-3+r0)^2 (-144+672 r0-326 r0^2+23 r0^3+9 r0^4))+2 l^2 (-648+2268 r0-9864 r0^2+10236 r0^3-4476 r0^4+949 r0^5-84 r0^6+m^2 (-2592+12312 r0-10800 r0^2+3474 r0^3-268 r0^4-65 r0^5+9 r0^6)))-4 (-2+l+l^2) M r0^3 (5 l^9 r0^2 (48-64 r0+32 r0^2-9 r0^3+r0^4)+l^10 r0^2 (48-64 r0+32 r0^2-9 r0^3+r0^4)+l^8 r0 (576+24 (-43+m^2) r0+(746+4 m^2) r0^2-(291+2 m^2) r0^3-3 (-16+m^2) r0^4+(-2+m^2) r0^5)+2 l^7 r0 (1152+48 (-58+m^2) r0+4 (613+2 m^2) r0^2-2 (531+2 m^2) r0^3+(231-6 m^2) r0^4+(-19+2 m^2) r0^5)+l^5 (5184+288 (-67+3 m^2) r0+12 (2173+44 m^2) r0^2-2 (9413+634 m^2) r0^3+(7998+418 m^2) r0^4+3 (-593+8 m^2) r0^5+(157-20 m^2) r0^6)+l^6 (1728+288 (-13+m^2) r0+12 (155+24 m^2) r0^2-2 (53+202 m^2) r0^3+2 (-18+65 m^2) r0^4+(9-6 m^2) r0^5+(1-2 m^2) r0^6)+16 (-3+r0) (-2376+3072 r0-1358 r0^2+182 r0^3+33 r0^4-10 r0^5+m^2 (-3+r0)^2 (130-83 r0+12 r0^2+r0^3))-8 l (3186-9261 r0+7443 r0^2-1605 r0^3-539 r0^4+291 r0^5-36 r0^6+m^2 (-3+r0)^2 (-96+454 r0-251 r0^2+30 r0^3+4 r0^4))-4 l^2 (8748-22176 r0+18195 r0^2-6302 r0^3+732 r0^4+87 r0^5-22 r0^6+2 m^2 (-972+4428 r0-4197 r0^2+1597 r0^3-245 r0^4+6 r0^5+r0^6))+l^4 (-4320-6408 r0+17328 r0^2-10552 r0^3+2559 r0^4-204 r0^5-8 r0^6+m^2 (864+2736 r0-6600 r0^2+3784 r0^3-776 r0^4+33 r0^5+r0^6))+2 l^3 (-8640+11016 r0-7890 r0^2+8317 r0^3-5505 r0^4+1593 r0^5-166 r0^6+m^2 (864+2016 r0-6984 r0^2+4850 r0^3-1129 r0^4+6 r0^5+20 r0^6)))-4 M^2 r0^2 (l^12 r0^3 (-18+17 r0-3 r0^2)-6 l^11 r0^3 (18-17 r0+3 r0^2)-10 l^9 r0^2 (-162+3 (43+6 m^2) r0-(19+11 m^2) r0^2+2 (1+m^2) r0^3)+l^10 r0^2 (324-12 (38+3 m^2) r0+(225+22 m^2) r0^2-(37+4 m^2) r0^3)+6 l^8 r0 (492-2 (437+30 m^2) r0+(998+74 m^2) r0^2-(659+16 m^2) r0^3-6 (-28+m^2) r0^4+(-15+2 m^2) r0^5)+6 l^7 r0 (1968-4 (1279+60 m^2) r0+(5084+476 m^2) r0^2-29 (91+6 m^2) r0^3+(659-4 m^2) r0^4+(-60+8 m^2) r0^5)-3 l^6 (-3024+24 (233+6 m^2) r0-8 (512+297 m^2) r0^2+2 (2245+652 m^2) r0^3-(2877+80 m^2) r0^4+(733-68 m^2) r0^5+8 (-9+m^2) r0^6)-6 l^5 (-4536+12 (1273+18 m^2) r0-4 (6296+1101 m^2) r0^2+(25234+3748 m^2) r0^3-2 (6749+403 m^2) r0^4+(3387-102 m^2) r0^5+(-318+40 m^2) r0^6)+16 (-3+r0) (-10800+10308 r0-1176 r0^2-1735 r0^3+764 r0^4-108 r0^5+m^2 (-3+r0)^2 (822-473 r0+44 r0^2+12 r0^3))-8 l (17982-29907 r0-2265 r0^2+25461 r0^3-16437 r0^4+4267 r0^5-414 r0^6+m^2 (-3+r0)^2 (-1584+3642 r0-1579 r0^2+76 r0^3+48 r0^4))+3 l^4 (-6480-5496 r0+7972 r0^2+640 r0^3-1909 r0^4+569 r0^5-66 r0^6+2 m^2 (432+8208 r0-9780 r0^2+3458 r0^3-239 r0^4-62 r0^5+2 r0^6))-12 l^2 (15876-26940 r0+11183 r0^2+2183 r0^3-2752 r0^4+765 r0^5-78 r0^6+m^2 (-9720+23976 r0-17916 r0^2+5399 r0^3-469 r0^4-60 r0^5+8 r0^6))+2 l^3 (-42120+66780 r0-121530 r0^2+146877 r0^3-82363 r0^4+20919 r0^5-1998 r0^6+3 m^2 (864+16776 r0-27180 r0^2+13778 r0^3-2061 r0^4-292 r0^5+80 r0^6)))) Conjugate[Y])/(l (1+l) (-2+l+l^2) r0^3 (-2 M+r0)^4 (6+(-2+l+l^2) r0)^3 (6 M+(-2+l+l^2) r0)^2)),
(16 \[Pi] (1/(l (-2 M+r0)^2) 8 (2 M-r0) (-2+r0)^3 r0 Sqrt[r0/(-3+r0)] (6+(-2+l+l^2) r0)^2 (6 M+(-2+l+l^2) r0)^2 (51408 M^6+216 (-386+123 l+123 l^2+3 m^2) M^5 r0+36 (1504+262 l^3+131 l^4-18 m^2+l (-960+9 m^2)+l^2 (-829+9 m^2)) M^4 r0^2+6 (-2+l+l^2) (1468+114 l^3+57 l^4-18 m^2+l (-680+9 m^2)+l^2 (-623+9 m^2)) M^3 r0^3+3 (-2+l+l^2)^2 (240+8 l^3+4 l^4-2 m^2+l (-76+m^2)+l^2 (-72+m^2)) M^2 r0^4-8 (-3+l+l^2) (-2+l+l^2)^3 M r0^5+l (1+l) (-2+l+l^2)^3 r0^6)-1/((-1+l) l (2+l) (-2 M+r0)^3) 72 (-34+12 l+12 l^2+m^2) M^3 (2 M-r0) (1/(-3+r0))^(3/2) (-2+r0) r0^(5/2) (6+(-2+l+l^2) r0)^2 (6 M+(-2+l+l^2) r0)^2 (12 M^2+2 (-5+l+l^2) M r0-(-2+l+l^2) r0^2) (r0 (6 (-28+11 l (1+l)+6 m^2)+(136-24 m^2+l (1+l) (-68+3 l (1+l)+6 m^2)) r0-(-1+l) (2+l) (-13+4 l (1+l)+2 m^2) r0^2+(-1+l) l (1+l) (2+l) r0^3)+2 M (6 (4+l+l^2-6 m^2)+8 (7+3 m^2) r0-l (1+l) (28+3 l (1+l)+6 m^2) r0+(-1+l) (2+l) (29+4 l (1+l)+2 m^2) r0^2-(-1+l) (2+l) (6+l+l^2) r0^3))-1/((-1+l) l (2+l) (-2 M+r0)^3) 12 (-2+l+l^2) (-36+7 l+7 l^2+2 m^2) M^2 (2 M-r0) (1/(-3+r0))^(3/2) (-2+r0) r0^(7/2) (6+(-2+l+l^2) r0)^2 (6 M+(-2+l+l^2) r0)^2 (12 M^2+2 (-5+l+l^2) M r0-(-2+l+l^2) r0^2) (r0 (6 (-28+11 l (1+l)+6 m^2)+(136-24 m^2+l (1+l) (-68+3 l (1+l)+6 m^2)) r0-(-1+l) (2+l) (-13+4 l (1+l)+2 m^2) r0^2+(-1+l) l (1+l) (2+l) r0^3)+2 M (6 (4+l+l^2-6 m^2)+8 (7+3 m^2) r0-l (1+l) (28+3 l (1+l)+6 m^2) r0+(-1+l) (2+l) (29+4 l (1+l)+2 m^2) r0^2-(-1+l) (2+l) (6+l+l^2) r0^3))-1/((-1+l) l (2+l) (-2 M+r0)^3) 2 (-2+l+l^2)^2 (-14+2 l+2 l^2+m^2) M (2 M-r0) (1/(-3+r0))^(3/2) (-2+r0) r0^(9/2) (6+(-2+l+l^2) r0)^2 (6 M+(-2+l+l^2) r0)^2 (12 M^2+2 (-5+l+l^2) M r0-(-2+l+l^2) r0^2) (r0 (6 (-28+11 l (1+l)+6 m^2)+(136-24 m^2+l (1+l) (-68+3 l (1+l)+6 m^2)) r0-(-1+l) (2+l) (-13+4 l (1+l)+2 m^2) r0^2+(-1+l) l (1+l) (2+l) r0^3)+2 M (6 (4+l+l^2-6 m^2)+8 (7+3 m^2) r0-l (1+l) (28+3 l (1+l)+6 m^2) r0+(-1+l) (2+l) (29+4 l (1+l)+2 m^2) r0^2-(-1+l) (2+l) (6+l+l^2) r0^3))+1/(-2 M+r0)^3 2 (-2+l+l^2) (2 M-r0) (1/(-3+r0))^(3/2) (-2+r0) r0^(11/2) (6+(-2+l+l^2) r0)^2 (6 M+(-2+l+l^2) r0)^2 (12 M^2+2 (-5+l+l^2) M r0-(-2+l+l^2) r0^2) (r0 (6 (-28+11 l (1+l)+6 m^2)+(136-24 m^2+l (1+l) (-68+3 l (1+l)+6 m^2)) r0-(-1+l) (2+l) (-13+4 l (1+l)+2 m^2) r0^2+(-1+l) l (1+l) (2+l) r0^3)+2 M (6 (4+l+l^2-6 m^2)+8 (7+3 m^2) r0-l (1+l) (28+3 l (1+l)+6 m^2) r0+(-1+l) (2+l) (29+4 l (1+l)+2 m^2) r0^2-(-1+l) (2+l) (6+l+l^2) r0^3))+1/(-2 M+r0)^3 2 l (-2+l+l^2) (2 M-r0) (1/(-3+r0))^(3/2) (-2+r0) r0^(11/2) (6+(-2+l+l^2) r0)^2 (6 M+(-2+l+l^2) r0)^2 (12 M^2+2 (-5+l+l^2) M r0-(-2+l+l^2) r0^2) (r0 (6 (-28+11 l (1+l)+6 m^2)+(136-24 m^2+l (1+l) (-68+3 l (1+l)+6 m^2)) r0-(-1+l) (2+l) (-13+4 l (1+l)+2 m^2) r0^2+(-1+l) l (1+l) (2+l) r0^3)+2 M (6 (4+l+l^2-6 m^2)+8 (7+3 m^2) r0-l (1+l) (28+3 l (1+l)+6 m^2) r0+(-1+l) (2+l) (29+4 l (1+l)+2 m^2) r0^2-(-1+l) (2+l) (6+l+l^2) r0^3))-1/((-1+l) l (2+l) (-2 M+r0)^3) 2448 M^4 (2 M-r0) (-2+r0) (r0/(-3+r0))^(3/2) (6+(-2+l+l^2) r0)^2 (6 M+(-2+l+l^2) r0)^2 (12 M^2+2 (-5+l+l^2) M r0-(-2+l+l^2) r0^2) (r0 (6 (-28+11 l (1+l)+6 m^2)+(136-24 m^2+l (1+l) (-68+3 l (1+l)+6 m^2)) r0-(-1+l) (2+l) (-13+4 l (1+l)+2 m^2) r0^2+(-1+l) l (1+l) (2+l) r0^3)+2 M (6 (4+l+l^2-6 m^2)+8 (7+3 m^2) r0-l (1+l) (28+3 l (1+l)+6 m^2) r0+(-1+l) (2+l) (29+4 l (1+l)+2 m^2) r0^2-(-1+l) (2+l) (6+l+l^2) r0^3))+1/(l (-2+l+l^2) (-2 M+r0)^4) 144 M^4 (2 M-r0) (r0/(-3+r0))^(3/2) (12 M^2+2 (-5+l+l^2) M r0-(-2+l+l^2) r0^2) (144 M^4 (4 l^7 r0^3 (18-17 r0+3 r0^2)+l^8 r0^3 (18-17 r0+3 r0^2)+2 l^6 r0^2 (-66+(151+18 m^2) r0-(118+11 m^2) r0^2+(29+2 m^2) r0^3-2 r0^4)-2 l^5 r0^2 (198-3 (109+18 m^2) r0+(235+33 m^2) r0^2-6 (11+m^2) r0^3+6 r0^4)+l^4 r0 (-648+24 (59+27 m^2) r0-12 (137+42 m^2) r0^2+23 (35+6 m^2) r0^3-3 (55+4 m^2) r0^4+12 r0^5)+2 l^3 r0 (-648+18 (97+36 m^2) r0-(2147+594 m^2) r0^2+(1157+193 m^2) r0^3-2 (134+11 m^2) r0^4+22 r0^5)-8 l (270-9 (59+54 m^2) r0+(879+621 m^2) r0^2-6 (131+51 m^2) r0^3+(343+69 m^2) r0^4-6 (12+m^2) r0^5+6 r0^6)-4 l^2 (540-36 (25+27 m^2) r0+45 (29+24 m^2) r0^2-3 (337+153 m^2) r0^3+(380+87 m^2) r0^4-6 (12+m^2) r0^5+6 r0^6)+16 (-3+r0) (72+48 r0-130 r0^2+70 r0^3-17 r0^4+2 r0^5-m^2 (-3+r0)^2 (18-11 r0+2 r0^2)))+(-2+l+l^2)^2 r0^4 (4 l^7 r0^2 (96-146 r0+81 r0^2-21 r0^3+2 r0^4)+l^8 r0^2 (96-146 r0+81 r0^2-21 r0^3+2 r0^4)+2 l^6 r0 (576-870 r0+(461+30 m^2) r0^2-3 (38+7 m^2) r0^3+2 (5+2 m^2) r0^4)-2 l^5 r0 (-1728+3282 r0-5 (481+18 m^2) r0^2+9 (101+7 m^2) r0^3-3 (59+4 m^2) r0^4+14 r0^5)+l^4 (3456-3384 r0+24 (-61+45 m^2) r0^2+(2476-936 m^2) r0^3+9 (-109+30 m^2) r0^4-3 (-55+8 m^2) r0^5-10 r0^6)-8 l (-486-135 (-17+6 m^2) r0+27 (-97+41 m^2) r0^2+(1231-576 m^2) r0^3+27 (-9+5 m^2) r0^4+(9-12 m^2) r0^5+2 r0^6)+4 l^2 (1836+180 (-35+9 m^2) r0+(6585-1944 m^2) r0^2+(-3155+873 m^2) r0^3-9 (-84+19 m^2) r0^4+3 (-27+4 m^2) r0^5+2 r0^6)+2 l^3 (3456-6264 r0+90 (47+12 m^2) r0^2-(1873+1086 m^2) r0^3+(723+375 m^2) r0^4-(179+44 m^2) r0^5+18 r0^6)-16 (-3+r0) (-720+1092 r0-640 r0^2+177 r0^3-20 r0^4+m^2 (-3+r0)^2 (30-21 r0+4 r0^2)))-48 M^3 r0 (l^10 r0^3 (-18+17 r0-3 r0^2)-5 l^9 r0^3 (18-17 r0+3 r0^2)+l^8 r0^2 (180-6 (59+6 m^2) r0+(246+22 m^2) r0^2-(55+4 m^2) r0^3+3 r0^4)+2 l^7 r0^2 (360-6 (73+12 m^2) r0+(237+44 m^2) r0^2-(65+8 m^2) r0^3+6 r0^4)+l^6 r0 (1224-12 (197+48 m^2) r0+6 (449+80 m^2) r0^2-(1551+122 m^2) r0^3-(-362+m^2) r0^4+3 (-10+m^2) r0^5)+l^5 r0 (3672-108 (89+16 m^2) r0+6 (1795+324 m^2) r0^2-(5955+674 m^2) r0^3+(1478+53 m^2) r0^4+3 (-44+3 m^2) r0^5)+l^3 (7776-1512 (13+4 m^2) r0+12 (2761+1092 m^2) r0^2-12 (2867+674 m^2) r0^3+2 (8898+869 m^2) r0^4+(-4261+11 m^2) r0^5+(384-33 m^2) r0^6)+l^4 (3888-144 (47+21 m^2) r0+72 (113+71 m^2) r0^2-6 (1301+390 m^2) r0^3+32 (117+8 m^2) r0^4+(-838+59 m^2) r0^5+(75-9 m^2) r0^6)-8 (-3+r0) (-1512+444 r0+1134 r0^2-871 r0^3+251 r0^4-30 r0^5+m^2 (-3+r0)^2 (192-104 r0+8 r0^2+3 r0^3))+4 l (-1296+3744 r0-9504 r0^2+9897 r0^3-4724 r0^4+1073 r0^5-96 r0^6+m^2 (-3+r0)^2 (-144+672 r0-326 r0^2+23 r0^3+9 r0^4))+2 l^2 (-648+2268 r0-9864 r0^2+10236 r0^3-4476 r0^4+949 r0^5-84 r0^6+m^2 (-2592+12312 r0-10800 r0^2+3474 r0^3-268 r0^4-65 r0^5+9 r0^6)))-4 (-2+l+l^2) M r0^3 (5 l^9 r0^2 (48-64 r0+32 r0^2-9 r0^3+r0^4)+l^10 r0^2 (48-64 r0+32 r0^2-9 r0^3+r0^4)+l^8 r0 (576+24 (-43+m^2) r0+(746+4 m^2) r0^2-(291+2 m^2) r0^3-3 (-16+m^2) r0^4+(-2+m^2) r0^5)+2 l^7 r0 (1152+48 (-58+m^2) r0+4 (613+2 m^2) r0^2-2 (531+2 m^2) r0^3+(231-6 m^2) r0^4+(-19+2 m^2) r0^5)+l^5 (5184+288 (-67+3 m^2) r0+12 (2173+44 m^2) r0^2-2 (9413+634 m^2) r0^3+(7998+418 m^2) r0^4+3 (-593+8 m^2) r0^5+(157-20 m^2) r0^6)+l^6 (1728+288 (-13+m^2) r0+12 (155+24 m^2) r0^2-2 (53+202 m^2) r0^3+2 (-18+65 m^2) r0^4+(9-6 m^2) r0^5+(1-2 m^2) r0^6)+16 (-3+r0) (-2376+3072 r0-1358 r0^2+182 r0^3+33 r0^4-10 r0^5+m^2 (-3+r0)^2 (130-83 r0+12 r0^2+r0^3))-8 l (3186-9261 r0+7443 r0^2-1605 r0^3-539 r0^4+291 r0^5-36 r0^6+m^2 (-3+r0)^2 (-96+454 r0-251 r0^2+30 r0^3+4 r0^4))-4 l^2 (8748-22176 r0+18195 r0^2-6302 r0^3+732 r0^4+87 r0^5-22 r0^6+2 m^2 (-972+4428 r0-4197 r0^2+1597 r0^3-245 r0^4+6 r0^5+r0^6))+l^4 (-4320-6408 r0+17328 r0^2-10552 r0^3+2559 r0^4-204 r0^5-8 r0^6+m^2 (864+2736 r0-6600 r0^2+3784 r0^3-776 r0^4+33 r0^5+r0^6))+2 l^3 (-8640+11016 r0-7890 r0^2+8317 r0^3-5505 r0^4+1593 r0^5-166 r0^6+m^2 (864+2016 r0-6984 r0^2+4850 r0^3-1129 r0^4+6 r0^5+20 r0^6)))-4 M^2 r0^2 (l^12 r0^3 (-18+17 r0-3 r0^2)-6 l^11 r0^3 (18-17 r0+3 r0^2)-10 l^9 r0^2 (-162+3 (43+6 m^2) r0-(19+11 m^2) r0^2+2 (1+m^2) r0^3)+l^10 r0^2 (324-12 (38+3 m^2) r0+(225+22 m^2) r0^2-(37+4 m^2) r0^3)+6 l^8 r0 (492-2 (437+30 m^2) r0+(998+74 m^2) r0^2-(659+16 m^2) r0^3-6 (-28+m^2) r0^4+(-15+2 m^2) r0^5)+6 l^7 r0 (1968-4 (1279+60 m^2) r0+(5084+476 m^2) r0^2-29 (91+6 m^2) r0^3+(659-4 m^2) r0^4+(-60+8 m^2) r0^5)-3 l^6 (-3024+24 (233+6 m^2) r0-8 (512+297 m^2) r0^2+2 (2245+652 m^2) r0^3-(2877+80 m^2) r0^4+(733-68 m^2) r0^5+8 (-9+m^2) r0^6)-6 l^5 (-4536+12 (1273+18 m^2) r0-4 (6296+1101 m^2) r0^2+(25234+3748 m^2) r0^3-2 (6749+403 m^2) r0^4+(3387-102 m^2) r0^5+(-318+40 m^2) r0^6)+16 (-3+r0) (-10800+10308 r0-1176 r0^2-1735 r0^3+764 r0^4-108 r0^5+m^2 (-3+r0)^2 (822-473 r0+44 r0^2+12 r0^3))-8 l (17982-29907 r0-2265 r0^2+25461 r0^3-16437 r0^4+4267 r0^5-414 r0^6+m^2 (-3+r0)^2 (-1584+3642 r0-1579 r0^2+76 r0^3+48 r0^4))+3 l^4 (-6480-5496 r0+7972 r0^2+640 r0^3-1909 r0^4+569 r0^5-66 r0^6+2 m^2 (432+8208 r0-9780 r0^2+3458 r0^3-239 r0^4-62 r0^5+2 r0^6))-12 l^2 (15876-26940 r0+11183 r0^2+2183 r0^3-2752 r0^4+765 r0^5-78 r0^6+m^2 (-9720+23976 r0-17916 r0^2+5399 r0^3-469 r0^4-60 r0^5+8 r0^6))+2 l^3 (-42120+66780 r0-121530 r0^2+146877 r0^3-82363 r0^4+20919 r0^5-1998 r0^6+3 m^2 (864+16776 r0-27180 r0^2+13778 r0^3-2061 r0^4-292 r0^5+80 r0^6))))+1/(l (-2+l+l^2) (-2 M+r0)^4) 24 (-7+2 l+2 l^2) M^3 (2 M-r0) r0 (r0/(-3+r0))^(3/2) (12 M^2+2 (-5+l+l^2) M r0-(-2+l+l^2) r0^2) (144 M^4 (4 l^7 r0^3 (18-17 r0+3 r0^2)+l^8 r0^3 (18-17 r0+3 r0^2)+2 l^6 r0^2 (-66+(151+18 m^2) r0-(118+11 m^2) r0^2+(29+2 m^2) r0^3-2 r0^4)-2 l^5 r0^2 (198-3 (109+18 m^2) r0+(235+33 m^2) r0^2-6 (11+m^2) r0^3+6 r0^4)+l^4 r0 (-648+24 (59+27 m^2) r0-12 (137+42 m^2) r0^2+23 (35+6 m^2) r0^3-3 (55+4 m^2) r0^4+12 r0^5)+2 l^3 r0 (-648+18 (97+36 m^2) r0-(2147+594 m^2) r0^2+(1157+193 m^2) r0^3-2 (134+11 m^2) r0^4+22 r0^5)-8 l (270-9 (59+54 m^2) r0+(879+621 m^2) r0^2-6 (131+51 m^2) r0^3+(343+69 m^2) r0^4-6 (12+m^2) r0^5+6 r0^6)-4 l^2 (540-36 (25+27 m^2) r0+45 (29+24 m^2) r0^2-3 (337+153 m^2) r0^3+(380+87 m^2) r0^4-6 (12+m^2) r0^5+6 r0^6)+16 (-3+r0) (72+48 r0-130 r0^2+70 r0^3-17 r0^4+2 r0^5-m^2 (-3+r0)^2 (18-11 r0+2 r0^2)))+(-2+l+l^2)^2 r0^4 (4 l^7 r0^2 (96-146 r0+81 r0^2-21 r0^3+2 r0^4)+l^8 r0^2 (96-146 r0+81 r0^2-21 r0^3+2 r0^4)+2 l^6 r0 (576-870 r0+(461+30 m^2) r0^2-3 (38+7 m^2) r0^3+2 (5+2 m^2) r0^4)-2 l^5 r0 (-1728+3282 r0-5 (481+18 m^2) r0^2+9 (101+7 m^2) r0^3-3 (59+4 m^2) r0^4+14 r0^5)+l^4 (3456-3384 r0+24 (-61+45 m^2) r0^2+(2476-936 m^2) r0^3+9 (-109+30 m^2) r0^4-3 (-55+8 m^2) r0^5-10 r0^6)-8 l (-486-135 (-17+6 m^2) r0+27 (-97+41 m^2) r0^2+(1231-576 m^2) r0^3+27 (-9+5 m^2) r0^4+(9-12 m^2) r0^5+2 r0^6)+4 l^2 (1836+180 (-35+9 m^2) r0+(6585-1944 m^2) r0^2+(-3155+873 m^2) r0^3-9 (-84+19 m^2) r0^4+3 (-27+4 m^2) r0^5+2 r0^6)+2 l^3 (3456-6264 r0+90 (47+12 m^2) r0^2-(1873+1086 m^2) r0^3+(723+375 m^2) r0^4-(179+44 m^2) r0^5+18 r0^6)-16 (-3+r0) (-720+1092 r0-640 r0^2+177 r0^3-20 r0^4+m^2 (-3+r0)^2 (30-21 r0+4 r0^2)))-48 M^3 r0 (l^10 r0^3 (-18+17 r0-3 r0^2)-5 l^9 r0^3 (18-17 r0+3 r0^2)+l^8 r0^2 (180-6 (59+6 m^2) r0+(246+22 m^2) r0^2-(55+4 m^2) r0^3+3 r0^4)+2 l^7 r0^2 (360-6 (73+12 m^2) r0+(237+44 m^2) r0^2-(65+8 m^2) r0^3+6 r0^4)+l^6 r0 (1224-12 (197+48 m^2) r0+6 (449+80 m^2) r0^2-(1551+122 m^2) r0^3-(-362+m^2) r0^4+3 (-10+m^2) r0^5)+l^5 r0 (3672-108 (89+16 m^2) r0+6 (1795+324 m^2) r0^2-(5955+674 m^2) r0^3+(1478+53 m^2) r0^4+3 (-44+3 m^2) r0^5)+l^3 (7776-1512 (13+4 m^2) r0+12 (2761+1092 m^2) r0^2-12 (2867+674 m^2) r0^3+2 (8898+869 m^2) r0^4+(-4261+11 m^2) r0^5+(384-33 m^2) r0^6)+l^4 (3888-144 (47+21 m^2) r0+72 (113+71 m^2) r0^2-6 (1301+390 m^2) r0^3+32 (117+8 m^2) r0^4+(-838+59 m^2) r0^5+(75-9 m^2) r0^6)-8 (-3+r0) (-1512+444 r0+1134 r0^2-871 r0^3+251 r0^4-30 r0^5+m^2 (-3+r0)^2 (192-104 r0+8 r0^2+3 r0^3))+4 l (-1296+3744 r0-9504 r0^2+9897 r0^3-4724 r0^4+1073 r0^5-96 r0^6+m^2 (-3+r0)^2 (-144+672 r0-326 r0^2+23 r0^3+9 r0^4))+2 l^2 (-648+2268 r0-9864 r0^2+10236 r0^3-4476 r0^4+949 r0^5-84 r0^6+m^2 (-2592+12312 r0-10800 r0^2+3474 r0^3-268 r0^4-65 r0^5+9 r0^6)))-4 (-2+l+l^2) M r0^3 (5 l^9 r0^2 (48-64 r0+32 r0^2-9 r0^3+r0^4)+l^10 r0^2 (48-64 r0+32 r0^2-9 r0^3+r0^4)+l^8 r0 (576+24 (-43+m^2) r0+(746+4 m^2) r0^2-(291+2 m^2) r0^3-3 (-16+m^2) r0^4+(-2+m^2) r0^5)+2 l^7 r0 (1152+48 (-58+m^2) r0+4 (613+2 m^2) r0^2-2 (531+2 m^2) r0^3+(231-6 m^2) r0^4+(-19+2 m^2) r0^5)+l^5 (5184+288 (-67+3 m^2) r0+12 (2173+44 m^2) r0^2-2 (9413+634 m^2) r0^3+(7998+418 m^2) r0^4+3 (-593+8 m^2) r0^5+(157-20 m^2) r0^6)+l^6 (1728+288 (-13+m^2) r0+12 (155+24 m^2) r0^2-2 (53+202 m^2) r0^3+2 (-18+65 m^2) r0^4+(9-6 m^2) r0^5+(1-2 m^2) r0^6)+16 (-3+r0) (-2376+3072 r0-1358 r0^2+182 r0^3+33 r0^4-10 r0^5+m^2 (-3+r0)^2 (130-83 r0+12 r0^2+r0^3))-8 l (3186-9261 r0+7443 r0^2-1605 r0^3-539 r0^4+291 r0^5-36 r0^6+m^2 (-3+r0)^2 (-96+454 r0-251 r0^2+30 r0^3+4 r0^4))-4 l^2 (8748-22176 r0+18195 r0^2-6302 r0^3+732 r0^4+87 r0^5-22 r0^6+2 m^2 (-972+4428 r0-4197 r0^2+1597 r0^3-245 r0^4+6 r0^5+r0^6))+l^4 (-4320-6408 r0+17328 r0^2-10552 r0^3+2559 r0^4-204 r0^5-8 r0^6+m^2 (864+2736 r0-6600 r0^2+3784 r0^3-776 r0^4+33 r0^5+r0^6))+2 l^3 (-8640+11016 r0-7890 r0^2+8317 r0^3-5505 r0^4+1593 r0^5-166 r0^6+m^2 (864+2016 r0-6984 r0^2+4850 r0^3-1129 r0^4+6 r0^5+20 r0^6)))-4 M^2 r0^2 (l^12 r0^3 (-18+17 r0-3 r0^2)-6 l^11 r0^3 (18-17 r0+3 r0^2)-10 l^9 r0^2 (-162+3 (43+6 m^2) r0-(19+11 m^2) r0^2+2 (1+m^2) r0^3)+l^10 r0^2 (324-12 (38+3 m^2) r0+(225+22 m^2) r0^2-(37+4 m^2) r0^3)+6 l^8 r0 (492-2 (437+30 m^2) r0+(998+74 m^2) r0^2-(659+16 m^2) r0^3-6 (-28+m^2) r0^4+(-15+2 m^2) r0^5)+6 l^7 r0 (1968-4 (1279+60 m^2) r0+(5084+476 m^2) r0^2-29 (91+6 m^2) r0^3+(659-4 m^2) r0^4+(-60+8 m^2) r0^5)-3 l^6 (-3024+24 (233+6 m^2) r0-8 (512+297 m^2) r0^2+2 (2245+652 m^2) r0^3-(2877+80 m^2) r0^4+(733-68 m^2) r0^5+8 (-9+m^2) r0^6)-6 l^5 (-4536+12 (1273+18 m^2) r0-4 (6296+1101 m^2) r0^2+(25234+3748 m^2) r0^3-2 (6749+403 m^2) r0^4+(3387-102 m^2) r0^5+(-318+40 m^2) r0^6)+16 (-3+r0) (-10800+10308 r0-1176 r0^2-1735 r0^3+764 r0^4-108 r0^5+m^2 (-3+r0)^2 (822-473 r0+44 r0^2+12 r0^3))-8 l (17982-29907 r0-2265 r0^2+25461 r0^3-16437 r0^4+4267 r0^5-414 r0^6+m^2 (-3+r0)^2 (-1584+3642 r0-1579 r0^2+76 r0^3+48 r0^4))+3 l^4 (-6480-5496 r0+7972 r0^2+640 r0^3-1909 r0^4+569 r0^5-66 r0^6+2 m^2 (432+8208 r0-9780 r0^2+3458 r0^3-239 r0^4-62 r0^5+2 r0^6))-12 l^2 (15876-26940 r0+11183 r0^2+2183 r0^3-2752 r0^4+765 r0^5-78 r0^6+m^2 (-9720+23976 r0-17916 r0^2+5399 r0^3-469 r0^4-60 r0^5+8 r0^6))+2 l^3 (-42120+66780 r0-121530 r0^2+146877 r0^3-82363 r0^4+20919 r0^5-1998 r0^6+3 m^2 (864+16776 r0-27180 r0^2+13778 r0^3-2061 r0^4-292 r0^5+80 r0^6))))+1/(l (-2+l+l^2) (-2 M+r0)^4) 4 (16-10 l-9 l^2+2 l^3+l^4) M^2 (2 M-r0) r0^2 (r0/(-3+r0))^(3/2) (12 M^2+2 (-5+l+l^2) M r0-(-2+l+l^2) r0^2) (144 M^4 (4 l^7 r0^3 (18-17 r0+3 r0^2)+l^8 r0^3 (18-17 r0+3 r0^2)+2 l^6 r0^2 (-66+(151+18 m^2) r0-(118+11 m^2) r0^2+(29+2 m^2) r0^3-2 r0^4)-2 l^5 r0^2 (198-3 (109+18 m^2) r0+(235+33 m^2) r0^2-6 (11+m^2) r0^3+6 r0^4)+l^4 r0 (-648+24 (59+27 m^2) r0-12 (137+42 m^2) r0^2+23 (35+6 m^2) r0^3-3 (55+4 m^2) r0^4+12 r0^5)+2 l^3 r0 (-648+18 (97+36 m^2) r0-(2147+594 m^2) r0^2+(1157+193 m^2) r0^3-2 (134+11 m^2) r0^4+22 r0^5)-8 l (270-9 (59+54 m^2) r0+(879+621 m^2) r0^2-6 (131+51 m^2) r0^3+(343+69 m^2) r0^4-6 (12+m^2) r0^5+6 r0^6)-4 l^2 (540-36 (25+27 m^2) r0+45 (29+24 m^2) r0^2-3 (337+153 m^2) r0^3+(380+87 m^2) r0^4-6 (12+m^2) r0^5+6 r0^6)+16 (-3+r0) (72+48 r0-130 r0^2+70 r0^3-17 r0^4+2 r0^5-m^2 (-3+r0)^2 (18-11 r0+2 r0^2)))+(-2+l+l^2)^2 r0^4 (4 l^7 r0^2 (96-146 r0+81 r0^2-21 r0^3+2 r0^4)+l^8 r0^2 (96-146 r0+81 r0^2-21 r0^3+2 r0^4)+2 l^6 r0 (576-870 r0+(461+30 m^2) r0^2-3 (38+7 m^2) r0^3+2 (5+2 m^2) r0^4)-2 l^5 r0 (-1728+3282 r0-5 (481+18 m^2) r0^2+9 (101+7 m^2) r0^3-3 (59+4 m^2) r0^4+14 r0^5)+l^4 (3456-3384 r0+24 (-61+45 m^2) r0^2+(2476-936 m^2) r0^3+9 (-109+30 m^2) r0^4-3 (-55+8 m^2) r0^5-10 r0^6)-8 l (-486-135 (-17+6 m^2) r0+27 (-97+41 m^2) r0^2+(1231-576 m^2) r0^3+27 (-9+5 m^2) r0^4+(9-12 m^2) r0^5+2 r0^6)+4 l^2 (1836+180 (-35+9 m^2) r0+(6585-1944 m^2) r0^2+(-3155+873 m^2) r0^3-9 (-84+19 m^2) r0^4+3 (-27+4 m^2) r0^5+2 r0^6)+2 l^3 (3456-6264 r0+90 (47+12 m^2) r0^2-(1873+1086 m^2) r0^3+(723+375 m^2) r0^4-(179+44 m^2) r0^5+18 r0^6)-16 (-3+r0) (-720+1092 r0-640 r0^2+177 r0^3-20 r0^4+m^2 (-3+r0)^2 (30-21 r0+4 r0^2)))-48 M^3 r0 (l^10 r0^3 (-18+17 r0-3 r0^2)-5 l^9 r0^3 (18-17 r0+3 r0^2)+l^8 r0^2 (180-6 (59+6 m^2) r0+(246+22 m^2) r0^2-(55+4 m^2) r0^3+3 r0^4)+2 l^7 r0^2 (360-6 (73+12 m^2) r0+(237+44 m^2) r0^2-(65+8 m^2) r0^3+6 r0^4)+l^6 r0 (1224-12 (197+48 m^2) r0+6 (449+80 m^2) r0^2-(1551+122 m^2) r0^3-(-362+m^2) r0^4+3 (-10+m^2) r0^5)+l^5 r0 (3672-108 (89+16 m^2) r0+6 (1795+324 m^2) r0^2-(5955+674 m^2) r0^3+(1478+53 m^2) r0^4+3 (-44+3 m^2) r0^5)+l^3 (7776-1512 (13+4 m^2) r0+12 (2761+1092 m^2) r0^2-12 (2867+674 m^2) r0^3+2 (8898+869 m^2) r0^4+(-4261+11 m^2) r0^5+(384-33 m^2) r0^6)+l^4 (3888-144 (47+21 m^2) r0+72 (113+71 m^2) r0^2-6 (1301+390 m^2) r0^3+32 (117+8 m^2) r0^4+(-838+59 m^2) r0^5+(75-9 m^2) r0^6)-8 (-3+r0) (-1512+444 r0+1134 r0^2-871 r0^3+251 r0^4-30 r0^5+m^2 (-3+r0)^2 (192-104 r0+8 r0^2+3 r0^3))+4 l (-1296+3744 r0-9504 r0^2+9897 r0^3-4724 r0^4+1073 r0^5-96 r0^6+m^2 (-3+r0)^2 (-144+672 r0-326 r0^2+23 r0^3+9 r0^4))+2 l^2 (-648+2268 r0-9864 r0^2+10236 r0^3-4476 r0^4+949 r0^5-84 r0^6+m^2 (-2592+12312 r0-10800 r0^2+3474 r0^3-268 r0^4-65 r0^5+9 r0^6)))-4 (-2+l+l^2) M r0^3 (5 l^9 r0^2 (48-64 r0+32 r0^2-9 r0^3+r0^4)+l^10 r0^2 (48-64 r0+32 r0^2-9 r0^3+r0^4)+l^8 r0 (576+24 (-43+m^2) r0+(746+4 m^2) r0^2-(291+2 m^2) r0^3-3 (-16+m^2) r0^4+(-2+m^2) r0^5)+2 l^7 r0 (1152+48 (-58+m^2) r0+4 (613+2 m^2) r0^2-2 (531+2 m^2) r0^3+(231-6 m^2) r0^4+(-19+2 m^2) r0^5)+l^5 (5184+288 (-67+3 m^2) r0+12 (2173+44 m^2) r0^2-2 (9413+634 m^2) r0^3+(7998+418 m^2) r0^4+3 (-593+8 m^2) r0^5+(157-20 m^2) r0^6)+l^6 (1728+288 (-13+m^2) r0+12 (155+24 m^2) r0^2-2 (53+202 m^2) r0^3+2 (-18+65 m^2) r0^4+(9-6 m^2) r0^5+(1-2 m^2) r0^6)+16 (-3+r0) (-2376+3072 r0-1358 r0^2+182 r0^3+33 r0^4-10 r0^5+m^2 (-3+r0)^2 (130-83 r0+12 r0^2+r0^3))-8 l (3186-9261 r0+7443 r0^2-1605 r0^3-539 r0^4+291 r0^5-36 r0^6+m^2 (-3+r0)^2 (-96+454 r0-251 r0^2+30 r0^3+4 r0^4))-4 l^2 (8748-22176 r0+18195 r0^2-6302 r0^3+732 r0^4+87 r0^5-22 r0^6+2 m^2 (-972+4428 r0-4197 r0^2+1597 r0^3-245 r0^4+6 r0^5+r0^6))+l^4 (-4320-6408 r0+17328 r0^2-10552 r0^3+2559 r0^4-204 r0^5-8 r0^6+m^2 (864+2736 r0-6600 r0^2+3784 r0^3-776 r0^4+33 r0^5+r0^6))+2 l^3 (-8640+11016 r0-7890 r0^2+8317 r0^3-5505 r0^4+1593 r0^5-166 r0^6+m^2 (864+2016 r0-6984 r0^2+4850 r0^3-1129 r0^4+6 r0^5+20 r0^6)))-4 M^2 r0^2 (l^12 r0^3 (-18+17 r0-3 r0^2)-6 l^11 r0^3 (18-17 r0+3 r0^2)-10 l^9 r0^2 (-162+3 (43+6 m^2) r0-(19+11 m^2) r0^2+2 (1+m^2) r0^3)+l^10 r0^2 (324-12 (38+3 m^2) r0+(225+22 m^2) r0^2-(37+4 m^2) r0^3)+6 l^8 r0 (492-2 (437+30 m^2) r0+(998+74 m^2) r0^2-(659+16 m^2) r0^3-6 (-28+m^2) r0^4+(-15+2 m^2) r0^5)+6 l^7 r0 (1968-4 (1279+60 m^2) r0+(5084+476 m^2) r0^2-29 (91+6 m^2) r0^3+(659-4 m^2) r0^4+(-60+8 m^2) r0^5)-3 l^6 (-3024+24 (233+6 m^2) r0-8 (512+297 m^2) r0^2+2 (2245+652 m^2) r0^3-(2877+80 m^2) r0^4+(733-68 m^2) r0^5+8 (-9+m^2) r0^6)-6 l^5 (-4536+12 (1273+18 m^2) r0-4 (6296+1101 m^2) r0^2+(25234+3748 m^2) r0^3-2 (6749+403 m^2) r0^4+(3387-102 m^2) r0^5+(-318+40 m^2) r0^6)+16 (-3+r0) (-10800+10308 r0-1176 r0^2-1735 r0^3+764 r0^4-108 r0^5+m^2 (-3+r0)^2 (822-473 r0+44 r0^2+12 r0^3))-8 l (17982-29907 r0-2265 r0^2+25461 r0^3-16437 r0^4+4267 r0^5-414 r0^6+m^2 (-3+r0)^2 (-1584+3642 r0-1579 r0^2+76 r0^3+48 r0^4))+3 l^4 (-6480-5496 r0+7972 r0^2+640 r0^3-1909 r0^4+569 r0^5-66 r0^6+2 m^2 (432+8208 r0-9780 r0^2+3458 r0^3-239 r0^4-62 r0^5+2 r0^6))-12 l^2 (15876-26940 r0+11183 r0^2+2183 r0^3-2752 r0^4+765 r0^5-78 r0^6+m^2 (-9720+23976 r0-17916 r0^2+5399 r0^3-469 r0^4-60 r0^5+8 r0^6))+2 l^3 (-42120+66780 r0-121530 r0^2+146877 r0^3-82363 r0^4+20919 r0^5-1998 r0^6+3 m^2 (864+16776 r0-27180 r0^2+13778 r0^3-2061 r0^4-292 r0^5+80 r0^6))))-1/(l (-2 M+r0)^4) 2 (-2+l+l^2) M (2 M-r0) r0^3 (r0/(-3+r0))^(3/2) (12 M^2+2 (-5+l+l^2) M r0-(-2+l+l^2) r0^2) (144 M^4 (4 l^7 r0^3 (18-17 r0+3 r0^2)+l^8 r0^3 (18-17 r0+3 r0^2)+2 l^6 r0^2 (-66+(151+18 m^2) r0-(118+11 m^2) r0^2+(29+2 m^2) r0^3-2 r0^4)-2 l^5 r0^2 (198-3 (109+18 m^2) r0+(235+33 m^2) r0^2-6 (11+m^2) r0^3+6 r0^4)+l^4 r0 (-648+24 (59+27 m^2) r0-12 (137+42 m^2) r0^2+23 (35+6 m^2) r0^3-3 (55+4 m^2) r0^4+12 r0^5)+2 l^3 r0 (-648+18 (97+36 m^2) r0-(2147+594 m^2) r0^2+(1157+193 m^2) r0^3-2 (134+11 m^2) r0^4+22 r0^5)-8 l (270-9 (59+54 m^2) r0+(879+621 m^2) r0^2-6 (131+51 m^2) r0^3+(343+69 m^2) r0^4-6 (12+m^2) r0^5+6 r0^6)-4 l^2 (540-36 (25+27 m^2) r0+45 (29+24 m^2) r0^2-3 (337+153 m^2) r0^3+(380+87 m^2) r0^4-6 (12+m^2) r0^5+6 r0^6)+16 (-3+r0) (72+48 r0-130 r0^2+70 r0^3-17 r0^4+2 r0^5-m^2 (-3+r0)^2 (18-11 r0+2 r0^2)))+(-2+l+l^2)^2 r0^4 (4 l^7 r0^2 (96-146 r0+81 r0^2-21 r0^3+2 r0^4)+l^8 r0^2 (96-146 r0+81 r0^2-21 r0^3+2 r0^4)+2 l^6 r0 (576-870 r0+(461+30 m^2) r0^2-3 (38+7 m^2) r0^3+2 (5+2 m^2) r0^4)-2 l^5 r0 (-1728+3282 r0-5 (481+18 m^2) r0^2+9 (101+7 m^2) r0^3-3 (59+4 m^2) r0^4+14 r0^5)+l^4 (3456-3384 r0+24 (-61+45 m^2) r0^2+(2476-936 m^2) r0^3+9 (-109+30 m^2) r0^4-3 (-55+8 m^2) r0^5-10 r0^6)-8 l (-486-135 (-17+6 m^2) r0+27 (-97+41 m^2) r0^2+(1231-576 m^2) r0^3+27 (-9+5 m^2) r0^4+(9-12 m^2) r0^5+2 r0^6)+4 l^2 (1836+180 (-35+9 m^2) r0+(6585-1944 m^2) r0^2+(-3155+873 m^2) r0^3-9 (-84+19 m^2) r0^4+3 (-27+4 m^2) r0^5+2 r0^6)+2 l^3 (3456-6264 r0+90 (47+12 m^2) r0^2-(1873+1086 m^2) r0^3+(723+375 m^2) r0^4-(179+44 m^2) r0^5+18 r0^6)-16 (-3+r0) (-720+1092 r0-640 r0^2+177 r0^3-20 r0^4+m^2 (-3+r0)^2 (30-21 r0+4 r0^2)))-48 M^3 r0 (l^10 r0^3 (-18+17 r0-3 r0^2)-5 l^9 r0^3 (18-17 r0+3 r0^2)+l^8 r0^2 (180-6 (59+6 m^2) r0+(246+22 m^2) r0^2-(55+4 m^2) r0^3+3 r0^4)+2 l^7 r0^2 (360-6 (73+12 m^2) r0+(237+44 m^2) r0^2-(65+8 m^2) r0^3+6 r0^4)+l^6 r0 (1224-12 (197+48 m^2) r0+6 (449+80 m^2) r0^2-(1551+122 m^2) r0^3-(-362+m^2) r0^4+3 (-10+m^2) r0^5)+l^5 r0 (3672-108 (89+16 m^2) r0+6 (1795+324 m^2) r0^2-(5955+674 m^2) r0^3+(1478+53 m^2) r0^4+3 (-44+3 m^2) r0^5)+l^3 (7776-1512 (13+4 m^2) r0+12 (2761+1092 m^2) r0^2-12 (2867+674 m^2) r0^3+2 (8898+869 m^2) r0^4+(-4261+11 m^2) r0^5+(384-33 m^2) r0^6)+l^4 (3888-144 (47+21 m^2) r0+72 (113+71 m^2) r0^2-6 (1301+390 m^2) r0^3+32 (117+8 m^2) r0^4+(-838+59 m^2) r0^5+(75-9 m^2) r0^6)-8 (-3+r0) (-1512+444 r0+1134 r0^2-871 r0^3+251 r0^4-30 r0^5+m^2 (-3+r0)^2 (192-104 r0+8 r0^2+3 r0^3))+4 l (-1296+3744 r0-9504 r0^2+9897 r0^3-4724 r0^4+1073 r0^5-96 r0^6+m^2 (-3+r0)^2 (-144+672 r0-326 r0^2+23 r0^3+9 r0^4))+2 l^2 (-648+2268 r0-9864 r0^2+10236 r0^3-4476 r0^4+949 r0^5-84 r0^6+m^2 (-2592+12312 r0-10800 r0^2+3474 r0^3-268 r0^4-65 r0^5+9 r0^6)))-4 (-2+l+l^2) M r0^3 (5 l^9 r0^2 (48-64 r0+32 r0^2-9 r0^3+r0^4)+l^10 r0^2 (48-64 r0+32 r0^2-9 r0^3+r0^4)+l^8 r0 (576+24 (-43+m^2) r0+(746+4 m^2) r0^2-(291+2 m^2) r0^3-3 (-16+m^2) r0^4+(-2+m^2) r0^5)+2 l^7 r0 (1152+48 (-58+m^2) r0+4 (613+2 m^2) r0^2-2 (531+2 m^2) r0^3+(231-6 m^2) r0^4+(-19+2 m^2) r0^5)+l^5 (5184+288 (-67+3 m^2) r0+12 (2173+44 m^2) r0^2-2 (9413+634 m^2) r0^3+(7998+418 m^2) r0^4+3 (-593+8 m^2) r0^5+(157-20 m^2) r0^6)+l^6 (1728+288 (-13+m^2) r0+12 (155+24 m^2) r0^2-2 (53+202 m^2) r0^3+2 (-18+65 m^2) r0^4+(9-6 m^2) r0^5+(1-2 m^2) r0^6)+16 (-3+r0) (-2376+3072 r0-1358 r0^2+182 r0^3+33 r0^4-10 r0^5+m^2 (-3+r0)^2 (130-83 r0+12 r0^2+r0^3))-8 l (3186-9261 r0+7443 r0^2-1605 r0^3-539 r0^4+291 r0^5-36 r0^6+m^2 (-3+r0)^2 (-96+454 r0-251 r0^2+30 r0^3+4 r0^4))-4 l^2 (8748-22176 r0+18195 r0^2-6302 r0^3+732 r0^4+87 r0^5-22 r0^6+2 m^2 (-972+4428 r0-4197 r0^2+1597 r0^3-245 r0^4+6 r0^5+r0^6))+l^4 (-4320-6408 r0+17328 r0^2-10552 r0^3+2559 r0^4-204 r0^5-8 r0^6+m^2 (864+2736 r0-6600 r0^2+3784 r0^3-776 r0^4+33 r0^5+r0^6))+2 l^3 (-8640+11016 r0-7890 r0^2+8317 r0^3-5505 r0^4+1593 r0^5-166 r0^6+m^2 (864+2016 r0-6984 r0^2+4850 r0^3-1129 r0^4+6 r0^5+20 r0^6)))-4 M^2 r0^2 (l^12 r0^3 (-18+17 r0-3 r0^2)-6 l^11 r0^3 (18-17 r0+3 r0^2)-10 l^9 r0^2 (-162+3 (43+6 m^2) r0-(19+11 m^2) r0^2+2 (1+m^2) r0^3)+l^10 r0^2 (324-12 (38+3 m^2) r0+(225+22 m^2) r0^2-(37+4 m^2) r0^3)+6 l^8 r0 (492-2 (437+30 m^2) r0+(998+74 m^2) r0^2-(659+16 m^2) r0^3-6 (-28+m^2) r0^4+(-15+2 m^2) r0^5)+6 l^7 r0 (1968-4 (1279+60 m^2) r0+(5084+476 m^2) r0^2-29 (91+6 m^2) r0^3+(659-4 m^2) r0^4+(-60+8 m^2) r0^5)-3 l^6 (-3024+24 (233+6 m^2) r0-8 (512+297 m^2) r0^2+2 (2245+652 m^2) r0^3-(2877+80 m^2) r0^4+(733-68 m^2) r0^5+8 (-9+m^2) r0^6)-6 l^5 (-4536+12 (1273+18 m^2) r0-4 (6296+1101 m^2) r0^2+(25234+3748 m^2) r0^3-2 (6749+403 m^2) r0^4+(3387-102 m^2) r0^5+(-318+40 m^2) r0^6)+16 (-3+r0) (-10800+10308 r0-1176 r0^2-1735 r0^3+764 r0^4-108 r0^5+m^2 (-3+r0)^2 (822-473 r0+44 r0^2+12 r0^3))-8 l (17982-29907 r0-2265 r0^2+25461 r0^3-16437 r0^4+4267 r0^5-414 r0^6+m^2 (-3+r0)^2 (-1584+3642 r0-1579 r0^2+76 r0^3+48 r0^4))+3 l^4 (-6480-5496 r0+7972 r0^2+640 r0^3-1909 r0^4+569 r0^5-66 r0^6+2 m^2 (432+8208 r0-9780 r0^2+3458 r0^3-239 r0^4-62 r0^5+2 r0^6))-12 l^2 (15876-26940 r0+11183 r0^2+2183 r0^3-2752 r0^4+765 r0^5-78 r0^6+m^2 (-9720+23976 r0-17916 r0^2+5399 r0^3-469 r0^4-60 r0^5+8 r0^6))+2 l^3 (-42120+66780 r0-121530 r0^2+146877 r0^3-82363 r0^4+20919 r0^5-1998 r0^6+3 m^2 (864+16776 r0-27180 r0^2+13778 r0^3-2061 r0^4-292 r0^5+80 r0^6))))-1/((-1+l) l (2+l)) (r0/(-3+r0))^(3/2) (6 M+(-2+l+l^2) r0)^2 (l (1+l) (-2+l+l^2)^3 (-2+r0) r0^5 (6+(-2+l+l^2) r0)^2 (2 l^3 r0 (3-4 r0+r0^2)+l^4 r0 (3-4 r0+r0^2)+l (162+2 (-98+3 m^2) r0+(77-2 m^2) r0^2-10 r0^3)+l^2 (162+(-193+6 m^2) r0+(73-2 m^2) r0^2-9 r0^3)+2 (-180+2 m^2 (-3+r0)^2+196 r0-69 r0^2+8 r0^3))-432 M^5 (4 l^7 r0^3 (-246+403 r0-201 r0^2+32 r0^3)+l^8 r0^3 (-246+403 r0-201 r0^2+32 r0^3)-2 l^6 r0^2 (6474+123 (-89+2 m^2) r0+(6466-193 m^2) r0^2+(-1591+38 m^2) r0^3+136 r0^4)-2 l^5 r0^2 (19422+123 (-281+6 m^2) r0+(22219-579 m^2) r0^2+6 (-1030+19 m^2) r0^3+632 r0^4)+l^4 r0 (-137448-72 (-3737+123 m^2) r0+12 (-16577+702 m^2) r0^2+(69337-2526 m^2) r0^3+3 (-3751+76 m^2) r0^4+656 r0^5)+2 l^3 r0 (-137448+(301434-8856 m^2) r0+3 (-85701+3218 m^2) r0^2+(107309-3491 m^2) r0^3+22 (-1001+19 m^2) r0^4+1784 r0^5)-4 l^2 (97740+324 (-841+41 m^2) r0-9 (-32501+1896 m^2) r0^2+21 (-7511+381 m^2) r0^3+(45392-1605 m^2) r0^4+6 (-1101+19 m^2) r0^5+376 r0^6)-8 l (48870+9 (-17047+738 m^2) r0+(184743-9639 m^2) r0^2+18 (-6248+291 m^2) r0^3+(37069-1263 m^2) r0^4+6 (-1055+19 m^2) r0^5+440 r0^6)+16 (-3+r0) (-18504+35256 r0-26670 r0^2+10012 r0^3-1861 r0^4+136 r0^5+m^2 (-3+r0)^2 (246-193 r0+38 r0^2)))-(-2+l+l^2)^2 M r0^4 (12 l^11 r0^3 (-6+11 r0-6 r0^2+r0^3)+2 l^12 r0^3 (-6+11 r0-6 r0^2+r0^3)+5 l^9 r0^2 (-984+(2006-30 m^2) r0+(-1553+31 m^2) r0^2+(527-10 m^2) r0^3+(-66+m^2) r0^4)+l^10 r0^2 (-984+(1874-30 m^2) r0+(-1311+31 m^2) r0^2-5 (-79+2 m^2) r0^3+(-44+m^2) r0^4)+2 l^7 r0 (-21024+(69456-984 m^2) r0+(-81114+2198 m^2-24 m^4) r0^2+(43221-1257 m^2+20 m^4) r0^3+(-10761+212 m^2-4 m^4) r0^4+(1020+m^2) r0^5)+l^8 r0 (-10512+(27348-492 m^2) r0-2 (12657-437 m^2+6 m^4) r0^2+2 (4800-198 m^2+5 m^4) r0^3+(-1230+31 m^2-2 m^4) r0^4+2 (-9+4 m^2) r0^5)+l^6 (-30240-72 (-2369+37 m^2) r0-12 (18919-917 m^2+18 m^4) r0^2+2 (56019-3541 m^2+102 m^4) r0^3+(-15099+915 m^2-56 m^4) r0^4+(-3549+208 m^2+4 m^4) r0^5+(864-31 m^2) r0^6)-l^5 (90720+72 (-9151+111 m^2) r0+12 (98995-3325 m^2+54 m^4) r0^2+(-946830+37262 m^2-780 m^4) r0^3+(381909-12195 m^2+308 m^4) r0^4+(-76539+1070 m^2-40 m^4) r0^5+(6066+79 m^2) r0^6)+16 (-3+r0) (-2 m^4 (-3+r0)^3 (-2+r0)+m^2 (4068-5670 r0+2830 r0^2-545 r0^3+9 r0^4+6 r0^5)+2 (-14616+27360 r0-20306 r0^2+7466 r0^3-1355 r0^4+96 r0^5))-4 l^3 (-221184+737874 r0-930939 r0^2+587388 r0^3-198947 r0^4+34671 r0^5-2446 r0^6+m^4 r0 (648-1134 r0+723 r0^2-199 r0^3+20 r0^4)+m^2 (2376-33642 r0+49683 r0^2-27472 r0^3+6147 r0^4-280 r0^5-50 r0^6))+16 l (-94446+243423 r0-255303 r0^2+139891 r0^3-42324 r0^4+6712 r0^5-436 r0^6+m^4 (-3+r0)^3 (6-11 r0+4 r0^2)+m^2 (7668-19260 r0+17292 r0^2-7037 r0^3+1208 r0^4-22 r0^5-11 r0^6))+4 l^2 (2 m^4 (-3+r0)^2 (-36+60 r0-25 r0^2+2 r0^3)+m^2 (29484-59886 r0+42582 r0^2-12665 r0^3+1134 r0^4+118 r0^5-16 r0^6)-6 (43902-95925 r0+83348 r0^2-36482 r0^3+8283 r0^4-869 r0^5+26 r0^6))+l^4 (-2 m^4 r0 (648-864 r0+384 r0^2-59 r0^3+r0^4)+6 (61128-150360 r0+130996 r0^2-46815 r0^3+3514 r0^4+1638 r0^5-286 r0^6)+m^2 (-4752+60624 r0-64968 r0^2+21178 r0^3-510 r0^4-629 r0^5+38 r0^6)))-6 (-2+l+l^2)^2 M^2 r0^3 (5 l^9 r0^3 (-102+171 r0-87 r0^2+14 r0^3)+l^10 r0^3 (-102+171 r0-87 r0^2+14 r0^3)+l^8 r0^2 (-5700-74 (-136+3 m^2) r0+(-6349+195 m^2) r0^2+(1705-50 m^2) r0^3+(-166+3 m^2) r0^4)+2 l^7 r0^2 (-11400+(21658-444 m^2) r0+(-15263+390 m^2) r0^2-5 (-943+20 m^2) r0^3+(-542+6 m^2) r0^4)+l^6 r0 (-60264+(138216-3852 m^2) r0-2 (59720-2355 m^2+18 m^4) r0^2+(47135-1778 m^2+30 m^4) r0^3+(-8167+161 m^2-6 m^4) r0^4+6 (73+3 m^2) r0^5)+l^5 r0 (-180792-12 (-41204+963 m^2) r0-2 (256034-8619 m^2+54 m^4) r0^2+(251837-8064 m^2+90 m^4) r0^3+(-59333+1183 m^2-18 m^4) r0^4+2 (2701+6 m^2) r0^5)-l^3 (343008+72 (-24983+618 m^2) r0+12 (239150-9801 m^2+108 m^4) r0^2-2 (1057711-44967 m^2+738 m^4) r0^3+(805078-26164 m^2+546 m^4) r0^4+(-154202+2095 m^2-66 m^4) r0^5+12 (983+12 m^2) r0^6)+l^4 (-171504-72 (-10399+309 m^2) r0-24 (42065-2049 m^2+27 m^4) r0^2+(605210-30084 m^2+648 m^4) r0^3+(-174013+5907 m^2-198 m^4) r0^4+(21721+55 m^2+18 m^4) r0^5-(694+69 m^2) r0^6)+8 (-3+r0) (106848+6 m^4 (-3+r0)^3 (-2+r0)-200088 r0+148576 r0^2-54662 r0^3+9928 r0^4-704 r0^5-m^2 (14796-20754 r0+10518 r0^2-2123 r0^3+71 r0^4+18 r0^5))-2 l^2 (18 m^4 (-3+r0)^2 r0 (12-8 r0+r0^2)+m^2 (21384-112968 r0+117018 r0^2-46572 r0^3+6834 r0^4+49 r0^5-60 r0^6)-2 (330696-853902 r0+860109 r0^2-436495 r0^3+117710 r0^4-15833 r0^5+806 r0^6))-4 l (18 m^4 (-3+r0)^3 (-2+r0) r0+m^2 (10692-62046 r0+73692 r0^2-35283 r0^3+7056 r0^4-295 r0^5-48 r0^6)-2 (186786-543141 r0+620193 r0^2-362051 r0^3+115087 r0^4-19003 r0^5+1278 r0^6)))-36 (-2+l+l^2) M^3 r0^2 (5 l^9 r0^3 (-258+425 r0-213 r0^2+34 r0^3)+l^10 r0^3 (-258+425 r0-213 r0^2+34 r0^3)+2 l^7 r0^2 (-27864+(51238-1068 m^2) r0+(-34553+878 m^2) r0^2+(10181-196 m^2) r0^3+2 (-557+3 m^2) r0^4)+l^8 r0^2 (-13932+(23684-534 m^2) r0+(-14089+439 m^2) r0^2+(3493-98 m^2) r0^3+(-302+3 m^2) r0^4)+l^5 r0 (-443880-36 (-30542+789 m^2) r0-2 (526952-18327 m^2+54 m^4) r0^2+(488915-15536 m^2+90 m^4) r0^3+(-110195+2143 m^2-18 m^4) r0^4+2 (4847+6 m^2) r0^5)+l^6 r0 (-147960+(301488-9468 m^2) r0+(-229940+9726 m^2-36 m^4) r0^2+(79373-3130 m^2+30 m^4) r0^3+(-11485+257 m^2-6 m^4) r0^4+2 (197+9 m^2) r0^5)-l^3 (842400+72 (-50297+1554 m^2) r0+36 (147580-6447 m^2+36 m^4) r0^2-2 (1867295-80547 m^2+738 m^4) r0^3+2 (689159-22714 m^2+273 m^4) r0^4+(-258410+4015 m^2-66 m^4) r0^5+4 (4865+36 m^2) r0^6)+l^4 (-421200-72 (-20011+777 m^2) r0-24 (71153-3849 m^2+27 m^4) r0^2+(927974-48756 m^2+648 m^4) r0^3+(-239293+8743 m^2-198 m^4) r0^4+(24433+7 m^2+18 m^4) r0^5-(182+69 m^2) r0^6)+8 (-3+r0) (6 m^4 (-3+r0)^3 (-2+r0)+2 (76464-143868 r0+107392 r0^2-39743 r0^3+7268 r0^4-520 r0^5)-m^2 (20412-28890 r0+14934 r0^2-3187 r0^3+167 r0^4+18 r0^5))-2 l^2 (18 m^4 (-3+r0)^2 r0 (12-8 r0+r0^2)+m^2 (55080-189864 r0+178578 r0^2-68772 r0^3+10402 r0^4-143 r0^5-60 r0^6)-2 (531360-1314018 r0+1282149 r0^2-633607 r0^3+166490 r0^4-21713 r0^5+1054 r0^6))-4 l (18 m^4 (-3+r0)^3 (-2+r0) r0+m^2 (27540-108918 r0+119484 r0^2-56139 r0^3+11600 r0^4-679 r0^5-48 r0^6)-2 (318330-892593 r0+997197 r0^2-574355 r0^3+181095 r0^4-29767 r0^5+1998 r0^6)))-72 M^4 r0 (5 l^9 r0^3 (-750+1231 r0-615 r0^2+98 r0^3)+l^10 r0^3 (-750+1231 r0-615 r0^2+98 r0^3)+l^8 r0^2 (-39828+(66476-1518 m^2) r0+(-38319+1211 m^2) r0^2+(9041-250 m^2) r0^3+(-716+3 m^2) r0^4)+2 l^7 r0^2 (-79656+(144202-3036 m^2) r0+(-95103+2422 m^2) r0^2+(27307-500 m^2) r0^3+(-2902+6 m^2) r0^4)+l^5 r0 (-1268568+(2996376-81540 m^2) r0-2 (1376228-48975 m^2+54 m^4) r0^2+(1231869-39124 m^2+90 m^4) r0^3+(-269479+5171 m^2-18 m^4) r0^4+2 (11561+6 m^2) r0^5)+l^6 r0 (-422856+(812928-27180 m^2) r0+(-575764+25566 m^2-36 m^4) r0^2+(180099-7390 m^2+30 m^4) r0^3+(-21805+557 m^2-6 m^4) r0^4+2 (125+9 m^2) r0^5)+l^4 (-1203120-72 (-50173+2253 m^2) r0-24 (162593-9519 m^2+27 m^4) r0^2+2 (972613-53706 m^2+324 m^4) r0^3+(-446403+17591 m^2-198 m^4) r0^4+(33539-133 m^2+18 m^4) r0^5+(1360-69 m^2) r0^6)-l^3 (2406240+216 (-43237+1502 m^2) r0+12 (1082024-49401 m^2+108 m^4) r0^2-2 (4410925-192579 m^2+738 m^4) r0^3+2 (1590069-53020 m^2+273 m^4) r0^4+(-586076+10051 m^2-66 m^4) r0^5+16 (2723+9 m^2) r0^6)+8 (-3+r0) (298800+6 m^4 (-3+r0)^3 (-2+r0)-565632 r0+424996 r0^2-158404 r0^3+29206 r0^4-2112 r0^5-m^2 (37908-54270 r0+28722 r0^2-6511 r0^3+467 r0^4+18 r0^5))-2 l^2 (-2330208+5536620 r0-5236086 r0^2+2518010 r0^3-643740 r0^4+81164 r0^5-3728 r0^6+18 m^4 (-3+r0)^2 r0 (12-8 r0+r0^2)+m^2 (161352-431352 r0+371466 r0^2-138192 r0^3+21530 r0^4-739 r0^5-60 r0^6))-4 l (18 m^4 (-3+r0)^3 (-2+r0) r0+m^2 (80676-256230 r0+263232 r0^2-121575 r0^3+25852 r0^4-1883 r0^5-48 r0^6)-2 (732942-1994283 r0+2186283 r0^2-1244360 r0^3+389551 r0^4-63788 r0^5+4276 r0^6))))) Conjugate[Y])/((1+l) r0^4 (-2 M+r0)^4 (6+(-2+l+l^2) r0)^3 (6 M+(-2+l+l^2) r0)^5),
-((8 \[Pi] (r0/(-3+r0))^(3/2) (9 l^17 r0^8 (-2 M+r0)^2 (96-170 r0+125 r0^2-45 r0^3+6 r0^4+M (-36+34 r0-6 r0^2))+l^18 r0^8 (-2 M+r0)^2 (96-170 r0+125 r0^2-45 r0^3+6 r0^4+M (-36+34 r0-6 r0^2))+4 l^15 (2 M-r0) r0^7 (48 M^3 (-66+73 r0-21 r0^2+2 r0^3)+4 M^2 (1224-6 (265+27 m^2) r0+(1005+193 m^2) r0^2-(407+83 m^2) r0^3+12 (5+m^2) r0^4)+r0 (-2304+5784 r0-6 (935+4 m^2) r0^2+(2611+4 m^2) r0^3-555 r0^4+42 r0^5)-2 M (-2304-96 (-69+2 m^2) r0+2 (-3422+95 m^2) r0^2+(3486-87 m^2) r0^3+(-896+13 m^2) r0^4+90 r0^5))+l^16 (2 M-r0) r0^7 (24 M^3 (-66+73 r0-21 r0^2+2 r0^3)+2 M^2 (1224-6 (418+27 m^2) r0+(1872+193 m^2) r0^2-(560+83 m^2) r0^3+12 (5+m^2) r0^4)+2 r0 (-576+222 r0+(765-6 m^2) r0^2+(-941+m^2) r0^3+435 r0^4-66 r0^5)+M (2304+192 (-9+m^2) r0-2 (454+95 m^2) r0^2+3 (674+29 m^2) r0^3-(1246+13 m^2) r0^4+216 r0^5))-2 l^14 r0^6 (576 M^5 (18-17 r0+3 r0^2)-48 M^4 (426-(1121+156 m^2) r0+(1081+192 m^2) r0^2-(407+83 m^2) r0^3+6 (9+2 m^2) r0^4)-4 M^3 (6408-6 (1540+81 m^2) r0+(13746+795 m^2-90 m^4) r0^2+(-9852-327 m^2+71 m^4) r0^3+(1734+25 m^2-14 m^4) r0^4+6 (-4+m^2) r0^5)+M r0 (6912+72 (193+16 m^2) r0+(-94584+750 m^2) r0^2+(121338-1247 m^2+66 m^4) r0^3+(-71640+767 m^2-51 m^4) r0^4+(21562-133 m^2+10 m^4) r0^5-2520 r0^6)+r0^2 (-1728-4500 r0-6 (-4087+18 m^2) r0^2-2 (15530+33 m^2) r0^3+(17961+14 m^2) r0^4-5043 r0^5+546 r0^6)-2 M^2 (3456+72 (-21+16 m^2) r0+12 (-3206+105 m^2+2 m^4) r0^2+2 (26071-839 m^2+56 m^4) r0^3+(-32484+270 m^2-92 m^4) r0^4+(12148+250 m^2+15 m^4) r0^5+(-1712-68 m^2+m^4) r0^6))-14 l^13 r0^6 (576 M^5 (18-17 r0+3 r0^2)-48 M^4 (426-(461+156 m^2) r0+3 (117+64 m^2) r0^2-(197+83 m^2) r0^3+2 (17+6 m^2) r0^4)+4 M^3 (-6408+6 (3580+81 m^2) r0+15 (-1590-161 m^2+6 m^4) r0^2+(13788+2257 m^2-71 m^4) r0^3+(-4238-855 m^2+14 m^4) r0^4+6 (84+19 m^2) r0^5)+M r0 (6912+72 (-447+16 m^2) r0-30 (-1636+39 m^2) r0^2+(-36046+413 m^2+66 m^4) r0^3+(13096-63 m^2-51 m^4) r0^4+(-1822-3 m^2+10 m^4) r0^5+24 r0^6)+r0^2 (-1728+7020 r0-6 (1549+18 m^2) r0^2+(5660+54 m^2) r0^3-(1469+6 m^2) r0^4+27 r0^5+30 r0^6)-2 M^2 (3456+72 (-341+16 m^2) r0+12 (4150-55 m^2+2 m^4) r0^2+2 (-22933-699 m^2+56 m^4) r0^3+(21708+1330 m^2-92 m^4) r0^4+15 (-324-30 m^2+m^4) r0^5+(400+52 m^2+m^4) r0^6))-256 M (-3+r0) (m^4 (-3+r0)^2 r0 (-3 M+r0)^4 (r0^2 (-66+51 r0-10 r0^2)-4 M^2 (90-71 r0+14 r0^2)+2 M r0 (148-110 r0+18 r0^2+r0^3))-2 (-2+r0) r0 (r0^6 (468-762 r0+278 r0^2-17 r0^3)+648 M^7 (-30+71 r0-34 r0^2+4 r0^3)+4 M^2 r0^4 (1728-7314 r0+2325 r0^2+236 r0^3-18 r0^4)+M r0^5 (-3240+7050 r0-2423 r0^2-8 r0^3+8 r0^4)-540 M^6 (-36+42 r0+166 r0^2-103 r0^3+12 r0^4)+3 M^3 r0^3 (-2448+27066 r0-7513 r0^2-1790 r0^3+132 r0^4)-9 M^4 r0^2 (-2196+16986 r0-2838 r0^2-2159 r0^3+208 r0^4)+18 M^5 r0 (-2160+7986 r0+1515 r0^2-2578 r0^3+288 r0^4))+m^2 (1296 M^7 (-6+r0) (-3+r0)^2+r0^7 (2340-3378 r0+1924 r0^2-513 r0^3+54 r0^4)-2 M r0^6 (20502-29565 r0+16548 r0^2-4219 r0^3+390 r0^4+8 r0^5)+108 M^6 r0 (9396-11970 r0+5364 r0^2-735 r0^3-112 r0^4+30 r0^5)+2 M^2 r0^5 (144936-208896 r0+115584 r0^2-28535 r0^3+2358 r0^4+96 r0^5)-36 M^5 r0^2 (62910-86517 r0+43794 r0^2-8681 r0^3+71 r0^4+132 r0^5)-6 M^3 r0^4 (177390-254697 r0+139068 r0^2-33163 r0^3+2376 r0^4+168 r0^5)+9 M^4 r0^3 (238500-338226 r0+180244 r0^2-40553 r0^3+2134 r0^4+328 r0^5)))-128 l (-2 (-3+r0) r0^8 (-288+m^2 (-6+r0) (-3+r0)^2+564 r0-364 r0^2+89 r0^3-6 r0^4)+1296 M^8 (-162+9 (5+18 m^2) r0-27 (-13+5 m^2) r0^2+(-561+36 m^2) r0^3+(355-3 m^2) r0^4-99 r0^5+10 r0^6)+M r0^7 (33804-92862 r0+91134 r0^2-41648 r0^3+9338 r0^4-996 r0^5+48 r0^6+m^4 (-3+r0)^2 (-792+1074 r0-477 r0^2+70 r0^3)+m^2 (38394-71901 r0+54861 r0^2-21435 r0^3+4297 r0^4-353 r0^5))+9 M^5 r0^3 (406188-1078686 r0+1081830 r0^2-468536 r0^3+72166 r0^4+2600 r0^5-976 r0^6+3 m^4 (-3+r0)^2 (-7680+14690 r0-7779 r0^2+1178 r0^3+32 r0^4)+m^2 (1186002-2720457 r0+2354961 r0^2-978683 r0^3+190833 r0^4-11065 r0^5-776 r0^6))-6 M^4 r0^4 (322218-1014813 r0+1108533 r0^2-535366 r0^3+115768 r0^4-9751 r0^5+286 r0^6+6 m^4 (-3+r0)^2 (-4266+6915 r0-3358 r0^2+475 r0^3+15 r0^4)+m^2 (1251126-2696625 r0+2262306 r0^2-932463 r0^3+186840 r0^4-13174 r0^5-384 r0^6))-2 M^2 r0^6 (96066-309573 r0+331833 r0^2-160263 r0^3+37227 r0^4-4099 r0^5+214 r0^6+m^4 (-3+r0)^2 (-5316+7450 r0-3344 r0^2+471 r0^3+7 r0^4)+m^2 (250236-494496 r0+391989 r0^2-156614 r0^3+31463 r0^4-2470 r0^5-20 r0^6))-108 M^7 r0 (-14364+22518 r0-9150 r0^2-8744 r0^3+9642 r0^4-3112 r0^5+328 r0^6-9 m^4 (-3+r0)^2 r0 (90-71 r0+14 r0^2)+m^2 (-14094+48735 r0-47439 r0^2+19581 r0^3-3117 r0^4-85 r0^5+54 r0^6))+2 M^3 r0^5 (m^4 (-3+r0)^2 (-28548+42240 r0-19483 r0^2+2698 r0^3+72 r0^4)+m^2 (1360962-2803509 r0+2287035 r0^2-929625 r0^3+187273 r0^4-14185 r0^5-216 r0^6)+4 (84402-293373 r0+328989 r0^2-162741 r0^3+37761 r0^4-4013 r0^5+204 r0^6))-18 M^6 r0^2 (3 m^4 (-3+r0)^2 (-2088+5808 r0-3544 r0^2+601 r0^3+9 r0^4)-2 m^2 (-195210+501795 r0-453726 r0^2+188664 r0^3-34288 r0^4+1000 r0^5+294 r0^6)-2 (-98658+214821 r0-180609 r0^2+49269 r0^3+10881 r0^4-7295 r0^5+870 r0^6)))-64 l^2 (1296 M^8 (-324+108 (-1+3 m^2) r0-27 (-39+8 m^2) r0^2+3 (-449+15 m^2) r0^3+(728-3 m^2) r0^4-171 r0^5+14 r0^6)+2 r0^8 (3618-8901 r0+8673 r0^2-4213 r0^3+1059 r0^4-129 r0^5+6 r0^6+m^2 (-3+r0)^2 (36-36 r0+5 r0^2))-54 M^6 r0^2 (77760-132348 r0+42038 r0^2+60886 r0^3-49060 r0^4+11550 r0^5-756 r0^6+m^2 (228744-506520 r0+382434 r0^2-122612 r0^3+10834 r0^4+2444 r0^5-428 r0^6)+m^4 (-37584+110592 r0-99684 r0^2+38520 r0^3-6392 r0^4+305 r0^5+9 r0^6))+2 M^2 r0^6 (51408-155682 r0+276555 r0^2-235792 r0^3+95271 r0^4-17447 r0^5+1138 r0^6+m^4 (40500-53190 r0+19428 r0^2+1486 r0^3-2048 r0^4+267 r0^5+7 r0^6)+m^2 (-123606+116415 r0-1593 r0^2-33868 r0^3+14670 r0^4-2300 r0^5+100 r0^6))-108 M^7 r0 (-23328+24300 r0+11850 r0^2-37090 r0^3+23292 r0^4-5540 r0^5+424 r0^6-9 m^4 r0 (1620-2088 r0+981 r0^2-197 r0^3+14 r0^4)+m^2 (-28188+85860 r0-70713 r0^2+22431 r0^3-1068 r0^4-839 r0^5+126 r0^6))+M r0^7 (m^4 (-3564+2754 r0+1242 r0^2-1839 r0^3+627 r0^4-70 r0^5)+m^2 (972+15264 r0-21657 r0^2+11465 r0^3-2786 r0^4+265 r0^5)-2 (19332-56772 r0+70779 r0^2-44649 r0^3+14616 r0^4-2338 r0^5+144 r0^6))+9 M^5 r0^3 (247968-578556 r0+189918 r0^2+313458 r0^3-239452 r0^4+52644 r0^5-2976 r0^6+3 m^4 (-120528+255852 r0-191568 r0^2+63073 r0^3-8429 r0^4+186 r0^5+16 r0^6)-3 m^2 (-588492+1123716 r0-779845 r0^2+236531 r0^3-21244 r0^4-3715 r0^5+648 r0^6))-2 M^3 r0^5 (m^4 (300510-473715 r0+258903 r0^2-51138 r0^3-418 r0^4+736 r0^5+36 r0^6)+12 (13608-25494 r0+60523 r0^2-65906 r0^3+30346 r0^4-5860 r0^5+370 r0^6)+m^2 (-1168344+1673730 r0-802233 r0^2+92370 r0^3+40587 r0^4-12941 r0^5+996 r0^6))+6 M^4 r0^4 (22086+72099 r0+241134 r0^2-481864 r0^3+263243 r0^4-53140 r0^5+3108 r0^6+6 m^4 (56376-101574 r0+65871 r0^2-18216 r0^3+1723 r0^4+32 r0^5)+m^2 (-1484568+2508210 r0-1544139 r0^2+392331 r0^3-13104 r0^4-10864 r0^5+1320 r0^6)))+32 l^3 r0 (1296 M^8 (792-18 (71+12 m^2) r0+(709+102 m^2) r0^2+(41-11 m^2) r0^3-135 r0^4+26 r0^5)-108 M^7 (-21600+216 (361+215 m^2) r0+6 (-17384-15555 m^2+1620 m^4) r0^2+(60578+61767 m^2-10638 m^4) r0^3+3 (-2526-5903 m^2+1285 m^4) r0^4+(-4316+1891 m^2-462 m^4) r0^5+2 (500+3 m^2) r0^6)+2 r0^7 (-7776+16290 r0-11385 r0^2+2545 r0^3+352 r0^4-201 r0^5+18 r0^6+m^2 (-1620+1890 r0-756 r0^2+123 r0^3-7 r0^4))+M r0^6 (224640-623520 r0+620844 r0^2-283190 r0^3+60638 r0^4-5544 r0^5+192 r0^6+m^2 (237708-467118 r0+366132 r0^2-145503 r0^3+29533 r0^4-2447 r0^5)+m^4 (-35640+81000 r0-70470 r0^2+29694 r0^3-6099 r0^4+490 r0^5))-2 M^2 r0^5 (605826-1942569 r0+2220033 r0^2-1173096 r0^3+301860 r0^4-36232 r0^5+1768 r0^6+m^2 (1257660-2743380 r0+2328999 r0^2-979670 r0^3+205520 r0^4-16930 r0^5-92 r0^6)+m^4 (-195372+479322 r0-438084 r0^2+190078 r0^3-39158 r0^4+2895 r0^5+49 r0^6))-18 M^6 r0 (3 m^4 r0 (76032-145512 r0+97440 r0^2-27428 r0^3+2663 r0^4+33 r0^5)+2 (305856-824940 r0+989040 r0^2-573843 r0^3+129043 r0^4+2481 r0^5-2994 r0^6)-6 m^2 (-63072+312336 r0-410406 r0^2+226441 r0^3-56596 r0^4+4900 r0^5+130 r0^6))+9 M^5 r0^2 (2001888-5300856 r0+6195984 r0^2-3605642 r0^3+973282 r0^4-90308 r0^5-1440 r0^6+m^2 (2332368-7626528 r0+8360166 r0^2-4187817 r0^3+991019 r0^4-86129 r0^5-1272 r0^6)+3 m^4 (-70848+384624 r0-510768 r0^2+281638 r0^3-68651 r0^4+5562 r0^5+160 r0^6))-6 M^4 r0^3 (2158920-6074046 r0+7154127 r0^2-4136828 r0^3+1166377 r0^4-142720 r0^5+5228 r0^6+m^2 (3746088-10127232 r0+9977328 r0^2-4680519 r0^3+1066174 r0^4-93420 r0^5-576 r0^6)+2 m^4 (-237168+813348 r0-896994 r0^2+439974 r0^3-97679 r0^4+7010 r0^5+270 r0^6))+2 M^3 r0^4 (m^2 (5454378-13089501 r0+11918823 r0^2-5287566 r0^3+1156360 r0^4-98740 r0^5-468 r0^6)+m^4 (-793800+2199258 r0-2164005 r0^2+984450 r0^3-207268 r0^4+14512 r0^5+480 r0^6)+4 (598752-1864980 r0+2223984 r0^2-1257204 r0^3+348543 r0^4-44564 r0^5+2148 r0^6)))+2 l^11 r0^5 (-3456 M^6 (54-19 r0-21 r0^2+6 r0^3)+288 M^5 (2736-6 (566+207 m^2) r0+(3086+1605 m^2) r0^2-3 (566+241 m^2) r0^3+36 (8+3 m^2) r0^4)-48 M^4 (-26136+6 (15893+2016 m^2) r0+(-113597-25896 m^2+1080 m^4) r0^2+(67819+18990 m^2-852 m^4) r0^3+(-20429-6257 m^2+168 m^4) r0^4+6 (391+128 m^2) r0^5)+2 r0^3 (-33912+18 (4549+108 m^2) r0-3 (21101+774 m^2) r0^2+(9727+543 m^2) r0^3-7 (-1587+5 m^2) r0^4-5658 r0^5+768 r0^6)+4 M^3 (116640+72 (-10037+51 m^2) r0+(1569264+168354 m^2-7992 m^4) r0^2+3 (-532210-88993 m^2+6714 m^4) r0^3+(819258+152463 m^2-11615 m^4) r0^4+(-195360-39421 m^2+1766 m^4) r0^5+6 (2860+635 m^2+12 m^4) r0^6)+M r0^2 (m^4 r0^2 (-7128+8742 r0-3579 r0^2+490 r0^3)+m^2 (-20736+17784 r0+41466 r0^2-39971 r0^3+13805 r0^4-1747 r0^5)+2 (173232-492012 r0+521832 r0^2-267561 r0^3+52605 r0^4+5558 r0^5-2232 r0^6))-2 M^2 r0 (m^4 r0 (-1728-12504 r0+21256 r0^2-10124 r0^3+1383 r0^4+49 r0^5)+2 m^2 (-10368+5976 r0+77058 r0^2-91619 r0^3+40329 r0^4-7645 r0^5+458 r0^6)+2 (163728-624996 r0+939336 r0^2-748295 r0^3+309459 r0^4-55219 r0^5+2930 r0^6)))+8 l^5 r0^2 (5184 M^8 (378-9 (65+2 m^2) r0+(329+3 m^2) r0^2-63 r0^3+2 r0^4)-432 M^7 (-14904+6 (7324+1665 m^2) r0+(-46696-14595 m^2+810 m^4) r0^2+(20673+7851 m^2-639 m^4) r0^3+(-2945-1889 m^2+126 m^4) r0^4+2 (-16+81 m^2) r0^5)+216 M^6 (33696-24 (7567+3186 m^2) r0-4 (-83296-48369 m^2+4806 m^4) r0^2+2 (-141914-80279 m^2+11772 m^4) r0^3+(108737+59930 m^2-9532 m^4) r0^4+(-14301-10010 m^2+1255 m^4) r0^5+(-78+524 m^2+9 m^4) r0^6)+2 r0^6 (30888-49500 r0+10722 r0^2+21325 r0^3-15252 r0^4+3675 r0^5-294 r0^6+m^2 (6642-8397 r0+3105 r0^2-357 r0^3+7 r0^4))+2 M^2 r0^4 (1987524-5913594 r0+6964404 r0^2-3921323 r0^3+1062075 r0^4-123199 r0^5+4142 r0^6+m^2 (2509380-6557778 r0+6225210 r0^2-2822306 r0^3+625239 r0^4-53386 r0^5-364 r0^6)+m^4 (-279288+949536 r0-1049244 r0^2+517397 r0^3-116791 r0^4+9219 r0^5+161 r0^6))-36 M^5 r0 (677376-2447928 r0+3682296 r0^2-2762136 r0^3+991109 r0^4-141033 r0^5+3660 r0^6+3 m^4 r0 (54864-136248 r0+106358 r0^2-33289 r0^3+3414 r0^4+80 r0^5)+3 m^2 (93744-600216 r0+952850 r0^2-621037 r0^3+190245 r0^4-25007 r0^5+756 r0^6))+M r0^5 (m^4 (71280-199422 r0+197181 r0^2-90330 r0^3+19551 r0^4-1610 r0^5)+m^2 (-620946+1370025 r0-1139757 r0^2+468769 r0^3-97459 r0^4+8183 r0^5)+2 (-377082+960237 r0-890799 r0^2+347058 r0^3-40437 r0^4-5392 r0^5+1008 r0^6))+6 M^4 r0^2 (4704048-14776416 r0+20123796 r0^2-13892594 r0^3+4739509 r0^4-698825 r0^5+29214 r0^6+18 m^4 (-10368+93456 r0-152328 r0^2+95508 r0^3-25456 r0^4+2159 r0^5+81 r0^6)+2 m^2 (1844208-7261776 r0+9097524 r0^2-5102466 r0^3+1376763 r0^4-154855 r0^5+2688 r0^6))-2 M^3 r0^3 (m^4 (-697248+3290436 r0-4249206 r0^2+2312586 r0^3-555599 r0^4+43226 r0^5+1512 r0^6)+m^2 (8084124-25081758 r0+26981424 r0^2-13518687 r0^3+3289377 r0^4-321385 r0^5+1632 r0^6)+12 (596322-1805061 r0+2317445 r0^2-1483600 r0^3+471227 r0^4-66797 r0^5+3020 r0^6)))+2 l^12 r0^5 (-576 M^6 (54-19 r0-21 r0^2+6 r0^3)+144 M^5 (912-2 (1112+207 m^2) r0+5 (412+107 m^2) r0^2-(748+241 m^2) r0^3+12 (8+3 m^2) r0^4)+48 M^4 (4356-72 (131+28 m^2) r0+(13943+1950 m^2-180 m^4) r0^2+(-8194-253 m^2+142 m^4) r0^3-2 (-527+108 m^2+14 m^4) r0^4+(64+54 m^2) r0^5)+2 r0^3 (7452+36 (-1585+9 m^2) r0+27 (4237+16 m^2) r0^2-(102628+501 m^2) r0^3+(46604+70 m^2) r0^4-10329 r0^5+882 r0^6)+4 M^3 (19440+612 (-38+m^2) r0-12 (8447-1724 m^2+111 m^4) r0^2+3 (41294-985 m^2+664 m^4) r0^3-(82260+14675 m^2+859 m^4) r0^4+(38914+8915 m^2+82 m^4) r0^5+6 (-1040-243 m^2+2 m^4) r0^6)-M r0^2 (m^4 r0^2 (1188-456 r0-177 r0^2+70 r0^3)+m^2 (3456+14508 r0-30480 r0^2+17961 r0^3-5774 r0^4+640 r0^5)+2 (23544-231948 r0+515838 r0^2-488803 r0^3+234508 r0^4-55977 r0^5+5208 r0^6))+2 M^2 r0 (m^4 r0 (288+2448 r0-1844 r0^2+292 r0^3-3 r0^4+7 r0^5)+2 m^2 (1728+7740 r0-20760 r0^2+5093 r0^3+4972 r0^4-3200 r0^5+500 r0^6)+2 (-1080-116964 r0+361338 r0^2-380631 r0^3+201267 r0^4-56033 r0^5+6146 r0^6)))+l^9 r0^4 (-17280 M^7 (42+3 r0-33 r0^2+8 r0^3)+2880 M^6 (2520-42 (79+18 m^2) r0+(2441+994 m^2) r0^2-(1069+466 m^2) r0^3+18 (9+4 m^2) r0^4)-288 M^5 (-36000+60 (2524+487 m^2) r0+2 (-93879-27565 m^2+1350 m^4) r0^2+(106967+36910 m^2-2130 m^4) r0^3+(-28433-11270 m^2+420 m^4) r0^4+20 (139+65 m^2) r0^5)+48 M^4 (140400-360 (2147+332 m^2) r0+(1719852+468120 m^2-30240 m^4) r0^2+4 (-442273-131748 m^2+12510 m^4) r0^3+(881307+256694 m^2-24680 m^4) r0^4+(-196079-58716 m^2+3590 m^4) r0^5+6 (2543+844 m^2+15 m^4) r0^6)+r0^4 (305856-497880 r0+84396 r0^2+300530 r0^3-238067 r0^4+68391 r0^5-6882 r0^6+12 m^2 (1080-3420 r0+1998 r0^2-249 r0^3+r0^4))+2 M r0^3 (-1067472+2342304 r0-1881696 r0^2+532692 r0^3+113585 r0^4-94057 r0^5+13620 r0^6+m^4 r0 (-35640+75060 r0-52746 r0^2+15411 r0^3-1610 r0^4)+m^2 (-20520+381348 r0-553170 r0^2+301787 r0^3-77457 r0^4+7683 r0^5))+4 M^2 r0^2 (1699056-4894272 r0+6173688 r0^2-4229208 r0^3+1467421 r0^4-203457 r0^5+4898 r0^6+m^4 (4320+64800 r0-219096 r0^2+189572 r0^3-62872 r0^4+6735 r0^5+161 r0^6)+2 m^2 (7560-507204 r0+969570 r0^2-649299 r0^3+194875 r0^4-23385 r0^5+346 r0^6))-8 M^3 r0 (1289520-5010048 r0+8387760 r0^2-7292196 r0^3+3188797 r0^4-616009 r0^5+39384 r0^6+m^4 r0 (31320-228420 r0+254910 r0^2-98881 r0^3+11434 r0^4+480 r0^5)+m^2 (-35640-1011060 r0+2614686 r0^2-2195985 r0^3+829427 r0^4-141585 r0^5+7914 r0^6)))-l^10 r0^4 (3456 M^7 (42+3 r0-33 r0^2+8 r0^3)-576 M^6 (2520-6 (751+126 m^2) r0+(2859+994 m^2) r0^2-(607+466 m^2) r0^3+6 (5+12 m^2) r0^4)-288 M^5 (7200-12 (1688+487 m^2) r0+(27502+6472 m^2-540 m^4) r0^2+(-12347-1497 m^2+426 m^4) r0^3-(139+397 m^2+84 m^4) r0^4+4 (125+34 m^2) r0^5)-48 M^4 (28080-288 (204+83 m^2) r0-24 (1421-2053 m^2+252 m^4) r0^2+4 (20221-9 m^2+1512 m^4) r0^3-(81913+31104 m^2+1812 m^4) r0^4+(44833+16738 m^2+102 m^4) r0^5+2 (-3719-1302 m^2+9 m^4) r0^6)+r0^4 (302832-1189008 r0+1758996 r0^2-1291930 r0^3+495419 r0^4-92535 r0^5+6498 r0^6+4 m^2 (-648-1512 r0+4860 r0^2-2319 r0^3+259 r0^4))-2 M r0^3 (652320-2848752 r0+4637628 r0^2-3734204 r0^3+1573673 r0^4-324453 r0^5+25428 r0^6+m^4 r0 (-7128+1944 r0+7680 r0^2-5181 r0^3+910 r0^4)-m^2 (42120-147312 r0+91956 r0^2-16683 r0^3+197 r0^4+527 r0^5))+4 M^2 r0^2 (375840-2351664 r0+4759356 r0^2-4427796 r0^3+2126397 r0^4-505045 r0^5+46162 r0^6+m^4 (-864-16128 r0+21696 r0^2+4792 r0^3-9056 r0^4+1689 r0^5+91 r0^6)+2 m^2 (-20520+131616 r0-72804 r0^2-60097 r0^3+62203 r0^4-20183 r0^5+2210 r0^6))-8 M^3 r0 (-44064-536688 r0+2032836 r0^2-2352084 r0^3+1353531 r0^4-398779 r0^5+44976 r0^6+m^4 r0 (-6264+31032 r0-11052 r0^2-3887 r0^3+1418 r0^4+36 r0^5)+m^2 (7128+208944 r0-198072 r0^2-146289 r0^3+207338 r0^4-80396 r0^5+10350 r0^6)))+16 l^4 r0 (1296 M^8 (792-216 (3+m^2) r0+36 (-7+2 m^2) r0^2+(601-6 m^2) r0^3-261 r0^4+34 r0^5)-108 M^7 (-21600+216 (246+215 m^2) r0+24 (-1054-3195 m^2+405 m^4) r0^2-4 (6299-9105 m^2+2322 m^4) r0^3+3 (10782-1147 m^2+930 m^4) r0^4-(11302+1801 m^2+252 m^4) r0^5+8 (154+45 m^2) r0^6)+2 r0^7 (42012-107298 r0+110334 r0^2-57325 r0^3+15577 r0^4-2061 r0^5+102 r0^6+9 m^2 (288-588 r0+366 r0^2-88 r0^3+7 r0^4))-108 M^6 r0 (73872-113448 r0+9056 r0^2+95998 r0^3-75293 r0^4+19957 r0^5-1626 r0^6+m^4 r0 (38016-56736 r0+28260 r0^2-5108 r0^3+155 r0^4+9 r0^5)+m^2 (63072-248616 r0+240720 r0^2-76328 r0^3-4401 r0^4+6855 r0^5-962 r0^6))-M r0^6 (m^2 (69660-294822 r0+330912 r0^2-162355 r0^3+38022 r0^4-3543 r0^5)+m^4 (1782+25353 r0-47115 r0^2+30711 r0^3-8691 r0^4+910 r0^5)+4 (138294-390285 r0+467850 r0^2-290173 r0^3+95206 r0^4-15412 r0^5+960 r0^6))+2 M^2 r0^5 (912276-2769696 r0+3918873 r0^2-2895371 r0^3+1104669 r0^4-201408 r0^5+13648 r0^6+m^4 (71604-12798 r0-129306 r0^2+117517 r0^3-37397 r0^4+3795 r0^5+91 r0^6)+m^2 (-69336-685188 r0+1236462 r0^2-790899 r0^3+234553 r0^4-30840 r0^5+1132 r0^6))+6 M^4 r0^3 (200664-1895544 r0+4675776 r0^2-4792795 r0^3+2236704 r0^4-453160 r0^5+30740 r0^6+18 m^4 (22032-49248 r0+27768 r0^2-648 r0^3-2941 r0^4+501 r0^5+15 r0^6)+m^2 (-2148768+3369528 r0-910692 r0^2-811374 r0^3+583971 r0^4-136384 r0^5+10680 r0^6))+9 M^5 r0^2 (6 m^4 (-35424+146592 r0-134508 r0^2+41128 r0^3-1355 r0^4-834 r0^5+4 r0^6)-3 m^2 (-621216+1480776 r0-1002992 r0^2+150380 r0^3+90699 r0^4-38057 r0^5+4048 r0^6)-2 (-384048+265032 r0+787320 r0^2-1321374 r0^3+738329 r0^4-162243 r0^5+11088 r0^6))-2 M^3 r0^4 (m^4 (497988-677214 r0+29322 r0^2+274743 r0^3-121435 r0^4+13618 r0^5+540 r0^6)+m^2 (-1783620+713988 r0+2503413 r0^2-2590053 r0^3+999287 r0^4-169458 r0^5+9768 r0^6)+4 (458784-1544580 r0+2564670 r0^2-2176344 r0^3+917208 r0^4-177553 r0^5+12222 r0^6)))-3 l^8 r0^3 (6912 M^8 (6+5 r0-9 r0^2+2 r0^3)-576 M^7 (2472-2 (2108+219 m^2) r0+3 (762+169 m^2) r0^2-(254+233 m^2) r0^3+4 (-8+9 m^2) r0^4)-576 M^6 (4368-4 (2579+906 m^2) r0+(11936+4562 m^2-360 m^4) r0^2+(-4321-1543 m^2+284 m^4) r0^3-(675+35 m^2+56 m^4) r0^4+(318+62 m^2) r0^5)-144 M^5 (14976-48 (1092+545 m^2) r0-8 (-3039-5785 m^2+786 m^4) r0^2+2 (9612-6413 m^2+3004 m^4) r0^3-(34966+11307 m^2+1744 m^4) r0^4+(18942+7525 m^2+120 m^4) r0^5+8 (-374-153 m^2+m^4) r0^6)-2 r0^5 (162648-502776 r0+626568 r0^2-398065 r0^3+133221 r0^4-21693 r0^5+1302 r0^6+m^2 (864-9864 r0+11232 r0^2-3756 r0^3+359 r0^4))+M r0^4 (1699488-5617872 r0+7766880 r0^2-5586924 r0^3+2131170 r0^4-396422 r0^5+27648 r0^6+m^2 (-139104+72936 r0+190848 r0^2-172172 r0^3+52451 r0^4-6049 r0^5)+2 m^4 (4752-3672 r0-17100 r0^2+21624 r0^3-8769 r0^4+1190 r0^5))-48 M^4 r0 (-23904-47400 r0+400620 r0^2-555530 r0^3+345187 r0^4-101771 r0^5+11094 r0^6+24 m^4 r0 (-468+996 r0-351 r0^2-71 r0^3+33 r0^4)+4 m^2 (-4320+31236 r0-22944 r0^2-15795 r0^3+21099 r0^4-7775 r0^5+963 r0^6))-4 M^2 r0^3 (852336-3305448 r0+5430264 r0^2-4583198 r0^3+2020509 r0^4-429997 r0^5+34394 r0^6+m^4 (11232-41616 r0-7584 r0^2+48428 r0^3-24988 r0^4+3405 r0^5+119 r0^6)+m^2 (-180576+199080 r0+295056 r0^2-440756 r0^3+208143 r0^4-43825 r0^5+3338 r0^6))+4 M^3 r0^2 (2 m^4 (3024-66168 r0+50796 r0^2+24444 r0^3-25693 r0^4+4366 r0^5+180 r0^6)+6 (89424-584424 r0+1331776 r0^2-1363934 r0^3+695241 r0^4-168799 r0^5+15352 r0^6)+m^2 (-391392+909432 r0+202104 r0^2-1158384 r0^3+765273 r0^4-208423 r0^5+20712 r0^6)))-2 l^7 r0^3 (41472 M^8 (6+5 r0-9 r0^2+2 r0^3)-3456 M^7 (2472-2 (1793+219 m^2) r0+3 (777+169 m^2) r0^2-(749+233 m^2) r0^3+4 (22+9 m^2) r0^4)+1728 M^6 (-8736+16 (2077+453 m^2) r0+2 (-19637-6452 m^2+360 m^4) r0^2+(20429+8056 m^2-568 m^4) r0^3+(-4457-2260 m^2+112 m^4) r0^4+(306+236 m^2) r0^5)-864 M^5 (14976-48 (1842+545 m^2) r0+(185784+75500 m^2-6288 m^4) r0^2+2 (-88777-36255 m^2+4354 m^4) r0^3+(80075+31488 m^2-3874 m^4) r0^4+(-15145-6396 m^2+540 m^4) r0^5+(844+472 m^2+8 m^4) r0^6)-2 r0^5 (-103032+128934 r0+48531 r0^2-155913 r0^3+94124 r0^4-22899 r0^5+1974 r0^6+m^2 (-14256+23760 r0-9558 r0^2+789 r0^3+35 r0^4))+48 M^4 r0 (564624-2321856 r0+3926610 r0^2-3298881 r0^3+1356560 r0^4-240654 r0^5+13024 r0^6+18 m^4 r0 (3744-13008 r0+11808 r0^2-4066 r0^3+437 r0^4+15 r0^5)+3 m^2 (34560-369408 r0+696024 r0^2-510456 r0^3+175836 r0^4-27371 r0^5+1320 r0^6))+2 M^2 r0^3 (3 m^4 (-36288+289728 r0-451416 r0^2+274048 r0^3-71684 r0^4+6351 r0^5+121 r0^6)-2 m^2 (-1014768+4007232 r0-4717974 r0^2+2446969 r0^3-599675 r0^4+55835 r0^5+330 r0^6)+2 (2278368-6224436 r0+7396848 r0^2-4485125 r0^3+1317471 r0^4-150335 r0^5+1890 r0^6))+M r0^4 (-3 m^4 (-19008+85968 r0-107856 r0^2+57342 r0^3-13731 r0^4+1210 r0^5)+m^2 (-729648+2200608 r0-2130702 r0^2+956825 r0^3-212659 r0^4+18725 r0^5)+2 (-997920+2164572 r0-1699032 r0^2+412679 r0^3+122479 r0^4-72740 r0^5+8736 r0^6))-4 M^3 r0^2 (3 m^4 (-12096+327312 r0-689328 r0^2+494478 r0^3-144347 r0^4+13214 r0^5+504 r0^6)+m^2 (2134512-11482560 r0+16466382 r0^2-9992061 r0^3+2873113 r0^4-348347 r0^5+8022 r0^6)+2 (2900448-9401508 r0+13419000 r0^2-9910677 r0^3+3660189 r0^4-590818 r0^5+28860 r0^6)))-4 l^6 r0^2 (10368 M^8 (-126+(209+6 m^2) r0-(98+m^2) r0^2+4 r0^4)-864 M^7 (4968-1110 (8+3 m^2) r0+(7492+3843 m^2-270 m^4) r0^2+3 (-477-478 m^2+71 m^4) r0^3+(-997+86 m^2-42 m^4) r0^4+(272+30 m^2) r0^5)-432 M^6 (11232-24 (1673+1062 m^2) r0+(27640+47580 m^2-6408 m^4) r0^2+(3980-21646 m^2+6168 m^4) r0^3-(16839+1140 m^2+1852 m^4) r0^4+(8435+3024 m^2+157 m^4) r0^5+(-1206-544 m^2+3 m^4) r0^6)+2 r0^6 (198450-542493 r0+603645 r0^2-342711 r0^3+102415 r0^4-14901 r0^5+798 r0^6+m^2 (6156-19008 r0+14661 r0^2-4002 r0^3+343 r0^4))+M r0^5 (-2389824+6998364 r0-8814462 r0^2+5822122 r0^3-2044144 r0^4+351764 r0^5-22848 r0^6-3 m^4 (4752+14148 r0-40968 r0^2+32127 r0^3-10299 r0^4+1190 r0^5)+m^2 (11988+547020 r0-858633 r0^2+484319 r0^3-122866 r0^4+12227 r0^5))+216 M^5 r0 (40320-48888 r0-101712 r0^2+200908 r0^3-131911 r0^4+36687 r0^5-3564 r0^6+m^4 r0 (18288-30744 r0+13874 r0^2-1063 r0^3-318 r0^4+8 r0^5)+m^2 (31248-139032 r0+127814 r0^2-9059 r0^3-31205 r0^4+13615 r0^5-1720 r0^6))+12 M^4 r0^2 (-54000-1765944 r0+5646528 r0^2-6428550 r0^3+3342623 r0^4-779607 r0^5+64810 r0^6+6 m^4 (10368-67248 r0+54216 r0^2+144 r0^3-9806 r0^4+1943 r0^5+45 r0^6)+12 m^2 (-82296+174000 r0-37398 r0^2-94206 r0^3+70840 r0^4-19422 r0^5+1881 r0^6))+2 M^2 r0^4 (3295728-10615356 r0+15660846 r0^2-12212194 r0^3+4972293 r0^4-970639 r0^5+70482 r0^6+3 m^4 (41904-27936 r0-88524 r0^2+103976 r0^3-38254 r0^4+4323 r0^5+119 r0^6)+2 m^2 (-258228-466884 r0+1465977 r0^2-1141969 r0^3+393068 r0^4-61730 r0^5+3222 r0^6))-2 M^3 r0^3 (6 m^4 (70416-167364 r0+11844 r0^2+104781 r0^3-53824 r0^4+6886 r0^5+282 r0^6)+m^2 (-2949048+1922832 r0+5549670 r0^2-6989130 r0^3+3163745 r0^4-645673 r0^5+48372 r0^6)+4 (1057536-4450410 r0+8197425 r0^2-7496121 r0^3+3427794 r0^4-729574 r0^5+56562 r0^6)))) Conjugate[Y])/((-1+l) l (1+l) (2+l) r0^5 (-2 M+r0)^6 (6+(-2+l+l^2) r0)^3 (6 M+(-2+l+l^2) r0)^4))};
{cin2,cin4,cup2,cup4}=LinearSolve[\[CapitalPhi],J];
Function[{r},Evaluate[Piecewise[{{cin2 R2In[r]+cin4 R4In[r],r<=r0},{cup2 R2Up[r]+cup4 R4Up[r],r>r0}},Indeterminate]]]
];


(* ::Input::Initialization:: *)
\[Psi][s:1,l_,m_,r0_]/;EvenQ[l+m]:=Module[{M=1,\[CapitalOmega],\[Omega],\[CapitalPhi],J,Y,RIn,RUp,cin,cup},
\[CapitalOmega]=Sqrt[M/r0^3];
\[Omega]=m \[CapitalOmega];
Block[{$rminUp=r0-1,$rmaxIn=r0+1},
RIn=\[Psi]2In[s,l,\[Omega]];
RUp=\[Psi]2Up[s,l,\[Omega]];
];

\[CapitalPhi]={{-RIn[r0],RUp[r0]},{-RIn'[r0],RUp'[r0]}};
Y=SphericalHarmonicY[l,m,\[Pi]/2,0];
J={(32 I \[Pi] Sqrt[1/(-3+r0)] (-2+r0)^3 r0 Conjugate[Y])/(3 l (1+l) m (-2 M+r0)^2),(16 I \[Pi] Sqrt[1/(-3+r0)] (-2+r0) r0 (-8+(4-4 l-4 l^2+m^2) r0+l (1+l) r0^2-2 M (-4+m^2+l (-4+r0)+l^2 (-4+r0)+2 r0)) Conjugate[Y])/(3 l (1+l) m (2 M-r0)^3)};
{cin,cup}=LinearSolve[\[CapitalPhi],J];
Function[{r},Evaluate[Piecewise[{{cin RIn[r],r<=r0},{cup RUp[r],r>r0}},Indeterminate]]]
];


(* ::Input::Initialization:: *)
\[Phi][s:1,l_,m_,r0_]/;EvenQ[l+m]:=Module[{M=1,\[CapitalOmega],\[Omega],\[CapitalPhi],J,Y,R2In,R2Up,R4In,R4Up,cin2,cup2,cin4,cup4},
\[CapitalOmega]=Sqrt[M/r0^3];
\[Omega]=m \[CapitalOmega];
Block[{$rminUp=r0-1,$rmaxIn=r0+1},
R2In=\[Psi]2In[s,l,\[Omega]];
R2Up=\[Psi]2Up[s,l,\[Omega]];
R4In=\[Psi]4In[s,l,\[Omega]];
R4Up=\[Psi]4Up[s,l,\[Omega]];
];

\[CapitalPhi]={{-R2In[r0],-R4In[r0],R2Up[r0],R4Up[r0]},
{-R2In'[r0],-R4In'[r0],R2Up'[r0],R4Up'[r0]},
{-R2In''[r0],-R4In''[r0],R2Up''[r0],R4Up''[r0]},
{-R2In'''[r0],-R4In'''[r0],R2Up'''[r0],R4Up'''[r0]}};
Y=SphericalHarmonicY[l,m,\[Pi]/2,0];
J={1/(3 l (1+l) m (-2 M+r0)^3) 16 I \[Pi] (1/(-3+r0))^(3/2) (-2+r0) (r0 (48+r0 (-20+m^2 (-3+r0)+l (-4+r0) (-3+r0)+l^2 (-4+r0) (-3+r0)+r0 (-8+3 r0)))-2 M (-24+r0 (76+m^2 (-3+r0)+l (-4+r0) (-3+r0)+l^2 (-4+r0) (-3+r0)+r0 (-50+9 r0)))) Conjugate[Y],
-(1/(3 l (1+l) m (-2 M+r0)^4))8 I \[Pi] (1/(-3+r0))^(3/2) (4 (-1+M) (-2+r0) r0 (24-10 r0+r0^2+M (-20+6 r0))+m^2 (4 M^2 (-4+r0) r0-r0^2 (12-6 r0+r0^2)-4 M (24-50 r0+31 r0^2-9 r0^3+r0^4))+l (4 M^2 r0 (28-18 r0+3 r0^2)-4 M (48-64 r0+62 r0^2-27 r0^3+4 r0^4)+r0 (96-128 r0+96 r0^2-36 r0^3+5 r0^4))+l^2 (4 M^2 r0 (28-18 r0+3 r0^2)-4 M (48-64 r0+62 r0^2-27 r0^3+4 r0^4)+r0 (96-128 r0+96 r0^2-36 r0^3+5 r0^4))) Conjugate[Y],
1/(3 l (1+l) m r0 (-2 M+r0)^5) 16 I \[Pi] (1/(-3+r0))^(3/2) (m^4 M (2 M-r0) r0 (6-5 r0+r0^2)+m^2 (4 M^3 (-4+r0) r0+l (1+l) r0^3 (6-5 r0+r0^2)-M r0 (-240+364 r0+2 (-95+3 l+3 l^2) r0^2+(41-5 l-5 l^2) r0^3+(-3+l+l^2) r0^4)+2 M^2 (-144-4 (-47+3 l+3 l^2) r0+2 (-33+8 l+8 l^2) r0^2+(4-7 l-7 l^2) r0^3+(1+l+l^2) r0^4))+r0 (l (1+l) (-2+r0) r0 (48+4 (-5+3 l+3 l^2) r0-(8+7 l+7 l^2) r0^2+(3+l+l^2) r0^3)+4 M^3 (40-32 r0+6 r0^2+l (28-18 r0+3 r0^2)+l^2 (28-18 r0+3 r0^2))+4 M^2 (-88+76 r0-18 r0^2+r0^3+2 l^3 (-24+26 r0-9 r0^2+r0^3)+l^4 (-24+26 r0-9 r0^2+r0^3)+2 l^2 (-68+70 r0-25 r0^2+3 r0^3)+l (-112+114 r0-41 r0^2+5 r0^3))+M (-4 (-48+44 r0-12 r0^2+r0^3)-8 l^3 r0 (-24+26 r0-9 r0^2+r0^3)-4 l^4 r0 (-24+26 r0-9 r0^2+r0^3)+l^2 (192+144 r0-352 r0^2+164 r0^3-23 r0^4)+l (192+48 r0-248 r0^2+128 r0^3-19 r0^4)))) Conjugate[Y],
-(1/(3 l (1+l) m r0^2 (-2 M+r0)^6))8 I \[Pi] (1/(-3+r0))^(3/2) (m^4 M r0 (r0^2 (48-36 r0+7 r0^2)+4 M^2 (72-56 r0+11 r0^2)+4 M (24-104 r0+76 r0^2-18 r0^3+r0^4))+m^2 (l (1+l) r0^4 (12-14 r0+3 r0^2)+4 M^3 (-576-96 (-4+3 l+3 l^2) r0+4 (28+73 l+73 l^2) r0^2-4 (33+23 l+23 l^2) r0^3+3 (8+3 l+3 l^2) r0^4)+M r0^2 (8 (-60+64 r0-24 r0^2+3 r0^3)+l (-192+112 r0+4 r0^2+4 r0^3-3 r0^4)+l^2 (-192+112 r0+4 r0^2+4 r0^3-3 r0^4))-4 M^2 r0 (2 (-384+444 r0-170 r0^2+18 r0^3+r0^4)+l (-96-76 r0+134 r0^2-41 r0^3+3 r0^4)+l^2 (-96-76 r0+134 r0^2-41 r0^3+3 r0^4)))+r0 (-2 l^3 (-2 M+r0)^2 (-96+56 (4+M) r0-4 (50+9 M) r0^2+6 (12+M) r0^3-9 r0^4)-l^4 (-2 M+r0)^2 (-96+56 (4+M) r0-4 (50+9 M) r0^2+6 (12+M) r0^3-9 r0^4)+16 (-1+M) M (-2+r0) r0 (24-10 r0+r0^2+M (-20+6 r0))+4 l r0 (-8 M^3 (-4+r0)+8 M^2 (-34+43 r0-20 r0^2+3 r0^3)+r0 (-48+44 r0+8 r0^2-15 r0^3+3 r0^4)-2 M (-48-24 r0+98 r0^2-56 r0^3+9 r0^4))+l^2 (-8 M^3 r0 (12-14 r0+3 r0^2)-2 M r0^2 (-544+820 r0-386 r0^2+57 r0^3)+r0^2 (-96-48 r0+232 r0^2-132 r0^3+21 r0^4)+4 M^2 (96-496 r0+600 r0^2-268 r0^3+39 r0^4)))) Conjugate[Y]};
{cin2,cin4,cup2,cup4}=LinearSolve[\[CapitalPhi],J];
Function[{r},Evaluate[Piecewise[{{cin2 R2In[r]+cin4 R4In[r],r<=r0},{cup2 R2Up[r]+cup4 R4Up[r],r>r0}},Indeterminate]]]
];


(* ::Input::Initialization:: *)
\[Psi][s:0,l_,m_,r0_]/;EvenQ[l+m]:=Module[{M=1,\[CapitalOmega],\[Omega],\[CapitalPhi],J,Y,RIn,RUp,cin,cup},
\[CapitalOmega]=Sqrt[M/r0^3];
\[Omega]=m \[CapitalOmega];
Block[{$rminUp=r0-1,$rmaxIn=r0+1},
RIn=\[Psi]2In[s,l,\[Omega]];
RUp=\[Psi]2Up[s,l,\[Omega]];
];

\[CapitalPhi]={{-RIn[r0],RUp[r0]},{-RIn'[r0],RUp'[r0]}};
Y=SphericalHarmonicY[l,m,\[Pi]/2,0];
J={0,-((16 \[Pi] (-2+r0) Conjugate[Y])/((2 M-r0)^2 Sqrt[r0/(-3+r0)]))};
{cin,cup}=LinearSolve[\[CapitalPhi],J];
Function[{r},Evaluate[Piecewise[{{cin RIn[r],r<=r0},{cup RUp[r],r>r0}},Indeterminate]]]
];


(* ::Input::Initialization:: *)
\[Phi][s:0,l_,m_,r0_]/;EvenQ[l+m]:=Module[{M=1,\[CapitalOmega],\[Omega],\[CapitalPhi],J,Y,R2In,R2Up,R4In,R4Up,cin2,cup2,cin4,cup4},
\[CapitalOmega]=Sqrt[M/r0^3];
\[Omega]=m \[CapitalOmega];
Block[{$rminUp=r0-1,$rmaxIn=r0+1},
R2In=\[Psi]2In[s,l,\[Omega]];
R2Up=\[Psi]2Up[s,l,\[Omega]];
R4In=\[Psi]4In[s,l,\[Omega]];
R4Up=\[Psi]4Up[s,l,\[Omega]];
];

\[CapitalPhi]={{-R2In[r0],-R4In[r0],R2Up[r0],R4Up[r0]},
{-R2In'[r0],-R4In'[r0],R2Up'[r0],R4Up'[r0]},
{-R2In''[r0],-R4In''[r0],R2Up''[r0],R4Up''[r0]},
{-R2In'''[r0],-R4In'''[r0],R2Up'''[r0],R4Up'''[r0]}};
Y=SphericalHarmonicY[l,m,\[Pi]/2,0];
J={(16 \[Pi] (-2+r0) Conjugate[Y])/(Sqrt[r0/(-3+r0)] (-2 M+r0)^2),(8 \[Pi] Sqrt[r0/(-3+r0)] (2 M (-18+7 r0)+r0 (30-17 r0+2 r0^2)) Conjugate[Y])/(r0^2 (-2 M+r0)^3),1/(r0^3 (-2 M+r0)^4) 16 \[Pi] Sqrt[r0/(-3+r0)] (M^2 (12+6 r0-4 r0^2)+l (1+l) r0^2 (6-5 r0+r0^2)-M r0 (18-7 r0+2 l (6-5 r0+r0^2)+2 l^2 (6-5 r0+r0^2)+m^2 (6-5 r0+r0^2))) Conjugate[Y],-(1/(r0^4 (-2 M+r0)^5))8 \[Pi] Sqrt[r0/(-3+r0)] (8 M^3 (-6-3 r0+2 r0^2)+l (1+l) r0^3 (-6-3 r0+2 r0^2)+M r0^2 (6 (-18+7 r0)-4 l (-12+2 r0+r0^2)-4 l^2 (-12+2 r0+r0^2)+m^2 (66-47 r0+8 r0^2))-2 M^2 r0 (-72+l (36-14 r0)+l^2 (36-14 r0)-4 r0+12 r0^2+m^2 (90-67 r0+12 r0^2))) Conjugate[Y]};
{cin2,cin4,cup2,cup4}=LinearSolve[\[CapitalPhi],J];
Function[{r},Evaluate[Piecewise[{{cin2 R2In[r]+cin4 R4In[r],r<=r0},{cup2 R2Up[r]+cup4 R4Up[r],r>r0}},Indeterminate]]]
];


(* ::Input::Initialization:: *)
\[Psi]b[s:0,l_,m_,r0_]/;EvenQ[l+m]:=Module[{M=1,\[CapitalOmega],\[Omega],\[CapitalPhi],J,Y,RIn,RUp,cin,cup},
\[CapitalOmega]=Sqrt[M/r0^3];
\[Omega]=m \[CapitalOmega];
Block[{$rminUp=r0-1,$rmaxIn=r0+1},
RIn=\[Psi]2In[s,l,\[Omega]];
RUp=\[Psi]2Up[s,l,\[Omega]];
];

\[CapitalPhi]={{-RIn[r0],RUp[r0]},{-RIn'[r0],RUp'[r0]}};
Y=SphericalHarmonicY[l,m,\[Pi]/2,0];
J={-((4 \[Pi] (-2+r0)^2 r0^3 Sqrt[r0/(-3+r0)] Conjugate[Y])/(m^2 (2 M-r0)^2)),-((2 \[Pi] (-2+r0) r0^2 Sqrt[r0/(-3+r0)] (-2 M (2 (2+m^2)+l (-11+3 r0)+l^2 (-11+3 r0))+r0 (2 (4+m^2-r0)+l (-11+3 r0)+l^2 (-11+3 r0))) Conjugate[Y])/(m^2 (2 M-r0)^3))};
{cin,cup}=LinearSolve[\[CapitalPhi],J];
Function[{r},Evaluate[Piecewise[{{cin RIn[r],r<=r0},{cup RUp[r],r>r0}},Indeterminate]]]
];


(* ::Input::Initialization:: *)
\[Phi]b[s:0,l_,m_,r0_]/;EvenQ[l+m]:=Module[{M=1,\[CapitalOmega],\[Omega],\[CapitalPhi],J,Y,R2In,R2Up,R4In,R4Up,cin2,cup2,cin4,cup4},
\[CapitalOmega]=Sqrt[M/r0^3];
\[Omega]=m \[CapitalOmega];
Block[{$rminUp=r0-1,$rmaxIn=r0+1},
R2In=\[Psi]2In[s,l,\[Omega]];
R2Up=\[Psi]2Up[s,l,\[Omega]];
R4In=\[Psi]4In[s,l,\[Omega]];
R4Up=\[Psi]4Up[s,l,\[Omega]];
];

\[CapitalPhi]={{-R2In[r0],-R4In[r0],R2Up[r0],R4Up[r0]},
{-R2In'[r0],-R4In'[r0],R2Up'[r0],R4Up'[r0]},
{-R2In''[r0],-R4In''[r0],R2Up''[r0],R4Up''[r0]},
{-R2In'''[r0],-R4In'''[r0],R2Up'''[r0],R4Up'''[r0]}};
Y=SphericalHarmonicY[l,m,\[Pi]/2,0];
J={-1/(m^2 (-2 M+r0)^3) 2 \[Pi] (1/(-3+r0))^(3/2) (-2+r0) r0^(5/2) (-66 l (1+l) M+12 (-5+m^2) M-6 r0+(33 l (1+l)-6 m^2+82 M+40 l (1+l) M-4 m^2 M) r0-(11-2 m^2+20 M+2 l (1+l) (10+3 M)) r0^2+(4+3 l (1+l)) r0^3) Conjugate[Y],1/(m^2 (-2 M+r0)^4) \[Pi] (r0/(-3+r0))^(3/2) (r0^2 (48-108 r0+54 r0^2-8 r0^3+2 m^2 (6-9 r0+2 r0^2)+l (-114+217 r0-107 r0^2+16 r0^3)+l^2 (-114+217 r0-107 r0^2+16 r0^3))-4 M r0 (132-188 r0+77 r0^2-10 r0^3+m^2 (12-12 r0-r0^2+r0^3)+l (-156+258 r0-119 r0^2+17 r0^3)+l^2 (-156+258 r0-119 r0^2+17 r0^3))+4 M^2 (l (-198+299 r0-131 r0^2+18 r0^3)+l^2 (-198+299 r0-131 r0^2+18 r0^3)+2 (60-70 r0+22 r0^2-2 r0^3+m^2 (18-19 r0+4 r0^2)))) Conjugate[Y],1/(m^2 r0 (-2 M+r0)^4) 2 \[Pi] ((8 (-2+r0)^2 r0 Sqrt[r0/(-3+r0)] (238 M^3+(-140+12 l+12 l^2+3 m^2) M^2 r0-2 (-9+4 l+4 l^2) M r0^2+l (1+l) r0^3))/(-2 M+r0)+1/(-2 M+r0) 2 (-10+2 l+2 l^2+m^2) M (1/(-3+r0))^(3/2) (-2+r0) r0^(5/2) (-66 l (1+l) M+12 (-5+m^2) M-6 r0+(33 l (1+l)-6 m^2+82 M+40 l (1+l) M-4 m^2 M) r0-(11-2 m^2+20 M+2 l (1+l) (10+3 M)) r0^2+(4+3 l (1+l)) r0^3)-1/(-2 M+r0) 2 l (1/(-3+r0))^(3/2) (-2+r0) r0^(7/2) (-66 l (1+l) M+12 (-5+m^2) M-6 r0+(33 l (1+l)-6 m^2+82 M+40 l (1+l) M-4 m^2 M) r0-(11-2 m^2+20 M+2 l (1+l) (10+3 M)) r0^2+(4+3 l (1+l)) r0^3)-1/(-2 M+r0) 2 l^2 (1/(-3+r0))^(3/2) (-2+r0) r0^(7/2) (-66 l (1+l) M+12 (-5+m^2) M-6 r0+(33 l (1+l)-6 m^2+82 M+40 l (1+l) M-4 m^2 M) r0-(11-2 m^2+20 M+2 l (1+l) (10+3 M)) r0^2+(4+3 l (1+l)) r0^3)+1/(-2 M+r0) 68 M^2 (-2+r0) (r0/(-3+r0))^(3/2) (-66 l (1+l) M+12 (-5+m^2) M-6 r0+(33 l (1+l)-6 m^2+82 M+40 l (1+l) M-4 m^2 M) r0-(11-2 m^2+20 M+2 l (1+l) (10+3 M)) r0^2+(4+3 l (1+l)) r0^3)-1/(-2 M+r0)^2 4 M^2 (r0/(-3+r0))^(3/2) (r0^2 (48-108 r0+54 r0^2-8 r0^3+2 m^2 (6-9 r0+2 r0^2)+l (-114+217 r0-107 r0^2+16 r0^3)+l^2 (-114+217 r0-107 r0^2+16 r0^3))-4 M r0 (132-188 r0+77 r0^2-10 r0^3+m^2 (12-12 r0-r0^2+r0^3)+l (-156+258 r0-119 r0^2+17 r0^3)+l^2 (-156+258 r0-119 r0^2+17 r0^3))+4 M^2 (l (-198+299 r0-131 r0^2+18 r0^3)+l^2 (-198+299 r0-131 r0^2+18 r0^3)+2 (60-70 r0+22 r0^2-2 r0^3+m^2 (18-19 r0+4 r0^2))))+1/(-2 M+r0)^2 2 M r0 (r0/(-3+r0))^(3/2) (r0^2 (48-108 r0+54 r0^2-8 r0^3+2 m^2 (6-9 r0+2 r0^2)+l (-114+217 r0-107 r0^2+16 r0^3)+l^2 (-114+217 r0-107 r0^2+16 r0^3))-4 M r0 (132-188 r0+77 r0^2-10 r0^3+m^2 (12-12 r0-r0^2+r0^3)+l (-156+258 r0-119 r0^2+17 r0^3)+l^2 (-156+258 r0-119 r0^2+17 r0^3))+4 M^2 (l (-198+299 r0-131 r0^2+18 r0^3)+l^2 (-198+299 r0-131 r0^2+18 r0^3)+2 (60-70 r0+22 r0^2-2 r0^3+m^2 (18-19 r0+4 r0^2))))-(r0/(-3+r0))^(3/2) (-l (1+l) (-2+r0) r0^2 (-54+2 m^2 (-3+r0)+29 r0-4 r0^2+l (33-20 r0+3 r0^2)+l^2 (33-20 r0+3 r0^2))+M^2 (l (-3036+2878 r0-878 r0^2+84 r0^3)+l^2 (-3036+2878 r0-878 r0^2+84 r0^3)+4 (1716-1806 r0+624 r0^2-72 r0^3+m^2 (138-103 r0+20 r0^2)))+M r0 (2 m^4 (6-5 r0+r0^2)+4 l^3 (-66+73 r0-26 r0^2+3 r0^3)+2 l^4 (-66+73 r0-26 r0^2+3 r0^3)+12 (-150+141 r0-42 r0^2+4 r0^3)+m^2 (-240+238 r0-85 r0^2+10 r0^3)+l (1302-1207 r0+361 r0^2-34 r0^3+m^2 (-42+53 r0-22 r0^2+3 r0^3))+l^2 (1170-1061 r0+309 r0^2-28 r0^3+m^2 (-42+53 r0-22 r0^2+3 r0^3))))) Conjugate[Y],1/(m^2 Sqrt[r0] (-2 M+r0)^6) \[Pi] (1/(-3+r0))^(3/2) (-2 l^3 r0 (-2 M+r0)^2 (r0 (378-509 r0+211 r0^2-28 r0^3)+M (-396+598 r0-262 r0^2+36 r0^3))-l^4 r0 (-2 M+r0)^2 (r0 (378-509 r0+211 r0^2-28 r0^3)+M (-396+598 r0-262 r0^2+36 r0^3))+2 M (-4 (-1+M) r0 (3 r0^2 (18-19 r0+4 r0^2)-8 M r0 (36-34 r0+7 r0^2)+4 M^2 (42-39 r0+8 r0^2))+m^4 r0 (r0^2 (30-21 r0+4 r0^2)+4 M^2 (54-41 r0+8 r0^2)+2 M r0 (-96+78 r0-19 r0^2+r0^3))-m^2 (16 M^3 (30-29 r0+6 r0^2)+r0^3 (-228+216 r0-51 r0^2+2 r0^3)+4 M r0^2 (294-249 r0+42 r0^2+2 r0^3)-4 M^2 r0 (300-180 r0-25 r0^2+16 r0^3)))-l (2 M-r0) (8 M^3 (-330+445 r0-183 r0^2+24 r0^3)+2 r0^3 (48-22 r0-11 r0^2+4 r0^3+m^2 (30-29 r0+6 r0^2))-M r0^2 (1524-2034 r0+774 r0^2-92 r0^3+m^2 (426-349 r0+61 r0^2+2 r0^3))-2 M^2 r0 (m^2 (-666+653 r0-197 r0^2+18 r0^3)+4 (-678+919 r0-376 r0^2+49 r0^3)))-l^2 (2 M-r0) (8 M^3 (-330+445 r0-183 r0^2+24 r0^3)+r0^3 (-282+465 r0-233 r0^2+36 r0^3+2 m^2 (30-29 r0+6 r0^2))-M r0^2 (372-418 r0+90 r0^2+m^2 (426-349 r0+61 r0^2+2 r0^3))-2 M^2 r0 (m^2 (-666+653 r0-197 r0^2+18 r0^3)+2 (-1158+1539 r0-621 r0^2+80 r0^3)))) Conjugate[Y]};
{cin2,cin4,cup2,cup4}=LinearSolve[\[CapitalPhi],J];
Function[{r},Evaluate[Piecewise[{{cin2 R2In[r]+cin4 R4In[r],r<=r0},{cup2 R2Up[r]+cup4 R4Up[r],r>r0}},Indeterminate]]]
];


(* ::Input::Initialization:: *)
\[Chi][l_,m_,r0_]/;EvenQ[l+m]:=Module[{M=1,\[CapitalOmega],\[Omega],\[CapitalPhi],J,Y,R2In,R2Up,R4In,R4Up,cin2,cup2,cin4,cup4},
\[CapitalOmega]=Sqrt[M/r0^3];
\[Omega]=m \[CapitalOmega];
Block[{$rminUp=r0-1,$rmaxIn=r0+1},
R2In=\[Chi]In[l,\[Omega],{0,1}];
R2Up=\[Chi]Up[l,\[Omega],{0,1}];
R4In=\[Chi]In[l,\[Omega],{1,0}];
R4Up=\[Chi]Up[l,\[Omega],{1,0}];
];

\[CapitalPhi]={{-R2In[r0],-R4In[r0],R2Up[r0],R4Up[r0]},
{-R2In'[r0],-R4In'[r0],R2Up'[r0],R4Up'[r0]},
{-R2In''[r0],-R4In''[r0],R2Up''[r0],R4Up''[r0]},
{-R2In'''[r0],-R4In'''[r0],R2Up'''[r0],R4Up'''[r0]}};
Y=SphericalHarmonicY[l,m,\[Pi]/2,0];
J={0,0,0,-((16 \[Pi] Sqrt[r0 (-3 M+r0)] Conjugate[Y])/(-2 M+r0)^2)};
{cin2,cin4,cup2,cup4}=LinearSolve[\[CapitalPhi],J];
Function[{r},Evaluate[Piecewise[{{cin2 R2In[r]+cin4 R4In[r],r<=r0},{cup2 R2Up[r]+cup4 R4Up[r],r>r0}},Indeterminate]]]
];


(* ::Input::Initialization:: *)
\[Chi]1[l_,m_,r0_]/;EvenQ[l+m]:=Module[{M=1,\[CapitalOmega],\[Omega],\[CapitalPhi],J,Y,R2In,R2Up,R4In,R4Up,R6In,R6Up,cin2,cup2,cin4,cup4,cin6,cup6},
\[CapitalOmega]=Sqrt[M/r0^3];
\[Omega]=m \[CapitalOmega];
Block[{$rminUp=r0-1,$rmaxIn=r0+1},
R2In=\[Chi]1In[l,\[Omega],{1,0,0}];
R2Up=\[Chi]1Up[l,\[Omega],{1,0,0}];
R4In=\[Chi]1In[l,\[Omega],{0,1,0}];
R4Up=\[Chi]1Up[l,\[Omega],{0,1,0}];
R6In=\[Chi]1In[l,\[Omega],{0,0,1}];
R6Up=\[Chi]1Up[l,\[Omega],{0,0,1}];
];

\[CapitalPhi]={{-R2In[r0],-R4In[r0],-R6In[r0],R2Up[r0],R4Up[r0],R6Up[r0]},
{-R2In'[r0],-R4In'[r0],-R6In'[r0],R2Up'[r0],R4Up'[r0],R6Up'[r0]},
{-R2In''[r0],-R4In''[r0],-R6In''[r0],R2Up''[r0],R4Up''[r0],R6Up''[r0]},
{-R2In'''[r0],-R4In'''[r0],-R6In'''[r0],R2Up'''[r0],R4Up'''[r0],R6Up'''[r0]},
{-R2In''''[r0],-R4In''''[r0],-R6In''''[r0],R2Up''''[r0],R4Up''''[r0],R6Up''''[r0]},
{-R2In'''''[r0],-R4In'''''[r0],-R6In'''''[r0],R2Up'''''[r0],R4Up'''''[r0],R6Up'''''[r0]}};
Y=SphericalHarmonicY[l,m,\[Pi]/2,0];
J={0,0,(16 \[Pi] Sqrt[r0 (-3 M+r0)] Conjugate[Y])/(-2 M+r0)^2,-((8 \[Pi] (42 M^2-21 M r0+2 r0^2) Conjugate[Y])/((2 M-r0)^3 Sqrt[r0 (-3 M+r0)])),(32 \[Pi] (-24 M^3+(-2+6 l+6 l^2+3 m^2) M^2 r0-(-4+5 l+5 l^2+m^2) M r0^2+l (1+l) r0^3) Conjugate[Y])/(r0 Sqrt[r0 (-3 M+r0)] (-2 M+r0)^4),(16 \[Pi] (-72 M^4+4 (-23+21 l+21 l^2+33 m^2) M^3 r0-4 (16+9 l+9 l^2+15 m^2) M^2 r0^2-5 (-8+3 l+3 l^2-m^2) M r0^3+6 l (1+l) r0^4) Conjugate[Y])/((2 M-r0)^5 r0^2 Sqrt[r0 (-3 M+r0)])};
{cin2,cin4,cin6,cup2,cup4,cup6}=LinearSolve[\[CapitalPhi],J];
Function[{r},Evaluate[Piecewise[{{cin2 R2In[r]+cin4 R4In[r]+cin6 R6In[r],r<=r0},{cup2 R2Up[r]+cup4 R4Up[r]+cup6 R6Up[r],r>r0}},Indeterminate]]]
];


(* ::Input::Initialization:: *)
\[Chi]2[l_,m_,r0_]/;EvenQ[l+m]:=Module[{M=1,\[CapitalOmega],\[Omega],\[CapitalPhi],J,Y,R2In,R2Up,R4In,R4Up,R6In,R6Up,cin2,cup2,cin4,cup4,cin6,cup6},
\[CapitalOmega]=Sqrt[M/r0^3];
\[Omega]=m \[CapitalOmega];
Block[{$rminUp=r0-1,$rmaxIn=r0+1},
R2In=\[Chi]2In[l,\[Omega],{0,0,1}];
R2Up=\[Chi]2Up[l,\[Omega],{0,0,1}];
R4In=\[Chi]2In[l,\[Omega],{0,1,0}];
R4Up=\[Chi]2Up[l,\[Omega],{0,1,0}];
R6In=\[Chi]2In[l,\[Omega],{1,0,0}];
R6Up=\[Chi]2Up[l,\[Omega],{1,0,0}];
];

\[CapitalPhi]={{-R2In[r0],-R4In[r0],-R6In[r0],R2Up[r0],R4Up[r0],R6Up[r0]},
{-R2In'[r0],-R4In'[r0],-R6In'[r0],R2Up'[r0],R4Up'[r0],R6Up'[r0]},
{-R2In''[r0],-R4In''[r0],-R6In''[r0],R2Up''[r0],R4Up''[r0],R6Up''[r0]},
{-R2In'''[r0],-R4In'''[r0],-R6In'''[r0],R2Up'''[r0],R4Up'''[r0],R6Up'''[r0]},
{-R2In''''[r0],-R4In''''[r0],-R6In''''[r0],R2Up''''[r0],R4Up''''[r0],R6Up''''[r0]},
{-R2In'''''[r0],-R4In'''''[r0],-R6In'''''[r0],R2Up'''''[r0],R4Up'''''[r0],R6Up'''''[r0]}};
Y=SphericalHarmonicY[l,m,\[Pi]/2,0];
J={0,0,0,0,0,-((48 m^2 M \[Pi] Sqrt[-3 M+r0] Conjugate[Y])/(r0^(3/2) (-2 M+r0)^4))};
{cin2,cin4,cin6,cup2,cup4,cup6}=LinearSolve[\[CapitalPhi],J];
Function[{r},Evaluate[Piecewise[{{cin2 R2In[r]+cin4 R4In[r]+cin6 R6In[r],r<=r0},{cup2 R2Up[r]+cup4 R4Up[r]+cup6 R6Up[r],r>r0}},Indeterminate]]]
];


(* ::Input::Initialization:: *)
\[Kappa][l_,m_,r0_]:=Function[{r},Evaluate[\[Chi]1[l,m,r0][r]+\[Chi]2[l,m,r0][r]]];


(* ::Input::Initialization:: *)
h[l_,m_,r0_]/;OddQ[l+m]:=Module[{M=1,\[Lambda]=1/2 (l-1)(l+2),\[Omega],\[Omega]p,\[CapitalOmega],\[CapitalOmega]p,\[Psi]1,\[Psi]2,\[Phi]1,\[Phi]2,h0,h1,h2,dr0h0,dr0h1,dr0h2},
\[CapitalOmega]=Sqrt[M/r0^3];
\[CapitalOmega]p=-3/2 Sqrt[M/r0^5];
\[Omega]=m \[CapitalOmega];
\[Omega]p=m \[CapitalOmega]p;
\[Psi]1=\[Psi][1,l,m,r0];
\[Psi]2=\[Psi][2,l,m,r0];
\[Phi]1=\[Phi][1,l,m,r0];
\[Phi]2=\[Phi][2,l,m,r0];

h0=Function[{r},Evaluate[1/(I \[Omega]) (\[Psi]1[r]+2/3 \[Lambda] \[Psi]2[r])]];

h1=Function[{r},Evaluate[1/(I \[Omega])^2 (-((2\[Lambda])/3)\[Psi]2'[r]+2/r \[Psi]1[r] -(2\[Lambda])/(3r) \[Psi]2[r]-\[Psi]1'[r])]];

h2=Function[{r},Evaluate[1/(I \[Omega])^2 (r(1-2M/r)\[Psi]2'[r]+\[Psi]1[r]+((3+2\[Lambda])r-6M)/(3r) \[Psi]2[r])]];
dr0h0=Function[{r},Evaluate[1/(I \[Omega]) (\[Phi]1[r]+2/3 \[Lambda] \[Phi]2[r])-h0[r]/\[Omega] \[Omega]p]];

dr0h1=Function[{r},Evaluate[1/(I \[Omega])^2 (-((2\[Lambda])/3)\[Phi]2'[r]+2/r \[Phi]1[r] -(2\[Lambda])/(3r) \[Phi]2[r]-\[Phi]1'[r])-2 h1[r]/\[Omega] \[Omega]p]];

dr0h2=Function[{r},Evaluate[1/(I \[Omega])^2 (r(1-2M/r)\[Phi]2'[r]+\[Phi]1[r]+((3+2\[Lambda])r-6M)/(3r) \[Phi]2[r])-2 h2[r]/\[Omega] \[Omega]p]];
<|"\!\(\*SubscriptBox[\(h\), \(0\)]\)"->h0,"\!\(\*SubscriptBox[\(h\), \(1\)]\)"->h1,"\!\(\*SubscriptBox[\(h\), \(2\)]\)"->h2,"\!\(\*SubscriptBox[\(h\), \(0, r0\)]\)"->dr0h0,"\!\(\*SubscriptBox[\(h\), \(1, r0\)]\)"->dr0h1,"\!\(\*SubscriptBox[\(h\), \(2, r0\)]\)"->dr0h2|>
];


(* ::Input::Initialization:: *)
h[l_,m_,r0_]/;EvenQ[l+m]:=Module[{M=1,\[Lambda]=1/2 (l-1)(l+2),\[Omega],\[Omega]p,\[CapitalOmega],\[CapitalOmega]p,\[Psi]z,\[Psi]1,\[Psi]0,\[Psi]0b,\[CapitalChi],\[Phi]z,\[Phi]1,\[Phi]0,\[Phi]0b,\[CapitalKappa],h0,h1,H0,H1,H2,G,k,dr0h0,dr0h1,dr0H0,dr0H1,dr0H2,dr0G,dr0k},
\[CapitalOmega]=Sqrt[M/r0^3];
\[CapitalOmega]p=-3/2 Sqrt[M/r0^5];
\[Omega]=m \[CapitalOmega];
\[Omega]p=m \[CapitalOmega]p;
\[Psi]z=\[Psi]Z[l,m,r0];
\[Psi]1=\[Psi][1,l,m,r0];
\[Psi]0=\[Psi][0,l,m,r0];
\[Psi]0b=\[Psi]b[0,l,m,r0];
\[CapitalChi]=\[Chi][l,m,r0];

\[Phi]z=\[Phi]Z[l,m,r0];
\[Phi]1=\[Phi][1,l,m,r0];
\[Phi]0=\[Phi][0,l,m,r0];
\[Phi]0b=\[Phi]b[0,l,m,r0];
\[CapitalKappa]=\[Kappa][l,m,r0];

H0=Function[{r},Evaluate[-((\[Lambda] (1+\[Lambda]) M (-3 M+(3+\[Lambda]) r) \[Psi]z'[r])/(3 (I \[Omega])^2 r^3 (3 M+\[Lambda] r)))+((-M+r) \[Psi]0[r])/((2 M-r) r)+(2 (-2 M^2+M r+(I \[Omega])^2 r^4) (\[Psi]0b[r]+\[CapitalChi][r]))/((2 M-r) r^4)+(4 I \[Omega] (1+\[Lambda]) \[Psi]1[r])/(2 M-r)-(\[Lambda] (1+\[Lambda]) (18 M^4+3 (-3+4 \[Lambda]) M^3 r+(I \[Omega])^2 \[Lambda]^2 r^6-3 \[Lambda] M r^3 (1+\[Lambda]-2 (I \[Omega])^2 r^2)+M^2 (6 \[Lambda]^2 r^2+9 (I \[Omega])^2 r^4)) \[Psi]z[r])/(3 (I \[Omega])^2 (2 M-r) r^4 (3 M+\[Lambda] r)^2)+\[Psi]0'[r]+(2 M (\[Psi]0b'[r]+\[CapitalChi]'[r]))/r^3+(4 (1+\[Lambda]) M \[Psi]1'[r])/(I \[Omega] r^3)]];
H1=Function[{r},Evaluate[-((\[Lambda] (1+\[Lambda])\[Psi]z'[r] )/(3 I \[Omega] r))-((6 M+4 \[Lambda] M-3 r-2 \[Lambda] r-2 (I \[Omega])^2 r^3) \[Psi]0[r])/(4 I \[Omega] M r^2-2 I \[Omega] r^3)+((2+2 \[Lambda]) \[Psi]1[r])/(2 M r-r^2)+(2 I \[Omega] (-M+r) (\[Psi]0b[r]+\[CapitalChi][r]))/((2 M-r) r^2)-(\[Lambda] (1+\[Lambda]) (3 M^2+3 \[Lambda] M r-\[Lambda] r^2) \[Psi]z[r])/(3 I \[Omega] (2 M-r) r^2 (3 M+\[Lambda] r))+(\[Psi]0'[r])/(2 I \[Omega] r)+(2 I \[Omega] (\[Psi]0b'[r]+\[CapitalChi]'[r]))/r+(4 (1+\[Lambda]) \[Psi]1'[r])/r]];
H2=Function[{r},Evaluate[(\[Lambda] (1+\[Lambda]) (-9 M^2+(3-5 \[Lambda]) M r+2 \[Lambda] r^2)\[Psi]z'[r] )/(3 (I \[Omega])^2 r^3 (3 M+\[Lambda] r))+((-3 M+2 r)\[Psi]0[r])/((2 M-r) r)+(2 (6 M^2-(11+4 \[Lambda]) M r+r^2 (4+2 \[Lambda]+(I \[Omega])^2 r^2)) (\[Psi]0b[r]+\[CapitalChi][r]))/((2 M-r) r^4)+(4 (1+\[Lambda]) (-4 (1+\[Lambda]) M+r (2+2 \[Lambda]+(I \[Omega])^2 r^2)) \[Psi]1[r])/(I \[Omega] (2 M-r) r^3)-(\[Lambda] (\[Lambda]+1) (-54 M^4+3 (9-16 \[Lambda]) M^3 r+\[Lambda]^2 r^4 (2+2 \[Lambda]+(I \[Omega])^2 r^2)+9 M^2 r^2 (2 \[Lambda]-2 \[Lambda]^2+(I \[Omega])^2 r^2)+\[Lambda] M r^3 (3+5 \[Lambda]-4 \[Lambda]^2+6 (I \[Omega])^2 r^2)) \[Psi]z[r])/(3 (I \[Omega])^2 (2 M-r) r^4 (3 M+\[Lambda] r)^2)+\[Psi]0'[r]+((-6 M+4 r) (\[Psi]0b'[r]+\[CapitalChi]'[r]))/r^3-(4 (1+\[Lambda]) (M-r) \[Psi]1'[r])/(I \[Omega] r^3)]];
h0=Function[{r},Evaluate[(\[Lambda] (2 M-r)\[Psi]z'[r])/(3 I \[Omega] r)+((-2 M+r)\[Psi]0[r])/(2 I \[Omega] r^2)+(2 I \[Omega] (\[Psi]0b[r]+\[CapitalChi][r]))/r+(4 (1+\[Lambda])\[Psi]1[r])/r-(\[Lambda] (6 M^2+3 \[Lambda] M r+\[Lambda] (1+\[Lambda]) r^2) \[Psi]z[r])/(3 I \[Omega] r^2 (3 M+\[Lambda] r))-((-2 M+r)\[Psi]0'[r])/(2 I \[Omega] r)+(1-(2 M)/r) \[Psi]1'[r]]];
h1=Function[{r},Evaluate[(\[Lambda] ((3+\[Lambda]) M+\[Lambda] (2+\[Lambda]) r) \[Psi]z'[r])/(3 (I \[Omega])^2 r (3 M+\[Lambda] r))-(r \[Psi]0[r])/(4 M-2 r)+(4 (\[Psi]0b[r]+\[CapitalChi][r]))/r^2+((8 M+8 \[Lambda] M-4 r-4 \[Lambda] r+(I \[Omega])^2 r^3) \[Psi]1[r])/(2 I \[Omega] M r^2-I \[Omega] r^3)-(\[Lambda] (9 (I \[Omega])^2 M^2 r^3+2 \[Lambda]^3 r^2 (-2 M+r)+\[Lambda]^2 r (-12 M^2+2 M r+2 r^2+(I \[Omega])^2 r^4)+3 \[Lambda] M (-4 M^2+r^2+2 (I \[Omega])^2 r^4)) \[Psi]z[r])/(3 (I \[Omega])^2 (2 M-r) r^2 (3 M+\[Lambda] r)^2)-(2 (\[Psi]0b'[r]+\[CapitalChi]'[r]))/r-(2 (2 M+r+2 \[Lambda] r) \[Psi]1'[r])/(I \[Omega] r^2)]];
G=Function[{r},Evaluate[-((\[Lambda] (3+2 \[Lambda]) (2 M-r) \[Psi]z'[r])/(6 (I \[Omega])^2 r^2 (3 M+\[Lambda] r)))-(\[Psi]0b[r]+\[CapitalChi][r])/r^3-(2 (1+\[Lambda]) \[Psi]1[r])/(I \[Omega] r^3)+((4 \[Lambda]^3 r^2+\[Lambda]^4 r^2+27 (I \[Omega])^2 M^2 r^2+9 \[Lambda] M (M+2 (I \[Omega])^2 r^3)+3 \[Lambda]^2 (M^2+M r+r^2+(I \[Omega])^2 r^4)) \[Psi]z[r])/(6 (I \[Omega])^2 r^3 (3 M+\[Lambda] r)^2)+((2 M-r) \[Psi]1'[r])/(I \[Omega] r^3)]];
k=Function[{r},Evaluate[(\[Lambda] (1+\[Lambda]) (2 M-r) \[Psi]z'[r])/(3 (I \[Omega])^2 r^3)+\[Psi]0[r]/r+((-4 M+2 (2+\[Lambda]) r) (\[Psi]0b[r]+\[CapitalChi][r]))/r^4+(4 (1+\[Lambda])^2 \[Psi]1[r])/(I \[Omega] r^3)-(\[Lambda] (1+\[Lambda]) (6 M^2+3 \[Lambda] M r+\[Lambda] (1+\[Lambda]) r^2) \[Psi]z[r])/(3 (I \[Omega])^2 r^4 (3 M+\[Lambda] r))+((4 M-2 r) (\[Psi]0b'[r]+\[CapitalChi]'[r]))/r^3+(2 (1+\[Lambda]) (2 M-r) \[Psi]1'[r])/(I \[Omega] r^3)]];

dr0H0=Function[{r},Evaluate[-((\[Lambda] (1+\[Lambda]) M (-3 M+(3+\[Lambda]) r) \[Phi]z'[r])/(3 (I \[Omega])^2 r^3 (3 M+\[Lambda] r)))+((-M+r) \[Phi]0[r])/((2 M-r) r)+(2 (-2 M^2+M r+(I \[Omega])^2 r^4) (\[Phi]0b[r]+\[CapitalKappa][r]))/((2 M-r) r^4)+(4 I \[Omega] (1+\[Lambda]) \[Phi]1[r])/(2 M-r)-(\[Lambda] (1+\[Lambda]) (18 M^4+3 (-3+4 \[Lambda]) M^3 r+(I \[Omega])^2 \[Lambda]^2 r^6-3 \[Lambda] M r^3 (1+\[Lambda]-2 (I \[Omega])^2 r^2)+M^2 (6 \[Lambda]^2 r^2+9 (I \[Omega])^2 r^4)) \[Phi]z[r])/(3 (I \[Omega])^2 (2 M-r) r^4 (3 M+\[Lambda] r)^2)+\[Phi]0'[r]+(2 M (\[Phi]0b'[r]+\[CapitalKappa]'[r]))/r^3+(4 (1+\[Lambda]) M \[Phi]1'[r])/(I \[Omega] r^3)+\[Omega]p(-((4 \[Omega] (\[CapitalChi][r]+\[Psi]0b[r]))/(2 M-r))+(4 I (1+\[Lambda]) \[Psi]1[r])/(2 M-r)+(\[Lambda] (1+\[Lambda]) (-18 M^2 r^4 \[Omega]-12 M r^5 \[Lambda] \[Omega]-2 r^6 \[Lambda]^2 \[Omega]) \[Psi]z[r])/(3 (2 M-r) r^4 (3 M+r \[Lambda])^2 \[Omega]^2)-(2 \[Lambda] (1+\[Lambda]) (18 M^4+3 M^3 r (-3+4 \[Lambda])-r^6 \[Lambda]^2 \[Omega]^2-3 M r^3 \[Lambda] (1+\[Lambda]+2 r^2 \[Omega]^2)+M^2 (6 r^2 \[Lambda]^2-9 r^4 \[Omega]^2)) \[Psi]z[r])/(3 (2 M-r) r^4 (3 M+r \[Lambda])^2 \[Omega]^3)+(4 I M (1+\[Lambda]) Derivative[1][\[Psi]1][r])/(r^3 \[Omega]^2)-(2 M \[Lambda] (1+\[Lambda]) (-3 M+r (3+\[Lambda])) Derivative[1][\[Psi]z][r])/(3 r^3 (3 M+r \[Lambda]) \[Omega]^3))]];
dr0H1=Function[{r},Evaluate[-((\[Lambda] (1+\[Lambda])\[Phi]z'[r] )/(3 I \[Omega] r))-((6 M+4 \[Lambda] M-3 r-2 \[Lambda] r-2 (I \[Omega])^2 r^3) \[Phi]0[r])/(4 I \[Omega] M r^2-2 I \[Omega] r^3)+((2+2 \[Lambda]) \[Phi]1[r])/(2 M r-r^2)+(2 I \[Omega] (-M+r) (\[Phi]0b[r]+\[CapitalKappa][r]))/((2 M-r) r^2)-(\[Lambda] (1+\[Lambda]) (3 M^2+3 \[Lambda] M r-\[Lambda] r^2) \[Phi]z[r])/(3 I \[Omega] (2 M-r) r^2 (3 M+\[Lambda] r))+(\[Phi]0'[r])/(2 I \[Omega] r)+(2 I \[Omega] (\[Phi]0b'[r]+\[CapitalKappa]'[r]))/r+(4 (1+\[Lambda]) \[Phi]1'[r])/r+\[Omega]p(-((4 r^3 \[Omega] \[Psi]0[r])/(4 I M r^2 \[Omega]-2 I r^3 \[Omega]))+((4 I M r^2-2 I r^3) (6 M-3 r+4 M \[Lambda]-2 r \[Lambda]+2 r^3 \[Omega]^2) \[Psi]0[r])/(4 I M r^2 \[Omega]-2 I r^3 \[Omega])^2+(2 I (-M+r) (\[CapitalChi][r]+\[Psi]0b[r]))/((2 M-r) r^2)-(I \[Lambda] (1+\[Lambda]) (3 M^2+3 M r \[Lambda]-r^2 \[Lambda]) \[Psi]z[r])/(3 (2 M-r) r^2 (3 M+r \[Lambda]) \[Omega]^2)+(I Derivative[1][\[Psi]0][r])/(2 r \[Omega]^2)+(2 I (Derivative[1][\[CapitalChi]][r]+Derivative[1][\[Psi]0b][r]))/r-(I \[Lambda] (1+\[Lambda]) Derivative[1][\[Psi]z][r])/(3 r \[Omega]^2))]];
dr0H2=Function[{r},Evaluate[(\[Lambda] (1+\[Lambda]) (-9 M^2+(3-5 \[Lambda]) M r+2 \[Lambda] r^2)\[Phi]z'[r] )/(3 (I \[Omega])^2 r^3 (3 M+\[Lambda] r))+((-3 M+2 r)\[Phi]0[r])/((2 M-r) r)+(2 (6 M^2-(11+4 \[Lambda]) M r+r^2 (4+2 \[Lambda]+(I \[Omega])^2 r^2)) (\[Phi]0b[r]+\[CapitalKappa][r]))/((2 M-r) r^4)+(4 (1+\[Lambda]) (-4 (1+\[Lambda]) M+r (2+2 \[Lambda]+(I \[Omega])^2 r^2)) \[Phi]1[r])/(I \[Omega] (2 M-r) r^3)-(\[Lambda] (\[Lambda]+1) (-54 M^4+3 (9-16 \[Lambda]) M^3 r+\[Lambda]^2 r^4 (2+2 \[Lambda]+(I \[Omega])^2 r^2)+9 M^2 r^2 (2 \[Lambda]-2 \[Lambda]^2+(I \[Omega])^2 r^2)+\[Lambda] M r^3 (3+5 \[Lambda]-4 \[Lambda]^2+6 (I \[Omega])^2 r^2)) \[Phi]z[r])/(3 (I \[Omega])^2 (2 M-r) r^4 (3 M+\[Lambda] r)^2)+\[Phi]0'[r]+((-6 M+4 r) (\[Phi]0b'[r]+\[CapitalKappa]'[r]))/r^3-(4 (1+\[Lambda]) (M-r) \[Phi]1'[r])/(I \[Omega] r^3)+\[Omega]p(-((4 \[Omega] (\[CapitalChi][r]+\[Psi]0b[r]))/(2 M-r))+(8 I (1+\[Lambda]) \[Psi]1[r])/(2 M-r)+(4 I (1+\[Lambda]) (-4 M (1+\[Lambda])+r (2+2 \[Lambda]-r^2 \[Omega]^2)) \[Psi]1[r])/((2 M-r) r^3 \[Omega]^2)+(\[Lambda] (1+\[Lambda]) (-18 M^2 r^4 \[Omega]-12 M r^5 \[Lambda] \[Omega]-2 r^6 \[Lambda]^2 \[Omega]) \[Psi]z[r])/(3 (2 M-r) r^4 (3 M+r \[Lambda])^2 \[Omega]^2)-(2 \[Lambda] (1+\[Lambda]) (-54 M^4+3 M^3 r (9-16 \[Lambda])+M r^3 \[Lambda] (3+5 \[Lambda]-4 \[Lambda]^2-6 r^2 \[Omega]^2)+r^4 \[Lambda]^2 (2+2 \[Lambda]-r^2 \[Omega]^2)+9 M^2 r^2 (2 \[Lambda]-2 \[Lambda]^2-r^2 \[Omega]^2)) \[Psi]z[r])/(3 (2 M-r) r^4 (3 M+r \[Lambda])^2 \[Omega]^3)-(4 I (M-r) (1+\[Lambda]) Derivative[1][\[Psi]1][r])/(r^3 \[Omega]^2)+(2 \[Lambda] (1+\[Lambda]) (-9 M^2+M r (3-5 \[Lambda])+2 r^2 \[Lambda]) Derivative[1][\[Psi]z][r])/(3 r^3 (3 M+r \[Lambda]) \[Omega]^3))]];
dr0h0=Function[{r},Evaluate[(\[Lambda] (2 M-r)\[Phi]z'[r])/(3 I \[Omega] r)+((-2 M+r)\[Phi]0[r])/(2 I \[Omega] r^2)+(2 I \[Omega] (\[Phi]0b[r]+\[CapitalKappa][r]))/r+(4 (1+\[Lambda])\[Phi]1[r])/r-(\[Lambda] (6 M^2+3 \[Lambda] M r+\[Lambda] (1+\[Lambda]) r^2) \[Phi]z[r])/(3 I \[Omega] r^2 (3 M+\[Lambda] r))-((-2 M+r)\[Phi]0'[r])/(2 I \[Omega] r)+(1-(2 M)/r) \[Phi]1'[r]+\[Omega]p((I (-2 M+r) \[Psi]0[r])/(2 r^2 \[Omega]^2)+(2 I (\[CapitalChi][r]+\[Psi]0b[r]))/r-(I \[Lambda] (6 M^2+3 M r \[Lambda]+r^2 \[Lambda] (1+\[Lambda])) \[Psi]z[r])/(3 r^2 (3 M+r \[Lambda]) \[Omega]^2)-(I (-2 M+r) Derivative[1][\[Psi]0][r])/(2 r \[Omega]^2)+(I (2 M-r) \[Lambda] Derivative[1][\[Psi]z][r])/(3 r \[Omega]^2))]];
dr0h1=Function[{r},Evaluate[(\[Lambda] ((3+\[Lambda]) M+\[Lambda] (2+\[Lambda]) r) \[Phi]z'[r])/(3 (I \[Omega])^2 r (3 M+\[Lambda] r))-(r \[Phi]0[r])/(4 M-2 r)+(4 (\[Phi]0b[r]+\[CapitalKappa][r]))/r^2+((8 M+8 \[Lambda] M-4 r-4 \[Lambda] r+(I \[Omega])^2 r^3) \[Phi]1[r])/(2 I \[Omega] M r^2-I \[Omega] r^3)-(\[Lambda] (9 (I \[Omega])^2 M^2 r^3+2 \[Lambda]^3 r^2 (-2 M+r)+\[Lambda]^2 r (-12 M^2+2 M r+2 r^2+(I \[Omega])^2 r^4)+3 \[Lambda] M (-4 M^2+r^2+2 (I \[Omega])^2 r^4)) \[Phi]z[r])/(3 (I \[Omega])^2 (2 M-r) r^2 (3 M+\[Lambda] r)^2)-(2 (\[Phi]0b'[r]+\[CapitalKappa]'[r]))/r-(2 (2 M+r+2 \[Lambda] r) \[Phi]1'[r])/(I \[Omega] r^2)+\[Omega]p(-((2 r^3 \[Omega] \[Psi]1[r])/(2 I M r^2 \[Omega]-I r^3 \[Omega]))-((2 I M r^2-I r^3) (8 M-4 r+8 M \[Lambda]-4 r \[Lambda]-r^3 \[Omega]^2) \[Psi]1[r])/(2 I M r^2 \[Omega]-I r^3 \[Omega])^2+(\[Lambda] (-18 M^2 r^3 \[Omega]-12 M r^4 \[Lambda] \[Omega]-2 r^5 \[Lambda]^2 \[Omega]) \[Psi]z[r])/(3 (2 M-r) r^2 (3 M+r \[Lambda])^2 \[Omega]^2)-(2 \[Lambda] (2 r^2 (-2 M+r) \[Lambda]^3-9 M^2 r^3 \[Omega]^2+3 M \[Lambda] (-4 M^2+r^2-2 r^4 \[Omega]^2)+r \[Lambda]^2 (-12 M^2+2 M r+2 r^2-r^4 \[Omega]^2)) \[Psi]z[r])/(3 (2 M-r) r^2 (3 M+r \[Lambda])^2 \[Omega]^3)-(2 I (2 M+r+2 r \[Lambda]) Derivative[1][\[Psi]1][r])/(r^2 \[Omega]^2)+(2 \[Lambda] (r \[Lambda] (2+\[Lambda])+M (3+\[Lambda])) Derivative[1][\[Psi]z][r])/(3 r (3 M+r \[Lambda]) \[Omega]^3))]];
dr0G=Function[{r},Evaluate[-((\[Lambda] (3+2 \[Lambda]) (2 M-r) \[Phi]z'[r])/(6 (I \[Omega])^2 r^2 (3 M+\[Lambda] r)))-(\[Phi]0b[r]+\[CapitalKappa][r])/r^3-(2 (1+\[Lambda]) \[Phi]1[r])/(I \[Omega] r^3)+((4 \[Lambda]^3 r^2+\[Lambda]^4 r^2+27 (I \[Omega])^2 M^2 r^2+9 \[Lambda] M (M+2 (I \[Omega])^2 r^3)+3 \[Lambda]^2 (M^2+M r+r^2+(I \[Omega])^2 r^4)) \[Phi]z[r])/(6 (I \[Omega])^2 r^3 (3 M+\[Lambda] r)^2)+((2 M-r) \[Phi]1'[r])/(I \[Omega] r^3)+\[Omega]p(-((2 I (1+\[Lambda]) \[Psi]1[r])/(r^3 \[Omega]^2))-((-54 M^2 r^2 \[Omega]-36 M r^3 \[Lambda] \[Omega]-6 r^4 \[Lambda]^2 \[Omega]) \[Psi]z[r])/(6 r^3 (3 M+r \[Lambda])^2 \[Omega]^2)+((4 r^2 \[Lambda]^3+r^2 \[Lambda]^4-27 M^2 r^2 \[Omega]^2+9 M \[Lambda] (M-2 r^3 \[Omega]^2)+3 \[Lambda]^2 (M^2+M r+r^2-r^4 \[Omega]^2)) \[Psi]z[r])/(3 r^3 (3 M+r \[Lambda])^2 \[Omega]^3)+(I (2 M-r) Derivative[1][\[Psi]1][r])/(r^3 \[Omega]^2)-((2 M-r) \[Lambda] (3+2 \[Lambda]) Derivative[1][\[Psi]z][r])/(3 r^2 (3 M+r \[Lambda]) \[Omega]^3))]];
dr0k=Function[{r},Evaluate[(\[Lambda] (1+\[Lambda]) (2 M-r) \[Phi]z'[r])/(3 (I \[Omega])^2 r^3)+\[Phi]0[r]/r+((-4 M+2 (2+\[Lambda]) r) (\[Phi]0b[r]+\[CapitalKappa][r]))/r^4+(4 (1+\[Lambda])^2 \[Phi]1[r])/(I \[Omega] r^3)-(\[Lambda] (1+\[Lambda]) (6 M^2+3 \[Lambda] M r+\[Lambda] (1+\[Lambda]) r^2) \[Phi]z[r])/(3 (I \[Omega])^2 r^4 (3 M+\[Lambda] r))+((4 M-2 r) (\[Phi]0b'[r]+\[CapitalKappa]'[r]))/r^3+(2 (1+\[Lambda]) (2 M-r) \[Phi]1'[r])/(I \[Omega] r^3)+\[Omega]p((4 I (1+\[Lambda])^2 \[Psi]1[r])/(r^3 \[Omega]^2)-(2 \[Lambda] (1+\[Lambda]) (6 M^2+3 M r \[Lambda]+r^2 \[Lambda] (1+\[Lambda])) \[Psi]z[r])/(3 r^4 (3 M+r \[Lambda]) \[Omega]^3)+(2 I (2 M-r) (1+\[Lambda]) Derivative[1][\[Psi]1][r])/(r^3 \[Omega]^2)+(2 (2 M-r) \[Lambda] (1+\[Lambda]) Derivative[1][\[Psi]z][r])/(3 r^3 \[Omega]^3))]];
<|"\!\(\*SubscriptBox[\(H\), \(0\)]\)"->H0,"\!\(\*SubscriptBox[\(H\), \(1\)]\)"->H1,"\!\(\*SubscriptBox[\(H\), \(2\)]\)"->H2,"\!\(\*SubscriptBox[\(h\), \(0\)]\)"->h0,"\!\(\*SubscriptBox[\(h\), \(1\)]\)"->h1,"G"->G,"K"->k,"\!\(\*SubscriptBox[\(H\), \(0, r0\)]\)"->dr0H0,"\!\(\*SubscriptBox[\(H\), \(1, r0\)]\)"->dr0H1,"\!\(\*SubscriptBox[\(H\), \(2, r0\)]\)"->dr0H2,"\!\(\*SubscriptBox[\(h\), \(0, r0\)]\)"->dr0h0,"\!\(\*SubscriptBox[\(h\), \(1, r0\)]\)"->dr0h1,"\!\(\*SubscriptBox[\(G\), \(\(,\)\(r0\)\)]\)"->dr0G,"\!\(\*SubscriptBox[\(K\), \(\(,\)\(r0\)\)]\)"->dr0k|>
];


(* ::Input::Initialization:: *)
hbar[l_,m_,r0_]:= Module[{M=1,hB,hbar1,hbar2,hbar3,hbar4,hbar5,hbar6,hbar7,hbar8,hbar9,hbar10,dr0hbar1,dr0hbar2,dr0hbar3,dr0hbar4,dr0hbar5,dr0hbar6,dr0hbar7,dr0hbar8,dr0hbar9,dr0hbar10,res},
hB=h[l,m,r0];

If[EvenQ[l+m],
hbar1=Function[{r},Evaluate[r (1-2M/r)(hB["\!\(\*SubscriptBox[\(H\), \(0\)]\)"][r]+hB["\!\(\*SubscriptBox[\(H\), \(2\)]\)"][r])]];
hbar2=Function[{r},Evaluate[2 r (1-2M/r) hB["\!\(\*SubscriptBox[\(H\), \(1\)]\)"][r]]];
hbar3=Function[{r},Evaluate[2 r hB["K"][r]]];
hbar4=Function[{r},Evaluate[2 l(1+l) hB["\!\(\*SubscriptBox[\(h\), \(0\)]\)"][r]]];
hbar5=Function[{r},Evaluate[(2 (1-2 M/r) l(1+l) hB["\!\(\*SubscriptBox[\(h\), \(1\)]\)"][r])]];
hbar6=Function[{r},Evaluate[r ( hB["\!\(\*SubscriptBox[\(H\), \(0\)]\)"][r]-hB["\!\(\*SubscriptBox[\(H\), \(2\)]\)"][r])]];
hbar7=Function[{r},Evaluate[2 r (l-1)l(1+l)(l+2) hB["G"][r]]];
dr0hbar1=Function[{r},Evaluate[r (1-2M/r)(hB["\!\(\*SubscriptBox[\(H\), \(0, r0\)]\)"][r]+hB["\!\(\*SubscriptBox[\(H\), \(2, r0\)]\)"][r])]];
dr0hbar2=Function[{r},Evaluate[2 r (1-2M/r) hB["\!\(\*SubscriptBox[\(H\), \(1, r0\)]\)"][r]]];
dr0hbar3=Function[{r},Evaluate[2 r hB["\!\(\*SubscriptBox[\(K\), \(\(,\)\(r0\)\)]\)"][r]]];
dr0hbar4=Function[{r},Evaluate[2 l(1+l) hB["\!\(\*SubscriptBox[\(h\), \(0, r0\)]\)"][r]]];
dr0hbar5=Function[{r},Evaluate[(2 (1-2 M/r) l(1+l) hB["\!\(\*SubscriptBox[\(h\), \(1, r0\)]\)"][r])]];
dr0hbar6=Function[{r},Evaluate[r ( hB["\!\(\*SubscriptBox[\(H\), \(0, r0\)]\)"][r]-hB["\!\(\*SubscriptBox[\(H\), \(2, r0\)]\)"][r])]];
dr0hbar7=Function[{r},Evaluate[2 r (l-1)l(1+l)(l+2) hB["\!\(\*SubscriptBox[\(G\), \(\(,\)\(r0\)\)]\)"][r]]];
res=<|"\!\(\*OverscriptBox[\(h\), \(_\)]\)"-><|1->hbar1,2->hbar2,3->hbar3,4->hbar4,5->hbar5,6->hbar6,7->hbar7|>,
"\!\(\*SubscriptBox[OverscriptBox[\(h\), \(_\)], \(\(,\)\(r0\)\)]\)"-><|1->dr0hbar1,2->dr0hbar2,3->dr0hbar3,4->dr0hbar4,5->dr0hbar5,6->dr0hbar6,7->dr0hbar7|>|>;
,
hbar8=Function[{r},Evaluate[2 l(1+l) hB["\!\(\*SubscriptBox[\(h\), \(0\)]\)"][r]]];
hbar9=Function[{r},Evaluate[(2 (1-2 M/r) l(1+l) hB["\!\(\*SubscriptBox[\(h\), \(1\)]\)"][r])]];
hbar10=Function[{r},Evaluate[(-(1/r)2 (-1+l) l (1+l) (2+l) hB["\!\(\*SubscriptBox[\(h\), \(2\)]\)"][r])]];
dr0hbar8=Function[{r},Evaluate[2 l(1+l) hB["\!\(\*SubscriptBox[\(h\), \(0, r0\)]\)"][r]]];
dr0hbar9=Function[{r},Evaluate[(2 (1-2 M/r) l(1+l) hB["\!\(\*SubscriptBox[\(h\), \(1, r0\)]\)"][r])]];
dr0hbar10=Function[{r},Evaluate[(-(1/r)2 (-1+l) l (1+l) (2+l) hB["\!\(\*SubscriptBox[\(h\), \(2, r0\)]\)"][r])]];
res=<|"\!\(\*OverscriptBox[\(h\), \(_\)]\)"-><|8->hbar8,9->hbar9,10->hbar10|>,
"\!\(\*SubscriptBox[OverscriptBox[\(h\), \(_\)], \(\(,\)\(r0\)\)]\)"-><|8->dr0hbar8,9->dr0hbar9,10->dr0hbar10|>|>;
];
res
]


(* ::Input::Initialization:: *)
hbar[l_,m_,r0_,rgridL_,rgridR_]/;OddQ[l+m]:=Module[{M=1,\[Lambda]=1/2 (l-1)(l+2),\[Omega],\[Omega]p,\[CapitalOmega],\[CapitalOmega]p,
\[Psi]1,\[Psi]1inhom,\[Psi]1Right,\[Psi]1Left,\[Psi]1GridRight,\[Psi]1GridLeft,d\[Psi]1GridRight,d\[Psi]1GridLeft,dd\[Psi]1GridRight,dd\[Psi]1GridLeft,
\[Psi]2,\[Psi]2inhom,\[Psi]2Right,\[Psi]2Left,\[Psi]2GridRight,\[Psi]2GridLeft,d\[Psi]2GridRight,d\[Psi]2GridLeft,dd\[Psi]2GridRight,dd\[Psi]2GridLeft,
\[Phi]1,\[Phi]1inhom,\[Phi]1Right,\[Phi]1Left,\[Phi]1GridRight,\[Phi]1GridLeft,d\[Phi]1GridRight,d\[Phi]1GridLeft,dd\[Phi]1GridRight,dd\[Phi]1GridLeft,
\[Phi]2,\[Phi]2inhom,\[Phi]2Right,\[Phi]2Left,\[Phi]2GridRight,\[Phi]2GridLeft,d\[Phi]2GridRight,d\[Phi]2GridLeft,dd\[Phi]2GridRight,dd\[Phi]2GridLeft,
r,h0,h1,h2,dr0h0,dr0h1,dr0h2,hbar8,hbar9,hbar10,dr0hbar8,dr0hbar9,dr0hbar10,fields},
\[CapitalOmega]=Sqrt[M/r0^3];
\[CapitalOmega]p=-3/2 Sqrt[M/r0^5];
\[Omega]=m \[CapitalOmega];
\[Omega]p=m \[CapitalOmega]p;

\[Psi]1inhom=\[Psi][1,l,m,r0];
\[Psi]1Right=Function[{r},Evaluate[\[Psi]1inhom[r][[1,2,1]]]];
\[Psi]1Left=Function[{r},Evaluate[\[Psi]1inhom[r][[1,1,1]]]];
\[Psi]1GridRight=\[Psi]1Right/@rgridR;
\[Psi]1GridLeft=\[Psi]1Left/@rgridL;
d\[Psi]1GridRight=\[Psi]1Right'/@rgridR;
d\[Psi]1GridLeft=\[Psi]1Left'/@rgridL;
dd\[Psi]1GridRight=\[Psi]1Right''/@rgridR;
dd\[Psi]1GridLeft=\[Psi]1Left''/@rgridL;

\[Psi]2inhom=\[Psi][2,l,m,r0];
\[Psi]2Right=Function[{r},Evaluate[\[Psi]2inhom[r][[1,2,1]]]];
\[Psi]2Left=Function[{r},Evaluate[\[Psi]2inhom[r][[1,1,1]]]];
\[Psi]2GridRight=\[Psi]2Right/@rgridR;
\[Psi]2GridLeft=\[Psi]2Left/@rgridL;
d\[Psi]2GridRight=\[Psi]2Right'/@rgridR;
d\[Psi]2GridLeft=\[Psi]2Left'/@rgridL;
dd\[Psi]2GridRight=\[Psi]2Right''/@rgridR;
dd\[Psi]2GridLeft=\[Psi]2Left''/@rgridL;

\[Phi]1inhom=\[Phi][1,l,m,r0];
\[Phi]1Right=Function[{r},Evaluate[\[Phi]1inhom[r][[1,2,1]]]];
\[Phi]1Left=Function[{r},Evaluate[\[Phi]1inhom[r][[1,1,1]]]];
\[Phi]1GridRight=\[Phi]1Right/@rgridR;
\[Phi]1GridLeft=\[Phi]1Left/@rgridL;
d\[Phi]1GridRight=\[Phi]1Right'/@rgridR;
d\[Phi]1GridLeft=\[Phi]1Left'/@rgridL;
dd\[Phi]1GridRight=\[Phi]1Right''/@rgridR;
dd\[Phi]1GridLeft=\[Phi]1Left''/@rgridL;

\[Phi]2inhom=\[Phi][2,l,m,r0];
\[Phi]2Right=Function[{r},Evaluate[\[Phi]2inhom[r][[1,2,1]]]];
\[Phi]2Left=Function[{r},Evaluate[\[Phi]2inhom[r][[1,1,1]]]];
\[Phi]2GridRight=\[Phi]2Right/@rgridR;
\[Phi]2GridLeft=\[Phi]2Left/@rgridL;
d\[Phi]2GridRight=\[Phi]2Right'/@rgridR;
d\[Phi]2GridLeft=\[Phi]2Left'/@rgridL;
dd\[Phi]2GridRight=\[Phi]2Right''/@rgridR;
dd\[Phi]2GridLeft=\[Phi]2Left''/@rgridL;

h0=Function[{r},Evaluate[1/(I \[Omega]) (\[Psi]1[r]+2/3 \[Lambda] \[Psi]2[r])]];

h1=Function[{r},Evaluate[1/(I \[Omega])^2 (-((2\[Lambda])/3)\[Psi]2'[r]+2/r \[Psi]1[r] -(2\[Lambda])/(3r) \[Psi]2[r]-\[Psi]1'[r])]];

h2=Function[{r},Evaluate[1/(I \[Omega])^2 (r(1-2M/r)\[Psi]2'[r]+\[Psi]1[r]+((3+2\[Lambda])r-6M)/(3r) \[Psi]2[r])]];
dr0h0=Function[{r},Evaluate[1/(I \[Omega]) (\[Phi]1[r]+2/3 \[Lambda] \[Phi]2[r])-h0[r]/\[Omega] \[Omega]p]];

dr0h1=Function[{r},Evaluate[1/(I \[Omega])^2 (-((2\[Lambda])/3)\[Phi]2'[r]+2/r \[Phi]1[r] -(2\[Lambda])/(3r) \[Phi]2[r]-\[Phi]1'[r])-2 h1[r]/\[Omega] \[Omega]p]];

dr0h2=Function[{r},Evaluate[1/(I \[Omega])^2 (r(1-2M/r)\[Phi]2'[r]+\[Phi]1[r]+((3+2\[Lambda])r-6M)/(3r) \[Phi]2[r])-2 h2[r]/\[Omega] \[Omega]p]];
hbar8=Function[{r},Evaluate[2 l(1+l) h0[r]]];
hbar9=Function[{r},Evaluate[(2 (1-2 M/r) l(1+l) h1[r])]];
hbar10=Function[{r},Evaluate[(-(1/r)2 (-1+l) l (1+l) (2+l) h2[r])]];
dr0hbar8=Function[{r},Evaluate[2 l(1+l) dr0h0[r]]];
dr0hbar9=Function[{r},Evaluate[(2 (1-2 M/r) l(1+l) dr0h1[r])]];
dr0hbar10=Function[{r},Evaluate[(-(1/r)2 (-1+l) l (1+l) (2+l) dr0h2[r])]];
fields=Simplify[{{hbar9[r],hbar9'[r],hbar10[r],hbar10'[r],hbar8[r],hbar8'[r]},
{dr0hbar9[r],dr0hbar9'[r],dr0hbar10[r],dr0hbar10'[r],dr0hbar8[r],dr0hbar8'[r]}}];
{Flatten[Transpose[ReIm[fields/.{\[Psi]1[r]->\[Psi]1GridLeft,\[Psi]1'[r]->d\[Psi]1GridLeft,\[Psi]1''[r]->dd\[Psi]1GridLeft,\[Psi]2[r]->\[Psi]2GridLeft,\[Psi]2'[r]->d\[Psi]2GridLeft,\[Psi]2''[r]->dd\[Psi]2GridLeft,\[Phi]1[r]->\[Phi]1GridLeft,\[Phi]1'[r]->d\[Phi]1GridLeft,\[Phi]1''[r]->dd\[Phi]1GridLeft,\[Phi]2[r]->\[Phi]2GridLeft,\[Phi]2'[r]->d\[Phi]2GridLeft,\[Phi]2''[r]->dd\[Phi]2GridLeft,r->rgridL}],{1,3,2,4}],{{1},{2},{3,4}}],Flatten[Transpose[ReIm[fields/.{\[Psi]1[r]->\[Psi]1GridRight,\[Psi]1'[r]->d\[Psi]1GridRight,\[Psi]1''[r]->dd\[Psi]1GridRight,\[Psi]2[r]->\[Psi]2GridRight,\[Psi]2'[r]->d\[Psi]2GridRight,\[Psi]2''[r]->dd\[Psi]2GridRight,\[Phi]1[r]->\[Phi]1GridRight,\[Phi]1'[r]->d\[Phi]1GridRight,\[Phi]1''[r]->dd\[Phi]1GridRight,\[Phi]2[r]->\[Phi]2GridRight,\[Phi]2'[r]->d\[Phi]2GridRight,\[Phi]2''[r]->dd\[Phi]2GridRight,r->rgridR}],{1,3,2,4}],{{1},{2},{3,4}}]}
]


(* ::Input::Initialization:: *)
hbar[l_,m_,r0_,rgridL_,rgridR_]/;EvenQ[l+m]:=Module[{M=1,\[Lambda]=1/2 (l-1)(l+2),\[Omega],\[Omega]p,\[CapitalOmega],\[CapitalOmega]p,
\[Psi]1,\[Psi]1inhom,\[Psi]1Right,\[Psi]1Left,\[Psi]1GridRight,\[Psi]1GridLeft,d\[Psi]1GridRight,d\[Psi]1GridLeft,dd\[Psi]1GridRight,dd\[Psi]1GridLeft,
\[Psi]z,\[Psi]Zinhom,\[Psi]ZRight,\[Psi]ZLeft,\[Psi]ZGridRight,\[Psi]ZGridLeft,d\[Psi]ZGridRight,d\[Psi]ZGridLeft,dd\[Psi]ZGridRight,dd\[Psi]ZGridLeft,
\[Psi]0,\[Psi]0inhom,\[Psi]0Right,\[Psi]0Left,\[Psi]0GridRight,\[Psi]0GridLeft,d\[Psi]0GridRight,d\[Psi]0GridLeft,dd\[Psi]0GridRight,dd\[Psi]0GridLeft,
\[Psi]0b,\[Psi]0binhom,\[Psi]0bRight,\[Psi]0bLeft,\[Psi]0bGridRight,\[Psi]0bGridLeft,d\[Psi]0bGridRight,d\[Psi]0bGridLeft,dd\[Psi]0bGridRight,dd\[Psi]0bGridLeft,
\[CapitalChi],\[CapitalChi]inhom,\[CapitalChi]Right,\[CapitalChi]Left,\[CapitalChi]GridRight,\[CapitalChi]GridLeft,d\[CapitalChi]GridRight,d\[CapitalChi]GridLeft,dd\[CapitalChi]GridRight,dd\[CapitalChi]GridLeft,
\[Phi]1,\[Phi]1inhom,\[Phi]1Right,\[Phi]1Left,\[Phi]1GridRight,\[Phi]1GridLeft,d\[Phi]1GridRight,d\[Phi]1GridLeft,dd\[Phi]1GridRight,dd\[Phi]1GridLeft,
\[Phi]z,\[Phi]Zinhom,\[Phi]ZRight,\[Phi]ZLeft,\[Phi]ZGridRight,\[Phi]ZGridLeft,d\[Phi]ZGridRight,d\[Phi]ZGridLeft,dd\[Phi]ZGridRight,dd\[Phi]ZGridLeft,
\[Phi]0,\[Phi]0inhom,\[Phi]0Right,\[Phi]0Left,\[Phi]0GridRight,\[Phi]0GridLeft,d\[Phi]0GridRight,d\[Phi]0GridLeft,dd\[Phi]0GridRight,dd\[Phi]0GridLeft,
\[Phi]0b,\[Phi]0binhom,\[Phi]0bRight,\[Phi]0bLeft,\[Phi]0bGridRight,\[Phi]0bGridLeft,d\[Phi]0bGridRight,d\[Phi]0bGridLeft,dd\[Phi]0bGridRight,dd\[Phi]0bGridLeft,
\[CapitalKappa],\[CapitalKappa]inhom,\[CapitalKappa]Right,\[CapitalKappa]Left,\[CapitalKappa]GridRight,\[CapitalKappa]GridLeft,d\[CapitalKappa]GridRight,d\[CapitalKappa]GridLeft,dd\[CapitalKappa]GridRight,dd\[CapitalKappa]GridLeft,
r,
h0,h1,H0,H1,H2,G,k,
dr0h0,dr0h1,dr0H0,dr0H1,dr0H2,dr0G,dr0k,
hbar1,hbar2,hbar3,hbar4,hbar5,hbar6,hbar7,
dr0hbar1,dr0hbar2,dr0hbar3,dr0hbar4,dr0hbar5,dr0hbar6,dr0hbar7,
fields},
\[CapitalOmega]=Sqrt[M/r0^3];
\[CapitalOmega]p=-3/2 Sqrt[M/r0^5];
\[Omega]=m \[CapitalOmega];
\[Omega]p=m \[CapitalOmega]p;

\[Psi]1inhom=\[Psi][1,l,m,r0];
\[Psi]1Right=Function[{r},Evaluate[\[Psi]1inhom[r][[1,2,1]]]];
\[Psi]1Left=Function[{r},Evaluate[\[Psi]1inhom[r][[1,1,1]]]];
\[Psi]1GridRight=\[Psi]1Right/@rgridR;
\[Psi]1GridLeft=\[Psi]1Left/@rgridL;
d\[Psi]1GridRight=\[Psi]1Right'/@rgridR;
d\[Psi]1GridLeft=\[Psi]1Left'/@rgridL;
dd\[Psi]1GridRight=\[Psi]1Right''/@rgridR;
dd\[Psi]1GridLeft=\[Psi]1Left''/@rgridL;

\[Psi]Zinhom=\[Psi]Z[l,m,r0];
\[Psi]ZRight=Function[{r},Evaluate[\[Psi]Zinhom[r][[1,2,1]]]];
\[Psi]ZLeft=Function[{r},Evaluate[\[Psi]Zinhom[r][[1,1,1]]]];
\[Psi]ZGridRight=\[Psi]ZRight/@rgridR;
\[Psi]ZGridLeft=\[Psi]ZLeft/@rgridL;
d\[Psi]ZGridRight=\[Psi]ZRight'/@rgridR;
d\[Psi]ZGridLeft=\[Psi]ZLeft'/@rgridL;
dd\[Psi]ZGridRight=\[Psi]ZRight''/@rgridR;
dd\[Psi]ZGridLeft=\[Psi]ZLeft''/@rgridL;

\[Psi]0inhom=\[Psi][0,l,m,r0];
\[Psi]0Right=Function[{r},Evaluate[\[Psi]0inhom[r][[1,2,1]]]];
\[Psi]0Left=Function[{r},Evaluate[\[Psi]0inhom[r][[1,1,1]]]];
\[Psi]0GridRight=\[Psi]0Right/@rgridR;
\[Psi]0GridLeft=\[Psi]0Left/@rgridL;
d\[Psi]0GridRight=\[Psi]0Right'/@rgridR;
d\[Psi]0GridLeft=\[Psi]0Left'/@rgridL;
dd\[Psi]0GridRight=\[Psi]0Right''/@rgridR;
dd\[Psi]0GridLeft=\[Psi]0Left''/@rgridL;

\[Psi]0binhom=\[Psi]b[0,l,m,r0];
\[Psi]0bRight=Function[{r},Evaluate[\[Psi]0binhom[r][[1,2,1]]]];
\[Psi]0bLeft=Function[{r},Evaluate[\[Psi]0binhom[r][[1,1,1]]]];
\[Psi]0bGridRight=\[Psi]0bRight/@rgridR;
\[Psi]0bGridLeft=\[Psi]0bLeft/@rgridL;
d\[Psi]0bGridRight=\[Psi]0bRight'/@rgridR;
d\[Psi]0bGridLeft=\[Psi]0bLeft'/@rgridL;
dd\[Psi]0bGridRight=\[Psi]0bRight''/@rgridR;
dd\[Psi]0bGridLeft=\[Psi]0bLeft''/@rgridL;

\[CapitalChi]inhom=\[Chi][l,m,r0];
\[CapitalChi]Right=Function[{r},Evaluate[\[CapitalChi]inhom[r][[1,2,1]]]];
\[CapitalChi]Left=Function[{r},Evaluate[\[CapitalChi]inhom[r][[1,1,1]]]];
\[CapitalChi]GridRight=\[CapitalChi]Right/@rgridR;
\[CapitalChi]GridLeft=\[CapitalChi]Left/@rgridL;
d\[CapitalChi]GridRight=\[CapitalChi]Right'/@rgridR;
d\[CapitalChi]GridLeft=\[CapitalChi]Left'/@rgridL;
dd\[CapitalChi]GridRight=\[CapitalChi]Right''/@rgridR;
dd\[CapitalChi]GridLeft=\[CapitalChi]Left''/@rgridL;

\[Phi]1inhom=\[Phi][1,l,m,r0];
\[Phi]1Right=Function[{r},Evaluate[\[Phi]1inhom[r][[1,2,1]]]];
\[Phi]1Left=Function[{r},Evaluate[\[Phi]1inhom[r][[1,1,1]]]];
\[Phi]1GridRight=\[Phi]1Right/@rgridR;
\[Phi]1GridLeft=\[Phi]1Left/@rgridL;
d\[Phi]1GridRight=\[Phi]1Right'/@rgridR;
d\[Phi]1GridLeft=\[Phi]1Left'/@rgridL;
dd\[Phi]1GridRight=\[Phi]1Right''/@rgridR;
dd\[Phi]1GridLeft=\[Phi]1Left''/@rgridL;

\[Phi]Zinhom=\[Phi]Z[l,m,r0];
\[Phi]ZRight=Function[{r},Evaluate[\[Phi]Zinhom[r][[1,2,1]]]];
\[Phi]ZLeft=Function[{r},Evaluate[\[Phi]Zinhom[r][[1,1,1]]]];
\[Phi]ZGridRight=\[Phi]ZRight/@rgridR;
\[Phi]ZGridLeft=\[Phi]ZLeft/@rgridL;
d\[Phi]ZGridRight=\[Phi]ZRight'/@rgridR;
d\[Phi]ZGridLeft=\[Phi]ZLeft'/@rgridL;
dd\[Phi]ZGridRight=\[Phi]ZRight''/@rgridR;
dd\[Phi]ZGridLeft=\[Phi]ZLeft''/@rgridL;

\[Phi]0inhom=\[Phi][0,l,m,r0];
\[Phi]0Right=Function[{r},Evaluate[\[Phi]0inhom[r][[1,2,1]]]];
\[Phi]0Left=Function[{r},Evaluate[\[Phi]0inhom[r][[1,1,1]]]];
\[Phi]0GridRight=\[Phi]0Right/@rgridR;
\[Phi]0GridLeft=\[Phi]0Left/@rgridL;
d\[Phi]0GridRight=\[Phi]0Right'/@rgridR;
d\[Phi]0GridLeft=\[Phi]0Left'/@rgridL;
dd\[Phi]0GridRight=\[Phi]0Right''/@rgridR;
dd\[Phi]0GridLeft=\[Phi]0Left''/@rgridL;

\[Phi]0binhom=\[Phi]b[0,l,m,r0];
\[Phi]0bRight=Function[{r},Evaluate[\[Phi]0binhom[r][[1,2,1]]]];
\[Phi]0bLeft=Function[{r},Evaluate[\[Phi]0binhom[r][[1,1,1]]]];
\[Phi]0bGridRight=\[Phi]0bRight/@rgridR;
\[Phi]0bGridLeft=\[Phi]0bLeft/@rgridL;
d\[Phi]0bGridRight=\[Phi]0bRight'/@rgridR;
d\[Phi]0bGridLeft=\[Phi]0bLeft'/@rgridL;
dd\[Phi]0bGridRight=\[Phi]0bRight''/@rgridR;
dd\[Phi]0bGridLeft=\[Phi]0bLeft''/@rgridL;

\[CapitalKappa]inhom=\[Kappa][l,m,r0];
\[CapitalKappa]Right=Function[{r},Evaluate[\[CapitalKappa]inhom[r][[1,1,2,1]]+\[CapitalKappa]inhom[r][[2,1,2,1]]]];
\[CapitalKappa]Left=Function[{r},Evaluate[\[CapitalKappa]inhom[r][[1,1,1,1]]+\[CapitalKappa]inhom[r][[2,1,1,1]]]];
\[CapitalKappa]GridRight=\[CapitalKappa]Right/@rgridR;
\[CapitalKappa]GridLeft=\[CapitalKappa]Left/@rgridL;
d\[CapitalKappa]GridRight=\[CapitalKappa]Right'/@rgridR;
d\[CapitalKappa]GridLeft=\[CapitalKappa]Left'/@rgridL;
dd\[CapitalKappa]GridRight=\[CapitalKappa]Right''/@rgridR;
dd\[CapitalKappa]GridLeft=\[CapitalKappa]Left''/@rgridL;

H0=Function[{r},Evaluate[-((\[Lambda] (1+\[Lambda]) M (-3 M+(3+\[Lambda]) r) \[Psi]z'[r])/(3 (I \[Omega])^2 r^3 (3 M+\[Lambda] r)))+((-M+r) \[Psi]0[r])/((2 M-r) r)+(2 (-2 M^2+M r+(I \[Omega])^2 r^4) (\[Psi]0b[r]+\[CapitalChi][r]))/((2 M-r) r^4)+(4 I \[Omega] (1+\[Lambda]) \[Psi]1[r])/(2 M-r)-(\[Lambda] (1+\[Lambda]) (18 M^4+3 (-3+4 \[Lambda]) M^3 r+(I \[Omega])^2 \[Lambda]^2 r^6-3 \[Lambda] M r^3 (1+\[Lambda]-2 (I \[Omega])^2 r^2)+M^2 (6 \[Lambda]^2 r^2+9 (I \[Omega])^2 r^4)) \[Psi]z[r])/(3 (I \[Omega])^2 (2 M-r) r^4 (3 M+\[Lambda] r)^2)+\[Psi]0'[r]+(2 M (\[Psi]0b'[r]+\[CapitalChi]'[r]))/r^3+(4 (1+\[Lambda]) M \[Psi]1'[r])/(I \[Omega] r^3)]];
H1=Function[{r},Evaluate[-((\[Lambda] (1+\[Lambda])\[Psi]z'[r] )/(3 I \[Omega] r))-((6 M+4 \[Lambda] M-3 r-2 \[Lambda] r-2 (I \[Omega])^2 r^3) \[Psi]0[r])/(4 I \[Omega] M r^2-2 I \[Omega] r^3)+((2+2 \[Lambda]) \[Psi]1[r])/(2 M r-r^2)+(2 I \[Omega] (-M+r) (\[Psi]0b[r]+\[CapitalChi][r]))/((2 M-r) r^2)-(\[Lambda] (1+\[Lambda]) (3 M^2+3 \[Lambda] M r-\[Lambda] r^2) \[Psi]z[r])/(3 I \[Omega] (2 M-r) r^2 (3 M+\[Lambda] r))+(\[Psi]0'[r])/(2 I \[Omega] r)+(2 I \[Omega] (\[Psi]0b'[r]+\[CapitalChi]'[r]))/r+(4 (1+\[Lambda]) \[Psi]1'[r])/r]];
H2=Function[{r},Evaluate[(\[Lambda] (1+\[Lambda]) (-9 M^2+(3-5 \[Lambda]) M r+2 \[Lambda] r^2)\[Psi]z'[r] )/(3 (I \[Omega])^2 r^3 (3 M+\[Lambda] r))+((-3 M+2 r)\[Psi]0[r])/((2 M-r) r)+(2 (6 M^2-(11+4 \[Lambda]) M r+r^2 (4+2 \[Lambda]+(I \[Omega])^2 r^2)) (\[Psi]0b[r]+\[CapitalChi][r]))/((2 M-r) r^4)+(4 (1+\[Lambda]) (-4 (1+\[Lambda]) M+r (2+2 \[Lambda]+(I \[Omega])^2 r^2)) \[Psi]1[r])/(I \[Omega] (2 M-r) r^3)-(\[Lambda] (\[Lambda]+1) (-54 M^4+3 (9-16 \[Lambda]) M^3 r+\[Lambda]^2 r^4 (2+2 \[Lambda]+(I \[Omega])^2 r^2)+9 M^2 r^2 (2 \[Lambda]-2 \[Lambda]^2+(I \[Omega])^2 r^2)+\[Lambda] M r^3 (3+5 \[Lambda]-4 \[Lambda]^2+6 (I \[Omega])^2 r^2)) \[Psi]z[r])/(3 (I \[Omega])^2 (2 M-r) r^4 (3 M+\[Lambda] r)^2)+\[Psi]0'[r]+((-6 M+4 r) (\[Psi]0b'[r]+\[CapitalChi]'[r]))/r^3-(4 (1+\[Lambda]) (M-r) \[Psi]1'[r])/(I \[Omega] r^3)]];
h0=Function[{r},Evaluate[(\[Lambda] (2 M-r)\[Psi]z'[r])/(3 I \[Omega] r)+((-2 M+r)\[Psi]0[r])/(2 I \[Omega] r^2)+(2 I \[Omega] (\[Psi]0b[r]+\[CapitalChi][r]))/r+(4 (1+\[Lambda])\[Psi]1[r])/r-(\[Lambda] (6 M^2+3 \[Lambda] M r+\[Lambda] (1+\[Lambda]) r^2) \[Psi]z[r])/(3 I \[Omega] r^2 (3 M+\[Lambda] r))-((-2 M+r)\[Psi]0'[r])/(2 I \[Omega] r)+(1-(2 M)/r) \[Psi]1'[r]]];
h1=Function[{r},Evaluate[(\[Lambda] ((3+\[Lambda]) M+\[Lambda] (2+\[Lambda]) r) \[Psi]z'[r])/(3 (I \[Omega])^2 r (3 M+\[Lambda] r))-(r \[Psi]0[r])/(4 M-2 r)+(4 (\[Psi]0b[r]+\[CapitalChi][r]))/r^2+((8 M+8 \[Lambda] M-4 r-4 \[Lambda] r+(I \[Omega])^2 r^3) \[Psi]1[r])/(2 I \[Omega] M r^2-I \[Omega] r^3)-(\[Lambda] (9 (I \[Omega])^2 M^2 r^3+2 \[Lambda]^3 r^2 (-2 M+r)+\[Lambda]^2 r (-12 M^2+2 M r+2 r^2+(I \[Omega])^2 r^4)+3 \[Lambda] M (-4 M^2+r^2+2 (I \[Omega])^2 r^4)) \[Psi]z[r])/(3 (I \[Omega])^2 (2 M-r) r^2 (3 M+\[Lambda] r)^2)-(2 (\[Psi]0b'[r]+\[CapitalChi]'[r]))/r-(2 (2 M+r+2 \[Lambda] r) \[Psi]1'[r])/(I \[Omega] r^2)]];
G=Function[{r},Evaluate[-((\[Lambda] (3+2 \[Lambda]) (2 M-r) \[Psi]z'[r])/(6 (I \[Omega])^2 r^2 (3 M+\[Lambda] r)))-(\[Psi]0b[r]+\[CapitalChi][r])/r^3-(2 (1+\[Lambda]) \[Psi]1[r])/(I \[Omega] r^3)+((4 \[Lambda]^3 r^2+\[Lambda]^4 r^2+27 (I \[Omega])^2 M^2 r^2+9 \[Lambda] M (M+2 (I \[Omega])^2 r^3)+3 \[Lambda]^2 (M^2+M r+r^2+(I \[Omega])^2 r^4)) \[Psi]z[r])/(6 (I \[Omega])^2 r^3 (3 M+\[Lambda] r)^2)+((2 M-r) \[Psi]1'[r])/(I \[Omega] r^3)]];
k=Function[{r},Evaluate[(\[Lambda] (1+\[Lambda]) (2 M-r) \[Psi]z'[r])/(3 (I \[Omega])^2 r^3)+\[Psi]0[r]/r+((-4 M+2 (2+\[Lambda]) r) (\[Psi]0b[r]+\[CapitalChi][r]))/r^4+(4 (1+\[Lambda])^2 \[Psi]1[r])/(I \[Omega] r^3)-(\[Lambda] (1+\[Lambda]) (6 M^2+3 \[Lambda] M r+\[Lambda] (1+\[Lambda]) r^2) \[Psi]z[r])/(3 (I \[Omega])^2 r^4 (3 M+\[Lambda] r))+((4 M-2 r) (\[Psi]0b'[r]+\[CapitalChi]'[r]))/r^3+(2 (1+\[Lambda]) (2 M-r) \[Psi]1'[r])/(I \[Omega] r^3)]];

dr0H0=Function[{r},Evaluate[-((\[Lambda] (1+\[Lambda]) M (-3 M+(3+\[Lambda]) r) \[Phi]z'[r])/(3 (I \[Omega])^2 r^3 (3 M+\[Lambda] r)))+((-M+r) \[Phi]0[r])/((2 M-r) r)+(2 (-2 M^2+M r+(I \[Omega])^2 r^4) (\[Phi]0b[r]+\[CapitalKappa][r]))/((2 M-r) r^4)+(4 I \[Omega] (1+\[Lambda]) \[Phi]1[r])/(2 M-r)-(\[Lambda] (1+\[Lambda]) (18 M^4+3 (-3+4 \[Lambda]) M^3 r+(I \[Omega])^2 \[Lambda]^2 r^6-3 \[Lambda] M r^3 (1+\[Lambda]-2 (I \[Omega])^2 r^2)+M^2 (6 \[Lambda]^2 r^2+9 (I \[Omega])^2 r^4)) \[Phi]z[r])/(3 (I \[Omega])^2 (2 M-r) r^4 (3 M+\[Lambda] r)^2)+\[Phi]0'[r]+(2 M (\[Phi]0b'[r]+\[CapitalKappa]'[r]))/r^3+(4 (1+\[Lambda]) M \[Phi]1'[r])/(I \[Omega] r^3)+\[Omega]p(-((4 \[Omega] (\[CapitalChi][r]+\[Psi]0b[r]))/(2 M-r))+(4 I (1+\[Lambda]) \[Psi]1[r])/(2 M-r)+(\[Lambda] (1+\[Lambda]) (-18 M^2 r^4 \[Omega]-12 M r^5 \[Lambda] \[Omega]-2 r^6 \[Lambda]^2 \[Omega]) \[Psi]z[r])/(3 (2 M-r) r^4 (3 M+r \[Lambda])^2 \[Omega]^2)-(2 \[Lambda] (1+\[Lambda]) (18 M^4+3 M^3 r (-3+4 \[Lambda])-r^6 \[Lambda]^2 \[Omega]^2-3 M r^3 \[Lambda] (1+\[Lambda]+2 r^2 \[Omega]^2)+M^2 (6 r^2 \[Lambda]^2-9 r^4 \[Omega]^2)) \[Psi]z[r])/(3 (2 M-r) r^4 (3 M+r \[Lambda])^2 \[Omega]^3)+(4 I M (1+\[Lambda]) Derivative[1][\[Psi]1][r])/(r^3 \[Omega]^2)-(2 M \[Lambda] (1+\[Lambda]) (-3 M+r (3+\[Lambda])) Derivative[1][\[Psi]z][r])/(3 r^3 (3 M+r \[Lambda]) \[Omega]^3))]];
dr0H1=Function[{r},Evaluate[-((\[Lambda] (1+\[Lambda])\[Phi]z'[r] )/(3 I \[Omega] r))-((6 M+4 \[Lambda] M-3 r-2 \[Lambda] r-2 (I \[Omega])^2 r^3) \[Phi]0[r])/(4 I \[Omega] M r^2-2 I \[Omega] r^3)+((2+2 \[Lambda]) \[Phi]1[r])/(2 M r-r^2)+(2 I \[Omega] (-M+r) (\[Phi]0b[r]+\[CapitalKappa][r]))/((2 M-r) r^2)-(\[Lambda] (1+\[Lambda]) (3 M^2+3 \[Lambda] M r-\[Lambda] r^2) \[Phi]z[r])/(3 I \[Omega] (2 M-r) r^2 (3 M+\[Lambda] r))+(\[Phi]0'[r])/(2 I \[Omega] r)+(2 I \[Omega] (\[Phi]0b'[r]+\[CapitalKappa]'[r]))/r+(4 (1+\[Lambda]) \[Phi]1'[r])/r+\[Omega]p(-((4 r^3 \[Omega] \[Psi]0[r])/(4 I M r^2 \[Omega]-2 I r^3 \[Omega]))+((4 I M r^2-2 I r^3) (6 M-3 r+4 M \[Lambda]-2 r \[Lambda]+2 r^3 \[Omega]^2) \[Psi]0[r])/(4 I M r^2 \[Omega]-2 I r^3 \[Omega])^2+(2 I (-M+r) (\[CapitalChi][r]+\[Psi]0b[r]))/((2 M-r) r^2)-(I \[Lambda] (1+\[Lambda]) (3 M^2+3 M r \[Lambda]-r^2 \[Lambda]) \[Psi]z[r])/(3 (2 M-r) r^2 (3 M+r \[Lambda]) \[Omega]^2)+(I Derivative[1][\[Psi]0][r])/(2 r \[Omega]^2)+(2 I (Derivative[1][\[CapitalChi]][r]+Derivative[1][\[Psi]0b][r]))/r-(I \[Lambda] (1+\[Lambda]) Derivative[1][\[Psi]z][r])/(3 r \[Omega]^2))]];
dr0H2=Function[{r},Evaluate[(\[Lambda] (1+\[Lambda]) (-9 M^2+(3-5 \[Lambda]) M r+2 \[Lambda] r^2)\[Phi]z'[r] )/(3 (I \[Omega])^2 r^3 (3 M+\[Lambda] r))+((-3 M+2 r)\[Phi]0[r])/((2 M-r) r)+(2 (6 M^2-(11+4 \[Lambda]) M r+r^2 (4+2 \[Lambda]+(I \[Omega])^2 r^2)) (\[Phi]0b[r]+\[CapitalKappa][r]))/((2 M-r) r^4)+(4 (1+\[Lambda]) (-4 (1+\[Lambda]) M+r (2+2 \[Lambda]+(I \[Omega])^2 r^2)) \[Phi]1[r])/(I \[Omega] (2 M-r) r^3)-(\[Lambda] (\[Lambda]+1) (-54 M^4+3 (9-16 \[Lambda]) M^3 r+\[Lambda]^2 r^4 (2+2 \[Lambda]+(I \[Omega])^2 r^2)+9 M^2 r^2 (2 \[Lambda]-2 \[Lambda]^2+(I \[Omega])^2 r^2)+\[Lambda] M r^3 (3+5 \[Lambda]-4 \[Lambda]^2+6 (I \[Omega])^2 r^2)) \[Phi]z[r])/(3 (I \[Omega])^2 (2 M-r) r^4 (3 M+\[Lambda] r)^2)+\[Phi]0'[r]+((-6 M+4 r) (\[Phi]0b'[r]+\[CapitalKappa]'[r]))/r^3-(4 (1+\[Lambda]) (M-r) \[Phi]1'[r])/(I \[Omega] r^3)+\[Omega]p(-((4 \[Omega] (\[CapitalChi][r]+\[Psi]0b[r]))/(2 M-r))+(8 I (1+\[Lambda]) \[Psi]1[r])/(2 M-r)+(4 I (1+\[Lambda]) (-4 M (1+\[Lambda])+r (2+2 \[Lambda]-r^2 \[Omega]^2)) \[Psi]1[r])/((2 M-r) r^3 \[Omega]^2)+(\[Lambda] (1+\[Lambda]) (-18 M^2 r^4 \[Omega]-12 M r^5 \[Lambda] \[Omega]-2 r^6 \[Lambda]^2 \[Omega]) \[Psi]z[r])/(3 (2 M-r) r^4 (3 M+r \[Lambda])^2 \[Omega]^2)-(2 \[Lambda] (1+\[Lambda]) (-54 M^4+3 M^3 r (9-16 \[Lambda])+M r^3 \[Lambda] (3+5 \[Lambda]-4 \[Lambda]^2-6 r^2 \[Omega]^2)+r^4 \[Lambda]^2 (2+2 \[Lambda]-r^2 \[Omega]^2)+9 M^2 r^2 (2 \[Lambda]-2 \[Lambda]^2-r^2 \[Omega]^2)) \[Psi]z[r])/(3 (2 M-r) r^4 (3 M+r \[Lambda])^2 \[Omega]^3)-(4 I (M-r) (1+\[Lambda]) Derivative[1][\[Psi]1][r])/(r^3 \[Omega]^2)+(2 \[Lambda] (1+\[Lambda]) (-9 M^2+M r (3-5 \[Lambda])+2 r^2 \[Lambda]) Derivative[1][\[Psi]z][r])/(3 r^3 (3 M+r \[Lambda]) \[Omega]^3))]];
dr0h0=Function[{r},Evaluate[(\[Lambda] (2 M-r)\[Phi]z'[r])/(3 I \[Omega] r)+((-2 M+r)\[Phi]0[r])/(2 I \[Omega] r^2)+(2 I \[Omega] (\[Phi]0b[r]+\[CapitalKappa][r]))/r+(4 (1+\[Lambda])\[Phi]1[r])/r-(\[Lambda] (6 M^2+3 \[Lambda] M r+\[Lambda] (1+\[Lambda]) r^2) \[Phi]z[r])/(3 I \[Omega] r^2 (3 M+\[Lambda] r))-((-2 M+r)\[Phi]0'[r])/(2 I \[Omega] r)+(1-(2 M)/r) \[Phi]1'[r]+\[Omega]p((I (-2 M+r) \[Psi]0[r])/(2 r^2 \[Omega]^2)+(2 I (\[CapitalChi][r]+\[Psi]0b[r]))/r-(I \[Lambda] (6 M^2+3 M r \[Lambda]+r^2 \[Lambda] (1+\[Lambda])) \[Psi]z[r])/(3 r^2 (3 M+r \[Lambda]) \[Omega]^2)-(I (-2 M+r) Derivative[1][\[Psi]0][r])/(2 r \[Omega]^2)+(I (2 M-r) \[Lambda] Derivative[1][\[Psi]z][r])/(3 r \[Omega]^2))]];
dr0h1=Function[{r},Evaluate[(\[Lambda] ((3+\[Lambda]) M+\[Lambda] (2+\[Lambda]) r) \[Phi]z'[r])/(3 (I \[Omega])^2 r (3 M+\[Lambda] r))-(r \[Phi]0[r])/(4 M-2 r)+(4 (\[Phi]0b[r]+\[CapitalKappa][r]))/r^2+((8 M+8 \[Lambda] M-4 r-4 \[Lambda] r+(I \[Omega])^2 r^3) \[Phi]1[r])/(2 I \[Omega] M r^2-I \[Omega] r^3)-(\[Lambda] (9 (I \[Omega])^2 M^2 r^3+2 \[Lambda]^3 r^2 (-2 M+r)+\[Lambda]^2 r (-12 M^2+2 M r+2 r^2+(I \[Omega])^2 r^4)+3 \[Lambda] M (-4 M^2+r^2+2 (I \[Omega])^2 r^4)) \[Phi]z[r])/(3 (I \[Omega])^2 (2 M-r) r^2 (3 M+\[Lambda] r)^2)-(2 (\[Phi]0b'[r]+\[CapitalKappa]'[r]))/r-(2 (2 M+r+2 \[Lambda] r) \[Phi]1'[r])/(I \[Omega] r^2)+\[Omega]p(-((2 r^3 \[Omega] \[Psi]1[r])/(2 I M r^2 \[Omega]-I r^3 \[Omega]))-((2 I M r^2-I r^3) (8 M-4 r+8 M \[Lambda]-4 r \[Lambda]-r^3 \[Omega]^2) \[Psi]1[r])/(2 I M r^2 \[Omega]-I r^3 \[Omega])^2+(\[Lambda] (-18 M^2 r^3 \[Omega]-12 M r^4 \[Lambda] \[Omega]-2 r^5 \[Lambda]^2 \[Omega]) \[Psi]z[r])/(3 (2 M-r) r^2 (3 M+r \[Lambda])^2 \[Omega]^2)-(2 \[Lambda] (2 r^2 (-2 M+r) \[Lambda]^3-9 M^2 r^3 \[Omega]^2+3 M \[Lambda] (-4 M^2+r^2-2 r^4 \[Omega]^2)+r \[Lambda]^2 (-12 M^2+2 M r+2 r^2-r^4 \[Omega]^2)) \[Psi]z[r])/(3 (2 M-r) r^2 (3 M+r \[Lambda])^2 \[Omega]^3)-(2 I (2 M+r+2 r \[Lambda]) Derivative[1][\[Psi]1][r])/(r^2 \[Omega]^2)+(2 \[Lambda] (r \[Lambda] (2+\[Lambda])+M (3+\[Lambda])) Derivative[1][\[Psi]z][r])/(3 r (3 M+r \[Lambda]) \[Omega]^3))]];
dr0G=Function[{r},Evaluate[-((\[Lambda] (3+2 \[Lambda]) (2 M-r) \[Phi]z'[r])/(6 (I \[Omega])^2 r^2 (3 M+\[Lambda] r)))-(\[Phi]0b[r]+\[CapitalKappa][r])/r^3-(2 (1+\[Lambda]) \[Phi]1[r])/(I \[Omega] r^3)+((4 \[Lambda]^3 r^2+\[Lambda]^4 r^2+27 (I \[Omega])^2 M^2 r^2+9 \[Lambda] M (M+2 (I \[Omega])^2 r^3)+3 \[Lambda]^2 (M^2+M r+r^2+(I \[Omega])^2 r^4)) \[Phi]z[r])/(6 (I \[Omega])^2 r^3 (3 M+\[Lambda] r)^2)+((2 M-r) \[Phi]1'[r])/(I \[Omega] r^3)+\[Omega]p(-((2 I (1+\[Lambda]) \[Psi]1[r])/(r^3 \[Omega]^2))-((-54 M^2 r^2 \[Omega]-36 M r^3 \[Lambda] \[Omega]-6 r^4 \[Lambda]^2 \[Omega]) \[Psi]z[r])/(6 r^3 (3 M+r \[Lambda])^2 \[Omega]^2)+((4 r^2 \[Lambda]^3+r^2 \[Lambda]^4-27 M^2 r^2 \[Omega]^2+9 M \[Lambda] (M-2 r^3 \[Omega]^2)+3 \[Lambda]^2 (M^2+M r+r^2-r^4 \[Omega]^2)) \[Psi]z[r])/(3 r^3 (3 M+r \[Lambda])^2 \[Omega]^3)+(I (2 M-r) Derivative[1][\[Psi]1][r])/(r^3 \[Omega]^2)-((2 M-r) \[Lambda] (3+2 \[Lambda]) Derivative[1][\[Psi]z][r])/(3 r^2 (3 M+r \[Lambda]) \[Omega]^3))]];
dr0k=Function[{r},Evaluate[(\[Lambda] (1+\[Lambda]) (2 M-r) \[Phi]z'[r])/(3 (I \[Omega])^2 r^3)+\[Phi]0[r]/r+((-4 M+2 (2+\[Lambda]) r) (\[Phi]0b[r]+\[CapitalKappa][r]))/r^4+(4 (1+\[Lambda])^2 \[Phi]1[r])/(I \[Omega] r^3)-(\[Lambda] (1+\[Lambda]) (6 M^2+3 \[Lambda] M r+\[Lambda] (1+\[Lambda]) r^2) \[Phi]z[r])/(3 (I \[Omega])^2 r^4 (3 M+\[Lambda] r))+((4 M-2 r) (\[Phi]0b'[r]+\[CapitalKappa]'[r]))/r^3+(2 (1+\[Lambda]) (2 M-r) \[Phi]1'[r])/(I \[Omega] r^3)+\[Omega]p((4 I (1+\[Lambda])^2 \[Psi]1[r])/(r^3 \[Omega]^2)-(2 \[Lambda] (1+\[Lambda]) (6 M^2+3 M r \[Lambda]+r^2 \[Lambda] (1+\[Lambda])) \[Psi]z[r])/(3 r^4 (3 M+r \[Lambda]) \[Omega]^3)+(2 I (2 M-r) (1+\[Lambda]) Derivative[1][\[Psi]1][r])/(r^3 \[Omega]^2)+(2 (2 M-r) \[Lambda] (1+\[Lambda]) Derivative[1][\[Psi]z][r])/(3 r^3 \[Omega]^3))]];
hbar1=Function[{r},Evaluate[r (1-2M/r)(H0[r]+H2[r])]];
hbar2=Function[{r},Evaluate[2 r (1-2M/r) H1[r]]];
hbar3=Function[{r},Evaluate[2 r k[r]]];
hbar4=Function[{r},Evaluate[2 l(1+l) h0[r]]];
hbar5=Function[{r},Evaluate[(2 (1-2 M/r) l(1+l) h1[r])]];
hbar6=Function[{r},Evaluate[r (H0[r]-H2[r])]];
hbar7=Function[{r},Evaluate[2 r (l-1)l(1+l)(l+2) G[r]]];
dr0hbar1=Function[{r},Evaluate[r (1-2M/r)(dr0H0[r]+dr0H2[r])]];
dr0hbar2=Function[{r},Evaluate[2 r (1-2M/r) dr0H1[r]]];
dr0hbar3=Function[{r},Evaluate[2 r dr0k[r]]];
dr0hbar4=Function[{r},Evaluate[2 l(1+l) dr0h0[r]]];
dr0hbar5=Function[{r},Evaluate[(2 (1-2 M/r) l(1+l) dr0h1[r])]];
dr0hbar6=Function[{r},Evaluate[r (dr0H0[r]-dr0H2[r])]];
dr0hbar7=Function[{r},Evaluate[2 r (l-1)l(1+l)(l+2) dr0G[r]]];
fields=Simplify[
{{hbar1[r],hbar1'[r],hbar3[r],hbar3'[r],hbar5[r],hbar5'[r],hbar6[r],hbar6'[r],hbar7[r],hbar7'[r],hbar2[r],hbar2'[r],hbar4[r],hbar4'[r]},
{dr0hbar1[r],dr0hbar1'[r],dr0hbar3[r],dr0hbar3'[r],dr0hbar5[r],dr0hbar5'[r],dr0hbar6[r],dr0hbar6'[r],dr0hbar7[r],dr0hbar7'[r],dr0hbar2[r],dr0hbar2'[r],dr0hbar4[r],dr0hbar4'[r]}}];
{Flatten[Transpose[ReIm[fields/.{
\[Psi]1[r]->\[Psi]1GridLeft,\[Psi]1'[r]->d\[Psi]1GridLeft,\[Psi]1''[r]->dd\[Psi]1GridLeft,
\[Psi]z[r]->\[Psi]ZGridLeft,\[Psi]z'[r]->d\[Psi]ZGridLeft,\[Psi]z''[r]->dd\[Psi]ZGridLeft,
\[Psi]0[r]->\[Psi]0GridLeft,\[Psi]0'[r]->d\[Psi]0GridLeft,\[Psi]0''[r]->dd\[Psi]0GridLeft,
\[Psi]0b[r]->\[Psi]0bGridLeft,\[Psi]0b'[r]->d\[Psi]0bGridLeft,\[Psi]0b''[r]->dd\[Psi]0bGridLeft,
\[CapitalChi][r]->\[CapitalChi]GridLeft,\[CapitalChi]'[r]->d\[CapitalChi]GridLeft,\[CapitalChi]''[r]->dd\[CapitalChi]GridLeft,
\[Phi]1[r]->\[Phi]1GridLeft,\[Phi]1'[r]->d\[Phi]1GridLeft,\[Phi]1''[r]->dd\[Phi]1GridLeft,
\[Phi]z[r]->\[Phi]ZGridLeft,\[Phi]z'[r]->d\[Phi]ZGridLeft,\[Phi]z''[r]->dd\[Phi]ZGridLeft,
\[Phi]0[r]->\[Phi]0GridLeft,\[Phi]0'[r]->d\[Phi]0GridLeft,\[Phi]0''[r]->dd\[Phi]0GridLeft,
\[Phi]0b[r]->\[Phi]0bGridLeft,\[Phi]0b'[r]->d\[Phi]0bGridLeft,\[Phi]0b''[r]->dd\[Phi]0bGridLeft,
\[CapitalKappa][r]->\[CapitalKappa]GridLeft,\[CapitalKappa]'[r]->d\[CapitalKappa]GridLeft,\[CapitalKappa]''[r]->dd\[CapitalKappa]GridLeft,
r->rgridL}],{1,3,2,4}],{{1},{2},{3,4}}],
Flatten[Transpose[ReIm[fields/.{
\[Psi]1[r]->\[Psi]1GridRight,\[Psi]1'[r]->d\[Psi]1GridRight,\[Psi]1''[r]->dd\[Psi]1GridRight,
\[Psi]z[r]->\[Psi]ZGridRight,\[Psi]z'[r]->d\[Psi]ZGridRight,\[Psi]z''[r]->dd\[Psi]ZGridRight,
\[Psi]0[r]->\[Psi]0GridRight,\[Psi]0'[r]->d\[Psi]0GridRight,\[Psi]0''[r]->dd\[Psi]0GridRight,
\[Psi]0b[r]->\[Psi]0bGridRight,\[Psi]0b'[r]->d\[Psi]0bGridRight,\[Psi]0b''[r]->dd\[Psi]0bGridRight,
\[CapitalChi][r]->\[CapitalChi]GridRight,\[CapitalChi]'[r]->d\[CapitalChi]GridRight,\[CapitalChi]''[r]->dd\[CapitalChi]GridRight,
\[Phi]1[r]->\[Phi]1GridRight,\[Phi]1'[r]->d\[Phi]1GridRight,\[Phi]1''[r]->dd\[Phi]1GridRight,
\[Phi]z[r]->\[Phi]ZGridRight,\[Phi]z'[r]->d\[Phi]ZGridRight,\[Phi]z''[r]->dd\[Phi]ZGridRight,
\[Phi]0[r]->\[Phi]0GridRight,\[Phi]0'[r]->d\[Phi]0GridRight,\[Phi]0''[r]->dd\[Phi]0GridRight,
\[Phi]0b[r]->\[Phi]0bGridRight,\[Phi]0b'[r]->d\[Phi]0bGridRight,\[Phi]0b''[r]->dd\[Phi]0bGridRight,
\[CapitalKappa][r]->\[CapitalKappa]GridRight,\[CapitalKappa]'[r]->d\[CapitalKappa]GridRight,\[CapitalKappa]''[r]->dd\[CapitalKappa]GridRight,
r->rgridR}],{1,3,2,4}],{{1},{2},{3,4}}]}
]


(* ::Input::Initialization:: *)
$r0=SetPrecision[r0,64];


(* ::Input::Initialization:: *)
rgrid=Import["grids/radial_grid_r"<>ToString[NumberForm[$r0,{\[Infinity],1}]]<>".h5",{"Datasets","r"}];


(* ::Input::Initialization:: *)
r0Pos=Import["grids/radial_grid_r"<>ToString[NumberForm[$r0,{\[Infinity],1}]]<>".h5",{"Datasets","ImportantIndexes"}][[2]];


(* ::Input::Initialization:: *)
rgridL=rgrid[[;;r0Pos]];
rgridR=rgrid[[r0Pos;;]];


(* ::Input::Initialization:: *)
If[!DirectoryQ["dr0_h1/r0_"<>ToString[NumberForm[$r0,{4,1}]]],
CreateDirectory["dr0_h1/r0_"<>ToString[NumberForm[$r0,{4,1}]]]];
Timing[Do[If[!FileExistsQ["dr0_h1/r0_"<>ToString[NumberForm[$r0,{4,1}]]<>"/h1-l"<>ToString[l]<>"m"<>ToString[m]<>".h5"],
Module[{hbargrid},
Print[{$r0,l,m}];
hbargrid=hbar[l,m,$r0,rgridL,rgridR];
Export["dr0_h1/r0_"<>ToString[NumberForm[$r0,{4,1}]]<>"/h1-l"<>ToString[l]<>"m"<>ToString[m]<>".h5",{"grid"->rgrid,"inhom_left"->hbargrid[[1,2]],"inhom_right"->hbargrid[[2,2]]},"Datasets"]]],{l,2,10},{m,1,l}];]
